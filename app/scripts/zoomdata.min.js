/*
 * Copyright (C) Zoomdata, Inc. 2012-2014. All rights reserved.
 */
!function(a){function b(){this.items=new Array,this.itemsCount=0,this.put=function(a,b){this.containsKey(a)?this.items[a]=b:(this.items[a]=b,this.itemsCount++)},this.get=function(a){return this.containsKey(a)?this.items[a]:null},this.remove=function(a){if(!this.containsKey(a))throw"key '"+a+"' does not exists.";delete this.items[a],this.itemsCount--},this.containsKey=function(a){return"undefined"!=typeof this.items[a]},this.containsValue=function(a){for(var b in this.items)if(this.items[b]==a)return!0;return!1},this.contains=function(a){return this.containsKey(a)||this.containsValue(a)},this.clear=function(){this.items=new Array,itemsCount=0},this.size=function(){return this.itemsCount},this.isEmpty=function(){return 0==this.size()}}function c(a,b,c){this.dec=a,this.group=b,this.neg=c}function d(){for(var a=0;a<l.length;a++){localeGroup=l[a];for(var b=0;b<localeGroup.length;b++)f.put(localeGroup[b],a)}}function e(a,b){0==f.size()&&d();var e=".",g=",",h="-";0==b&&(-1!=a.indexOf("_")?a=a.split("_")[1].toLowerCase():-1!=a.indexOf("-")&&(a=a.split("-")[1].toLowerCase()));var i=f.get(a);if(i){var j=k[i];j&&(e=j[0],g=j[1])}return new c(e,g,h)}var f=new b,g=["ae","au","ca","cn","eg","gb","hk","il","in","jp","sk","th","tw","us"],h=["at","br","de","dk","es","gr","it","nl","pt","tr","vn"],i=["cz","fi","fr","ru","se","pl"],j=["ch"],k=[[".",","],[",","."],[","," "],[".","'"]],l=[g,h,i,j];a.fn.formatNumber=function(b,c,d){return this.each(function(){null==c&&(c=!0),null==d&&(d=!0);var e;e=new String(a(this).is(":input")?a(this).val():a(this).text());var f=a.formatNumber(e,b);return c&&(a(this).is(":input")?a(this).val(f):a(this).text(f)),d?f:void 0})},a.formatNumber=function(b,c){for(var c=a.extend({},a.fn.formatNumber.defaults,c),d=e(c.locale.toLowerCase(),c.isFullLocale),f=(d.dec,d.group,d.neg,"0#-,."),g="",h=!1,i=0;i<c.format.length;i++)if(-1==f.indexOf(c.format.charAt(i)))g+=c.format.charAt(i);else{if(0!=i||"-"!=c.format.charAt(i))break;h=!0}for(var j="",i=c.format.length-1;i>=0&&-1==f.indexOf(c.format.charAt(i));i--)j=c.format.charAt(i)+j;c.format=c.format.substring(g.length),c.format=c.format.substring(0,c.format.length-j.length);var k=new Number(b);return a._formatNumber(k,c,j,g,h)},a._formatNumber=function(b,c,d,f,g){var c=a.extend({},a.fn.formatNumber.defaults,c),h=e(c.locale.toLowerCase(),c.isFullLocale),i=h.dec,j=h.group,k=h.neg,l=!1;if(isNaN(b)){if(1!=c.nanForceZero)return null;b=0,l=!0}"%"==d&&(b=100*b);var m="";if(c.format.indexOf(".")>-1){var n=i,o=c.format.substring(c.format.lastIndexOf(".")+1);if(1==c.round)b=new Number(b.toFixed(o.length));else{var p=b.toString();p=p.substring(0,p.lastIndexOf(".")+o.length+1),b=new Number(p)}var q=b%1,r=new String(q.toFixed(o.length));r=r.substring(r.lastIndexOf(".")+1);for(var s=0;s<o.length;s++)if("#"==o.charAt(s)&&"0"!=r.charAt(s))n+=r.charAt(s);else if("#"==o.charAt(s)&&"0"==r.charAt(s)){var t=r.substring(s);if(!t.match("[1-9]"))break;n+=r.charAt(s)}else"0"==o.charAt(s)&&(n+=r.charAt(s));m+=n}else b=Math.round(b);var u=Math.floor(b);0>b&&(u=Math.ceil(b));var v="";v=-1==c.format.indexOf(".")?c.format:c.format.substring(0,c.format.indexOf("."));var w="";if(0!=u||"#"!=v.substr(v.length-1)||l){var x=new String(Math.abs(u)),y=9999;-1!=v.lastIndexOf(",")&&(y=v.length-v.lastIndexOf(",")-1);for(var z=0,s=x.length-1;s>-1;s--)w=x.charAt(s)+w,z++,z==y&&0!=s&&(w=j+w,z=0);if(v.length>w.length){var A=v.indexOf("0");if(-1!=A)for(var B=v.length-A,C=v.length-w.length-1;w.length<B;){var D=v.charAt(C);","==D&&(D=j),w=D+w,C--}}}return w||-1===v.indexOf("0",v.length-1)||(w="0"),m=w+m,0>b&&g&&f.length>0?f=k+f:0>b&&(m=k+m),c.decimalSeparatorAlwaysShown||m.lastIndexOf(i)==m.length-1&&(m=m.substring(0,m.length-1)),m=f+m+d},a.fn.parseNumber=function(b,c,d){null==c&&(c=!0),null==d&&(d=!0);var e;e=new String(a(this).is(":input")?a(this).val():a(this).text());var f=a.parseNumber(e,b);return f&&(c&&(a(this).is(":input")?a(this).val(f.toString()):a(this).text(f.toString())),d)?f:void 0},a.parseNumber=function(b,c){for(var c=a.extend({},a.fn.parseNumber.defaults,c),d=e(c.locale.toLowerCase(),c.isFullLocale),f=d.dec,g=d.group,h=d.neg,i="1234567890.-";b.indexOf(g)>-1;)b=b.replace(g,"");b=b.replace(f,".").replace(h,"-");var j="",k=!1;("%"==b.charAt(b.length-1)||1==c.isPercentage)&&(k=!0);for(var l=0;l<b.length;l++)i.indexOf(b.charAt(l))>-1&&(j+=b.charAt(l));var m=new Number(j);if(k){m/=100;var n=j.indexOf(".");if(-1!=n){var o=j.length-n-1;m=m.toFixed(o+2)}else m=m.toFixed(j.length-1)}return m},a.fn.parseNumber.defaults={locale:"us",decimalSeparatorAlwaysShown:!1,isPercentage:!1,isFullLocale:!1},a.fn.formatNumber.defaults={format:"#,###.00",locale:"us",decimalSeparatorAlwaysShown:!1,nanForceZero:!0,round:!0,isFullLocale:!1},Number.prototype.toFixed=function(b){return a._roundNumber(this,b)},a._roundNumber=function(a,b){var c=Math.pow(10,b||0),d=String(Math.round(a*c)/c);if(b>0){var e=d.indexOf(".");for(-1==e?(d+=".",e=0):e=d.length-(e+1);b>e;)d+="0",e++}return d}}(jQuery);var Zoomdata=function(a){"use strict";var b={},c=function(){};return b.Visualizations=b.Visualizations||{},b.MVC=_.clone(a.Backbone),b.eventDispatcher=_.clone(b.MVC.Events),window.Zoomdata&&window.Zoomdata.pageData&&(b.pageData=window.Zoomdata.pageData,delete window.Zoomdata.pageData),a.Backbone.sync=function(a,c,d){var e=_.result(c,"url"),f=c.remote,g=c.secure,h=c.apiKey;return d||(d={}),d.crossDomain||(d.crossDomain=!0),d.xhrFields||(d.xhrFields={withCredentials:!1}),f&&(d.url=[g?"https://":"http://",f+"/",e].join("")),h&&(d.data=$.extend({},d.data,{key:h})),b.MVC.sync(a,c,d)},b.MVC.View=a.Backbone.View.extend({defaults:{},initialize:function(a){this.childViews=[],this.options=$.extend({},this.defaults,a)},_removeChildViews:function(){_.each(this.childViews,function(a){a?a.remove():null}),this.childViews=[]},popChildView:function(a){var b=this.childViews,c=b.indexOf(a);return-1!==c?b.splice(c,1):null},empty:function(){return this._removeChildViews(),this.$el.children().remove(),this},remove:function(){this._removeChildViews(),Backbone.View.prototype.remove.call(this,arguments)},delegateEvents:function(){Backbone.View.prototype.delegateEvents.apply(this,arguments),_.each(this.childViews,function(a){a&&a.delegateEvents&&a.delegateEvents()})}}),b.MVC.Model=a.Backbone.Model.extend({initialize:function(b,c){c=c||{},this.secure=this.collection?this.collection.secure:null,this.remote=this.collection?this.collection.remote:null,this.apiKey=this.collection?this.collection.apiKey:null,"undefined"!=typeof c.apiKey&&(this.apiKey=c.apiKey,delete c.apiKey),"undefined"!=typeof c.remote&&(this.remote=c.remote,delete c.remote,"undefined"!=typeof c.secure?(this.secure=c.secure,delete c.secure):this.secure=!1),a.Backbone.Model.prototype.initialize.apply(this,arguments)},isBootstrapped:function(){return this._bootstrapped=this._bootstrapped||!1,this._bootstrapped?!0:!1},bootstrap:function(a){var b=$.Deferred(),c=this;return this.isBootstrapped()?(b.resolve(this.toJSON()),a&&a.success&&a.success(this.toJSON())):this.fetch().done(function(d){c._bootstrapped=!0,b.resolve(d),a&&a.success&&a.success(d)}).fail(b.reject).progress(b.notify),b.promise()},matchesSearch:function(a,b){b=b||{};var c="g"+(b.caseSensitive?"":"i"),d=b.words?new RegExp("(\\W|^)"+b.needle+"(\\W|$)",c):b.regExp?new RegExp(b.needle,c):new RegExp(b.needle,c);return"undefined"!=typeof b.needle&&""!==b.needle?!!this.get(a).match(d):!1}}),b.MVC.Collection=a.Backbone.Collection.extend({initialize:function(b,c){c=c||{},this.apiKey=null,this.remote=null,this.secure=null,"undefined"!=typeof c.apiKey&&(this.apiKey=c.apiKey,delete c.apiKey),"undefined"!=typeof c.remote&&(this.remote=c.remote,delete c.remote,"undefined"!=typeof c.secure?(this.secure=c.secure,delete c.secure):this.secure=!1),a.Backbone.Collection.prototype.initialize.apply(this,arguments)},add:function(){return a.Backbone.Collection.prototype.add.apply(this,arguments),this},fetchModels:function(a){var b=$.Deferred(),c=0,d=0,e=this.length,f=[],g=this;return this.each(function(h){h.fetch(a).done(function(a){c++,f.push(a),b.notify(h,a),f.length===e&&0===d&&b.resolve(g,f)}).fail(function(a){d++,f.push(a),b.notify(h,a),f.length==e&&d>0&&b.reject(g,f)})}),b},saveModels:function(){var a=$.Deferred(),b=0,c=0,d=[],e=this;return this.each(function(f){f.save().done(function(g){b++,d.push(g),a.notify(f,g),d.length===e.length&&0===c&&a.resolve(e,d)}).fail(function(b){c++,d.push(b),a.notify(f,b),d.length==e.length&&c>0&&a.reject(e,d)})}),a},setIdOrder:function(a){var b=this.comparator,c=function(b){var c=b.cid;return a.indexOf(c)};this.comparator=c,this.sort(),this.comparator=b},hasNewModels:function(){var a=!1;return this.each(function(b){b.isNew()&&(a=!0)}),a},isBootstrapped:function(){return this._bootstrapped=this._bootstrapped||!1,this._bootstrapped?!0:!1},bootstrap:function(a){var b=$.Deferred(),c=this;return this.isBootstrapped()?b.resolve(this.toJSON()):this.fetch(a).done(function(a){c._bootstrapped=!0,b.resolve(a)}).fail(b.reject).progress(b.notify),b.promise()},search:function(a,b){b=b||{};var c=[],d="g"+(b.caseSensitive?"":"i"),e=b.words?new RegExp("(\\W|^)"+b.needle+"(\\W|$)",d):b.regExp?new RegExp(b.needle,d):new RegExp(b.needle,d);return c="undefined"!=typeof b.needle&&""!==b.needle?this.filter(function(b){return!!b.get(a).match(e)}):this.models},fetch:function(){var b=this;return this.trigger("request:collection",this),a.Backbone.Collection.prototype.fetch.apply(this,arguments).done(function(a,c,d){b.trigger("sync:collection",b,d)})}}),b.DataStreamProvider=function(){function a(a,b){var d=function(a,b){this.type="WebSocket",this.url=a,this.publisher=b};return d.prototype={is:function(a){function b(a){var b=!1;if(d instanceof WebSocket)switch(a){case"connecting":b=d.readyState==d.CONNECTING;break;case"open":b=d.readyState==d.OPEN;break;case"closing":b=d.readyState==d.CLOSING;break;case"closed":b=d.readyState==d.CLOSED}else b="closed"==a;return b}function c(){if(!(d instanceof WebSocket))return"closed";switch(d.readyState){case d.CLOSING:return"closing";case d.CLOSED:return"closed";case d.OPEN:return"open";case d.CONNECTING:return"connecting";default:throw new Error("Unexpected socket readyState")}}var d=this.socket;return"string"==typeof a?b(a):c()},connect:function(a,b){function c(a,b){"string"==typeof a&&(d.url=a),"string"!=typeof d.url?e.reject({message:"Invalid url"}):(d.socket=new WebSocket(d.url),d.socket.onopen=function(){d.publish(b),e.resolve(),d.onOpen.apply(d,arguments)},d.socket.onerror=function(){e.reject.apply(c,arguments)})}var d=this,e=$.Deferred();return this.is("closed")?c(a,b):this.close().done(function(){c(a,b)}).fail(function(){e.reject.apply(c,arguments)}),e.promise()},close:function(){var a,b,c=this.socket,d=$.Deferred();if(c instanceof WebSocket)switch(b=c.onclose,c.onclose=function(){"function"==typeof b?b.apply(this,arguments):null,d.resolve.apply(d,arguments)},a=c.onerror,c.onerror=function(){"function"==typeof a?a.apply(this,arguments):null,d.reject.apply(d,arguments)},this.is()){case"closing":break;case"closed":d.resolve();break;case"open":case"connecting":c.close()}else d.resolve();return d.promise()},publish:function(a){var b,c=this;"undefined"!=typeof a&&(this.publisher=a),b=this.publisher,this.socket.onopen=function(a){var d=Array.prototype.slice.call(arguments,0);c.onOpen&&c.onOpen.apply(c,d),d.unshift("stream:open"),b&&b.trigger.apply(b,d),c._dfd.resolve.call(c._dfd,a)},this.socket.onclose=function(){var a=Array.prototype.slice.call(arguments,0);c.onClose&&c.onClose.apply(c,a),a.unshift("stream:close"),b&&b.trigger.apply(b,a)},this.socket.onmessage=function(a){var d=Array.prototype.slice.call(arguments,0),e=JSON.parse(a.data),f=e.status||"message";c.onMessage&&c.onMessage.apply(c,d),f=e.error?"error":e.status?e.status:"message",d.unshift("stream:"+f),b&&b.trigger.apply(b,d)}},send:function(){function a(){d.socket.send.apply(d.socket,c)}var b,c=arguments,d=this,e=this.is();switch(e){case"open":a();break;case"closed":this.connect().done(function(){a()});break;case"connecting":b=this.onOpen,this.onOpen=function(){b.apply(d,arguments),a()}}},onOpen:c,onClose:c,onMessage:c,destroy:function(){this.socket.close()}},new d(a,b)}return{getStream:a}}(),b}(window);!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),function(a,b){"use strict";function c(a,b){return b>a?"0"+a:a.toString()}function d(a){return decodeURIComponent((new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function e(a){return decodeURIComponent((new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)").exec(location.hash)||[,""])[1].replace(/\+/g,"%20"))||null}function f(){var a=[],c={};-1!==location.search.indexOf("?")&&(a=location.search.split("?")[1].split("#")[0].split("&"));for(var d=0;d<a.length;d++){var e=a[d].split("=");c[e[0]]=e[1]}if(b.pageData)var f=b.pageData.csrfToken,g=b.pageData.csrfParameterName;var h=c.server||window.location.hostname,i=c.port||location.port||!1,j=c.key?"key="+c.key:void 0,k=f?g+"="+f:void 0;if(j)var l=j;k&&(l=l?"&"+k:k);var m=("https:"==location.protocol?"wss":"ws")+"://"+h+(i?":"+i:"")+"/zoomdata/websocket/"+(l?"?"+l:"");return{host:m,time:(new Date).getTime(),params:c}}function g(a,b){for(var c=a.visualizations||[],e=b||d("visId"),f=0;f<c.length;f++)if(c[f].visId==e){var g=c[f];return g}}function h(a){var b=["avg","min","max","sum"];return a&&i(a)&&b.push("last_value"),b}function i(a){if(!a)throw new ReferenceError("Source needed");return a.toRequest().cfg.group.metrics.length>1?!1:a.config.attributes.source.sourceFeatures.indexOf("LV_METRIC")>=0}function j(a){var b=["MONEY","INTEGER","NUMBER","COUNT OF","FORMULA"];return b.indexOf(a.toUpperCase())>=0}function k(a){for(var b=a.visualizations,c=d("visId"),e=0;e<b.length;e++)if(b[e].visId==c){var f=b[e];return f.source}}function l(a){return a>=12&&(a-=12),0===a&&(a=12),a}function m(a){var b=new Date(Math.round(a)),d=b.getHours()>=12?" PM":" AM";return l(b.getHours())+":"+c(b.getMinutes(),10)+":"+c(b.getSeconds(),10)+d}function n(a,b,c){var d=new Date(Math.round(a)),e=c?d.getUTCMonth():d.getMonth(),f=c?d.getUTCDate():d.getDate(),g=c?d.getUTCFullYear():d.getFullYear();return e+=1,10>e&&(e="0"+e),b?e+"/"+f+"/"+g:g+"/"+e+"/"+f}function o(a){var b=new Date(Math.round(a)),c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return b.getDate()+" "+c[b.getMonth()]+" "+(1900+b.getYear())}function p(a,b){return n(a,b)+" "+m(a)}function q(a){var b=new Date(a),c=b.getTimezoneOffset()/-60;return"GMT"+(c>0?"+":"")+c}function r(){var a=jstz.determine();return a.name()}function s(){return window.pageUserData}function t(a){this.options=$.extend({},this.defaults,a),this.$el=$('<div class="zd-radial-item-filter"></div>'),this.$donut=$('<div class="zd-radial-item-donut"></div>').appendTo(this.$el),this.$filler=$('<div class="zd-radial-item-filler"></div>').appendTo(this.$el),this.$center=$('<div class="zd-radial-item-center"></div>').appendTo(this.$donut),this.positionElements()}var u={},v=_.template('            <div class="fsWrapper">                <div class="fsHeader">                    <div class="fsHead"></div>                    <div class="exitFullscreen"><i class="zd icon exit-fullscreen"></i></div>                    <div class="clearfix"></div>                </div>                <div class="fsBody">                    <div class="fullScreenContainer"></div>                </div>                <div class="fsFooter">                    <div class="fullScreenFooter"></div>                </div>             </div>            <div class="fsExpander"></div>            ');u.FullScreenView=b.MVC.View.extend({className:"fullScreenView",template:v,events:{"click .exitFullscreen":"close"},initialize:function(a){b.MVC.View.prototype.initialize.apply(this,arguments),this.$el.appendTo(a),this.$el.hide(0),this.$el.append(this.template()),this.$wraper=this.$(".fsWrapper"),this.$header=this.$(".fsHeader"),this.$head=this.$(".fsHead"),this.$body=this.$(".fullScreenContainer"),this.$labels=this.$(".widgetLabel"),this.$styles=this.$("style"),this.$filters=this.$(".filters"),this.$footer=this.$(".fullScreenFooter"),this.$expander=this.$(".fsExpander"),this.$bodyPlaceholder=$("<span></span>"),this.currentBody=null,this.$headPlaceholder=$("<span></span>"),this.currentHead=null,this.listenTo(b.eventDispatcher,"switch:section",this.close)},render:function(a,c){function d(a){i.html(),a instanceof b.MVC.View&&(a=a.el),$(a).before(g),i.append(a),f.currentBody=a}function e(a){j.html(),a instanceof b.MVC.View&&(a=a.el),$(a).before(h),j.append(a),f.currentHead=a}var f=this,g=this.$bodyPlaceholder,h=this.$headPlaceholder,i=this.$body,j=this.$head,k=this.$header,l=$.Deferred();return this.$el.fadeIn(function(){a?d(a):i.addClass("empty"),c?e(c):k.addClass("empty"),l.resolve(),f.trigger("open")}),l.promise()},close:function(){var a=this,b=this.$bodyPlaceholder,c=this.$headPlaceholder,d=this.currentBody,e=this.currentHead,f=$.Deferred();return this.trigger("startClosing"),a.$el.fadeOut("fast",function(){d&&(b.after(d),b.detach()),e&&(c.after(e),c.detach()),f.resolve(),a.trigger("close")}),f.promise()},_applyClickEvents:function(){},_runAnimationShowUp:function(a){a();var b=this,c=this.options.widget.$el,d=c.offset(),e=c.width(),f=c.height(),g=300;this.$expander.css({position:"absolute",top:d.top,left:d.left,width:e,height:f}).show(),$('<style id="transferEffect" type="text/css">.zoomin-transfer {                     background-color: #FFF;                     z-index: 1029;                    margin-top: 25px;                }</style>').appendTo("body"),this.$expander.effect("transfer",{to:$(".midPane"),className:"zoomin-transfer"},g,function(){$("#transferEffect").remove(),b.$expander.hide()}),setTimeout(function(){b.$wraper.css({opacity:1}),b.$body.css({opacity:1})},g-100)},_closeAnimation:function(a,b){if(this.options.widget)if("click"===b){var c=this,d=this.$body.offset(),e=this.$body.width(),f=this.$body.height(),g=(this.$body.find("svg"),300);this.$expander.css({position:"absolute",top:d.top-60,left:0,width:e+70,height:f+120}).show(),$('<style id="transferEffect" type="text/css">.zoomin-transfer {                         background-color: #FFF;                         z-index: 1029;                        margin-top: 25px;                        opacity: 0.8;                    }</style>').appendTo("body"),this.$expander.effect("transfer",{to:this.options.widget.$el,className:"zoomin-transfer"},g,function(){$("#transferEffect").remove(),c.$expander.hide()}),setTimeout(function(){c.$wraper.css({opacity:0}),c.$body.css({opacity:0}),a()},g-100)}else a()},adjustBodySizes:function(){var a=this.$body.parent().prev(),b=a.offset().top+a.outerHeight()+parseFloat(a.css("margin-bottom"));this.$body.parent().css("top",b)}});var w=_.template('        <div class="modal hide fade">            <div class="modal-header">                <button title="Close" value="dialog-reject" class="close">&times;</button>                <h3 class="dialog-head pull-left"></h3>                <div class="clearfix"></div>            </div>            <div class="modal-body dialog-body">            </div>            <div class="modal-footer dialog-controls">                <button title="<%= rejectButtonTitle %>" value="dialog-reject" class="btn btnNo"><%= rejectButtonLabel %></button>                <button title="<%= acceptButtonTitle %>" value="dialog-accept" class="btn btn-primary btnYes"><%= acceptButtonLabel %></button>            </div>        </div>    ');u.Dialog=b.MVC.View.extend({defaults:{template:w,mode:"dialog",draggable:!1,wide:!1,modal:"static",rejectButtonLabel:"Close",acceptButtonLabel:"Accept",rejectButtonTitle:"Close",acceptButtonTitle:"Accept"},events:{'click button[value="dialog-reject"]':"hide",'click button[value="dialog-accept"]':"accept"},initialize:function(a){var b=this;switch(this.settings=$.extend({},this.defaults,a),this.setElement(this.settings.template({rejectButtonLabel:this.settings.rejectButtonLabel,acceptButtonLabel:this.settings.acceptButtonLabel,rejectButtonTitle:this.settings.rejectButtonTitle,acceptButtonTitle:this.settings.acceptButtonTitle})),this.$el.appendTo("body"),this.$el.modal({show:!1,backdrop:this.settings.modal,keyboard:!1}),this.settings.mode){case"alert":this.$('button[value="dialog-accept"]').hide()}this.$head=this.$(".dialog-head"),this.$body=this.$(".dialog-body"),this.settings.draggable&&this.$el.draggable({start:function(){b.$el.removeClass("fade")},stop:function(){b.$el.addClass("fade")},cursor:"move"}),this.settings.wide&&this.$el.addClass("wide")},render:function(a,b){this.$body.empty(),this.$head.empty(),this.$body.append(a),void 0!==b?(this.$head.append(b),this.$head.show()):this.$head.hide(),this.$el.modal("show"),this.delegateEvents()},onBeforeHide:$.noop,hide:function(){var a=this;this.onBeforeHide()!==!1&&(this.$el.one("hidden",function(){a.trigger("dialog:rejected"),a.remove(),a.onReject()}),this.$el.modal("hide"))},onReject:$.noop,onBeforeAccept:$.noop,accept:function(){var a=this;this.onBeforeAccept()!==!1&&(this.$el.one("hidden",function(){a.trigger("dialog:accepted"),a.remove(),a.onAccept()}),this.$el.modal("hide"))},onAccept:$.noop});var x=_.template('        <span><%= message %></span>        <i title="<%= acceptTitle%>" class="icon-ok icon-white"></i>        <i title="<%= cancelTitle%>" class="icon-remove icon-white"></i>    ');u.ConfirmMessage=b.MVC.View.extend({tagName:"span",className:"label label-warning pull-right confirmMessage",defaults:{template:x,message:"Warning",acceptTitle:"Accept",cancelTitle:"Cancel"},events:{"click .icon-ok":"accept","click .icon-remove":"cancel"},initialize:function(a){this.settings=$.extend({},this.defaults,a),this._deferred=$.Deferred(),this.result=this._deferred.promise()},accept:function(){this.remove(),this._deferred.resolve()},cancel:function(){this.remove(),this._deferred.reject()},render:function(){return this.$el.html(this.settings.template({message:this.settings.message,acceptTitle:this.settings.acceptTitle,cancelTitle:this.settings.cancelTitle})),this.delegateEvents(),this}}),u.getTimestamp=function(a){var b=a.split(" ")[0],c=b.replace(/-/g,"/");a=a.replace(b,c);var d=new Date(a).getTime();return isNaN(d)?parseInt(a,10):d},u.isNotUndefinedOrNull=function(a){return void 0!==a&&null!==a},u.isFirstTime=function(a){var b="zd_first_enter_ts-"+a,c=u.getCookie(b),d=(new Date).getTime(),e=864e5;return $.isNumeric(c)?e>d-+c?!0:!1:(u.setCookie(b,(new Date).getTime()),!0)},u.setCookie=function(a,b,c){var d=new Date;d.setDate(d.getDate()+c);var e=escape(b)+(null===c?"":"; expires="+d.toUTCString());document.cookie=a+"="+e},u.getCookie=function(a){var b=window.sessionStorage.sessionId;if(!u.isNotUndefinedOrNull(b)){var c=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));b=c?decodeURIComponent(c[1]):void 0}return b},u.namespace=function(a,b){var c=[],d=b||window;return a&&(c=a.split(".")),$.each(c,function(a,b){d.hasOwnProperty(b)||(d[b]={}),d=d[b]}),d},u.isIE=function(){var a,b=window.navigator.userAgent,c=window.navigator.appVersion,d=-1!==b.indexOf("MSIE"),e=c.indexOf("Trident/")>0;return a=d||e?d||e:!1},u.preventUnsavedGestures=function(){if(navigator.userAgent.match(/Macintosh/)&&navigator.userAgent.match(/Chrome/)){{$(window)}b.Utilities.turnOnPrompt("Are you sure you want to leave the page unsaved?"),b.Utilities.preventSwipeForBack()}},u.preventSwipeForBack=function(a){if(navigator.userAgent.match(/Macintosh/)&&navigator.userAgent.match(/Chrome/)){var b=a||$(window);if("undefined"==typeof b.mousewheel)return;b.mousewheel(function(a,b,c,d){if(!(Math.abs(d)>10||0==c)){var e,f,g=$(a.target).parents();e=!_(g).detect(function(a){var b=$(a).scrollLeft()>0;return b}),f=!_(g).detect(function(a){var b=$(a).scrollLeft()-(a.scrollWidth-a.clientWidth)<0;return b}),0>=c&&e===!0&&f===!1&&a.preventDefault(),c>=0&&e===!1&&f===!0&&a.preventDefault()}})}},u.turnOnPrompt=function(a){var b=$(window),c="Are you sure you want to leave the page unsaved?",d=a?a:c;b.unbind("beforeunload"),b.bind("beforeunload",function(){return d})},u.turnOffPrompt=function(){$(window).unbind("beforeunload")};var y=Math.sqrt(2);t.prototype={defaults:{start:-30,angle:120,gap:8,radius:200,width:60,color:"rgba(0, 0, 0, 0.7)"},maxAngle:160,positionElements:function(){var a=this,b=this.options.gap,c=this.options.radius,d=Math.max(this.options.angle,1),e=90-this.options.start,f=90-d,g=c*(1+(0>f?Math.sin(-f/180*Math.PI):0)),h=this.options.radius,i=this.options.width,j=parseInt(this.$center.width())||20,k=parseInt(this.$center.height())||20,l=h-i,m=/(iPhone|iPod|iPad)/i.test(navigator.userAgent),n=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);a.$el.css({width:g,height:g,borderWidth:b/2+"px",transform:(m||n)&&1===e?"rotate("+e+"deg)":"rotate("+e+"deg) skew(0deg, "+f+"deg)",transformOrigin:"100% 100%"}),a.$donut.css({left:g-h,top:g-h,width:2*h,height:2*h,borderWidth:i,transform:(m||n)&&1===e?"rotate("+-(d-90)/2+"deg)":"skew(0deg, "+-f+"deg) rotate("+-(d-90)/2+"deg)"}),(m||n)&&(a.$el.css({transition:"0.1s ease-in","-ms-transition":"0.1s ease-in","-moz-transition":"0.1s ease-in","-webkit-transition":"0.1s ease-in"}),a.$donut.css({transition:"0.1s ease-in","-ms-transition":"0.1s ease-in","-moz-transition":"0.1s ease-in","-webkit-transition":"0.1s ease-in"})),a.$filler.css({left:g-l,top:g-l,width:2*l,height:2*l,transform:"skew(0deg, "+-f+"deg)"}),a.$center.css({left:-(l*(y/2-1)+i*(y/4)+j/2),top:-(l*(y/2-1)+i*(y/4)+k/2),transform:"rotate("+((d-90)/2-e)+"deg)"})},get:function(){var a=[];if(0==arguments.length)a=this.options;else if(1==arguments.length)a=this.options[arguments[0]]||null;else for(var b=0;b<arguments.length;b++)a[arguments[b]]=this.options[arguments[b]]||null;return a},set:function(a){"number"==typeof a.start&&(this.options.start=a.start),"number"==typeof a.angle&&(this.options.angle=Math.min(a.angle,this.maxAngle)),"number"==typeof a.gap&&(this.options.gap=a.gap),"number"==typeof a.radius&&(this.options.radius=a.radius),"number"==typeof a.width&&(this.options.width=a.width),"number"==typeof a.color&&(this.options.color=a.color),this.positionElements()},close:function(){var a=this.options;this.set({start:a.start+a.angle/2,angle:0})},remove:function(){this.$el.remove()}},u.Arc=t,u.getURLParameter=d,u.getHashParameter=e,u.parseUrlParams=f,u.getVisualizationDetails=g,u.getSourceDetails=k,u.pad=c,u.hoursToAMPM=l,u.formattedTimeOnly=m,u.formattedDateOnly=n,u.formattedDate=p,u.timeZoneFromTime=q,u.determineTimeZone=r,u.formattedDateMonth=o,u.getPageUserData=s,u.getFunctionsForMetric=h,u.hasLastValue=i,u.isNumericAttributeType=j,u.time={},u.time.getPreviousHour=function(a){return a-u.time.millisecondsIn.hour},u.time.getMaxStepLimit=function(){return 62},u.time.getLowerStep=function(a){var b="",c=["MINUTE","HOUR","DAY","WEEK","MONTH","YEAR"],d=c.indexOf(a),e=d-1;return b=0>e?"MINUTE":c[e]},u.time.getMaxStep=function(a,b){var c=null,d=["MINUTE","HOUR","DAY","WEEK","MONTH","YEAR"],e=d.indexOf(a),f=d.indexOf(b);if(-1===e)throw"Step 1 is wrong";if(-1===f)throw"Step 2 is wrong";return c=e>f?a:b},u.time.getDaysInMonth=function(a,b){var c=new Date(a);return b?(c.setUTCDate(15),c.setUTCMonth(c.getUTCMonth()+1),c.setUTCDate(0),c.getUTCDate()):(c.setDate(15),c.setMonth(c.getMonth()+1),c.setDate(0),c.getDate())},u.time.formatAMPM=function(a,b){var c,d;b?(c=a.getUTCHours(),d=a.getUTCMinutes()):(c=a.getHours(),d=a.getMinutes());var e=c>=12?"pm":"am";c%=12,c=c?c:12,d=10>d?"0"+d:d;var f=c+":"+d+" "+e;return f},u.time.formatAMPMForHours=function(a,b){var c;c=b?a.getUTCHours():a.getHours();var d=c>=12?"pm":"am";c%=12,c=c?c:12;var e=c+" "+d;return e},u.time.getWeekNumber=function(a,b){if(a=new Date(a),b){a.setUTCHours(0,0,0),a.setUTCDate(a.getUTCDate()+4-(a.getUTCDay()||7));var c=new Date(a.getUTCFullYear(),0,1),d=Math.ceil(((a-c)/864e5+1)/7);return[a.getUTCFullYear(),d]}a.setHours(0,0,0),a.setDate(a.getDate()+4-(a.getDay()||7));var c=new Date(a.getFullYear(),0,1),d=Math.ceil(((a-c)/864e5+1)/7);return[a.getFullYear(),d]},u.time.getRangeForStep=function(a,c,d,e){function f(a,b){return b?(a.setUTCMilliseconds(0),a.setUTCSeconds(0),a.setUTCMinutes(0)):(a.setMilliseconds(0),a.setSeconds(0),a.setMinutes(0)),a}function g(a,b){return a.setDate(b?a.getUTCDate()-a.getUTCDay():a.getDate()-a.getDay()),a}var h=new Date(a),i=new Date(c),j=!1;if(i.getTime()%1e4===9999&&"DAY"===d&&e&&(i.setTime(i.getTime()+1),j=!0),c.getTime()-a.getTime()+1<b.Utilities.time.millisecondsIn[d.toLowerCase()]){switch(d){case"MINUTE":break;case"HOUR":f(h,e),f(i,e),e?i.setUTCHours(i.getUTCHours()+1):i.setHours(i.getHours()+1);break;case"DAY":f(h,e),f(i,e),e?(h.setUTCHours(0),i.setUTCHours(0),i.setUTCDate(i.getUTCDate()+1)):(h.setHours(0),i.setHours(0),i.setDate(i.getDate()+1));break;case"WEEK":f(h,e),f(i,e),g(h,e),g(i,e),e?(h.setUTCHours(0),i.setUTCHours(0),i.setUTCDate(i.getUTCDate()+7)):(h.setHours(0),i.setHours(0),i.setDate(i.getDate()+7));break;case"MONTH":f(h,e),f(i,e),e?(h.setUTCHours(0),h.setUTCDate(1),i.setUTCHours(0),i.setUTCDate(1),i.setUTCMonth(i.getUTCMonth()+1)):(h.setHours(0),h.setDate(1),i.setHours(0),i.setDate(1),i.setMonth(i.getMonth()+1));break;case"YEAR":f(h,e),f(i,e),e?(h.setUTCHours(0),h.setUTCMonth(1),h.setUTCDate(0),i.setUTCHours(0),i.setUTCMonth(1),i.setUTCDate(0),i.setUTCFullYear(i.getUTCFullYear()+1)):(h.setHours(0),h.setMonth(1),h.setDate(0),i.setHours(0),i.setMonth(1),i.setDate(0),i.setFullYear(i.getFullYear()+1))}return{min:h,max:i}}switch(d){case"MINUTE":break;case"HOUR":f(h,e),f(i,e),e?i.setUTCHours(i.getUTCHours()):i.setHours(i.getHours());break;case"DAY":if(f(h,e),f(i,e),e){var k=i.getHours(0)>0?1:0;h.setUTCHours(0),i.setUTCHours(0),i.setUTCDate(i.getUTCDate()+k)}else{var k=i.getHours(0)>0?1:0;h.setHours(0),i.setHours(0),i.setDate(i.getDate()+k)}break;case"WEEK":f(h,e),f(i,e),g(h,e),g(i,e),e?(h.setUTCHours(0),i.setUTCHours(0),i.setUTCDate(i.getUTCDate()+7)):(h.setHours(0),i.setHours(0),i.setDate(i.getDate()+7));break;case"MONTH":f(h,e),f(i,e),e?(h.setUTCHours(0),h.setUTCDate(1),i.setUTCHours(0),i.setUTCDate(1),i.setUTCMonth(i.getUTCMonth()+1)):(h.setHours(0),h.setDate(1),i.setHours(0),i.setDate(1),i.setMonth(i.getMonth()+1));break;case"YEAR":f(h,e),f(i,e),e?(h.setUTCHours(0),h.setUTCMonth(1),h.setUTCDate(0),i.setUTCHours(0),i.setUTCMonth(1),i.setUTCDate(0)):(h.setHours(0),h.setMonth(1),h.setDate(0),i.setHours(0),i.setMonth(1),i.setDate(0))}return{min:h,max:i}},u.time.recalculateLimit=function(a,b,c){var d=1,e=1,f=u.time.getMaxStepLimit();switch(a){case"MINUTE":e=b;break;case"HOUR":e=60*b;break;case"DAY":e=60*b*24;break;case"WEEK":e=60*b*24*7;break;case"MONTH":e=60*b*24*31;break;case"YEAR":e=60*b*24*365}switch(d=e,c){case"MINUTE":d=e;break;case"HOUR":"MINUTE"!==a&&(d=e/60);break;case"DAY":"HOUR"!==a&&(d=e/60/24);break;case"WEEK":"DAY"!==a&&(d=e/60/24/7);break;case"MONTH":"WEEK"!==a&&(d=e/60/24/31);break;case"YEAR":"MONTH"!==a&&(d=e/60/24/365)}return d=Math.ceil(d),d>f?f:d},u.time.getRoundedDateRange=function(a,c,d,e,f){var g="MINUTE",h=0,i=60;if(c.getTime()%1e4===9999&&"DAY"===d&&c.setTime(c.getTime()+1),f)var j="DAY"===d&&a.getUTCHours()>0?1:0;else var j="DAY"===d&&a.getHours()>0?1:0;var k=new Date(a.getTime()),l=new Date(c.getTime());"DAY"===d&&(f?(k.setUTCHours(0),l.setUTCHours(23)):(k.setHours(0),l.setHours(23)));var m=l.getTime()-k.getTime()+j;if(m<=b.Utilities.time.millisecondsIn.hour&&!d)g="MINUTE",h=f?c.getUTCMinutes()-a.getUTCMinutes():c.getMinutes()-a.getMinutes(),i=0>=h?h+61:h+1;else if(m<=b.Utilities.time.millisecondsIn.day&&!d)g="HOUR",h=f?c.getUTCHours()-a.getUTCHours():c.getHours()-a.getHours(),i=0>=h?h+25:h+1;
else if(m<=29*b.Utilities.time.millisecondsIn.day&&!d)g="DAY",f?(h=c.getUTCDate()-a.getUTCDate()+(c.getUTCMonth()-a.getUTCMonth())*b.Utilities.time.getDaysInMonth(a,f),i=0>=h?h+b.Utilities.time.getDaysInMonth(a,f):h+1):(h=c.getDate()-a.getDate()+(c.getMonth()-a.getMonth())*b.Utilities.time.getDaysInMonth(a),i=0>=h?h+b.Utilities.time.getDaysInMonth(a):h+1);else if(m<=60*b.Utilities.time.millisecondsIn.day&&!d)if(g="WEEK",f){h=b.Utilities.time.getWeekNumber(c,f)[1]-b.Utilities.time.getWeekNumber(a,f)[1];var n=new Date(a.getUTCFullYear(),11,31);i=0>=h?h+b.Utilities.time.getWeekNumber(n,f)[1]:h+1}else{h=b.Utilities.time.getWeekNumber(c)[1]-b.Utilities.time.getWeekNumber(a)[1];var n=new Date(a.getFullYear(),11,31);i=0>=h?h+b.Utilities.time.getWeekNumber(n)[1]:h+1}else m<=365*b.Utilities.time.millisecondsIn.day&&!d?(g="MONTH",h=f?c.getUTCMonth()-a.getUTCMonth():c.getMonth()-a.getMonth(),i=0>=h?h+13:h+1):m>365*b.Utilities.time.millisecondsIn.day&&!d&&(g="YEAR",h=f?c.getUTCFullYear()-a.getUTCFullYear():c.getFullYear()-a.getFullYear(),i=h+1);if(i-=1,d){switch(d){case"MINUTE":i=m/1e3/60;break;case"HOUR":i=m/1e3/60/60;break;case"DAY":i=m/1e3/60/60/24;break;case"WEEK":i=m/1e3/60/60/24/7;break;case"MONTH":i=f?12*c.getUTCFullYear()+c.getUTCMonth()-(12*a.getUTCFullYear()+a.getUTCMonth()):12*c.getFullYear()+c.getMonth()-(12*a.getFullYear()+a.getMonth());break;case"YEAR":i=m/1e3/60/60/24/365}g=d,i="MONTH"===d?i:Math.ceil(i)+(e?1:0)}return i=0>=i?1:i,{step:g,amount:i}},u.time.days=[{acr:"Sun",full:"Sunday"},{acr:"Mon",full:"Monday"},{acr:"Tue",full:"Tuesday"},{acr:"Wed",full:"Wednesday"},{acr:"Thu",full:"Thursday"},{acr:"Fri",full:"Friday"},{acr:"Sat",full:"Saturday"}],u.time.months=[{acr:"Jan",full:"January",days:31},{acr:"Feb",full:"February",days:28},{acr:"Mar",full:"March",days:31},{acr:"Apr",full:"April",days:30},{acr:"May",full:"May",days:31},{acr:"Jun",full:"June",days:30},{acr:"Jul",full:"July",days:31},{acr:"Aug",full:"August",days:31},{acr:"Sep",full:"September",days:30},{acr:"Oct",full:"October",days:31},{acr:"Nov",full:"November",days:30},{acr:"Dec",full:"December",days:31}],u.time.millisecondsIn={},u.time.millisecondsIn.sec=1e3,u.time.millisecondsIn.min=60*u.time.millisecondsIn.sec,u.time.millisecondsIn.hour=60*u.time.millisecondsIn.min,u.time.millisecondsIn.day=24*u.time.millisecondsIn.hour,u.time.millisecondsIn.week=7*u.time.millisecondsIn.day,u.time.millisecondsIn.month=31*u.time.millisecondsIn.day,u.time.millisecondsIn.year=365*u.time.millisecondsIn.day,u.time.getEndTimeWithinStep=function(a,b,c){var d=new Date(a);switch(b){case"MINUTE":c?(d.setUTCMilliseconds(0),d.setUTCSeconds(0),d.setUTCMinutes(d.getUTCMinutes()+1)):(d.setMilliseconds(0),d.setSeconds(0),d.setMinutes(d.getMinutes()+1));break;case"HOUR":c?(d.setUTCMilliseconds(0),d.setUTCSeconds(0),d.setUTCMinutes(0),d.setUTCHours(d.getUTCHours()+1)):(d.setMilliseconds(0),d.setSeconds(0),d.setMinutes(0),d.setHours(d.getHours()+1));break;case"DAY":c?(d.setUTCMilliseconds(0),d.setUTCSeconds(0),d.setUTCMinutes(0),d.setUTCHours(0),d.setUTCDate(d.getUTCDate()+1)):(d.setMilliseconds(0),d.setSeconds(0),d.setMinutes(0),d.setHours(0),d.setDate(d.getDate()+1));break;case"WEEK":c?(d.setUTCMilliseconds(0),d.setUTCSeconds(0),d.setUTCMinutes(0),d.setUTCHours(0),d.setUTCDate(d.getUTCDate()+7)):(d.setMilliseconds(0),d.setSeconds(0),d.setMinutes(0),d.setHours(0),d.setDate(d.getDate()+7));break;case"MONTH":c?(d.setUTCMilliseconds(0),d.setUTCSeconds(0),d.setUTCMinutes(0),d.setUTCHours(0),d.setUTCDate(1),d.setUTCMonth(d.getUTCMonth()+1)):(d.setMilliseconds(0),d.setSeconds(0),d.setMinutes(0),d.setHours(0),d.setDate(1),d.setMonth(d.getMonth()+1));break;case"YEAR":c?(d.setUTCMilliseconds(0),d.setUTCSeconds(0),d.setUTCMinutes(0),d.setUTCHours(0),d.setUTCDate(1),d.setUTCMonth(0),d.setUTCFullYear(d.getUTCFullYear()+1)):(d.setMilliseconds(0),d.setSeconds(0),d.setMinutes(0),d.setHours(0),d.setDate(1),d.setMonth(0),d.setFullYear(d.getFullYear()+1))}return d.getTime()},u.convertTimeToStringUTC=function(a,b){function c(a){var b=a+"";return b.length<2?"0"+b:b}a=new Date(a),b="undefined"!=typeof b?b:!0;var d=new Date(a),e=b?d.getUTCFullYear():d.getFullYear(),f=c((b?d.getUTCMonth():d.getMonth())+1),g=c(b?d.getUTCDate():d.getDate()),h=c(b?d.getUTCHours():d.getHours()),i=c(b?d.getUTCMinutes():d.getMinutes()),j=c(b?d.getUTCSeconds():d.getSeconds()),k=e+"-"+f+"-"+g+" "+h+":"+i+":"+j;return k},u.log10=function(a){return Math.log(a)/Math.log(10)},u.isRetina=function(){return window.devicePixelRatio>1},u.toTitleCase=function(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})},u.MODE={NORMAL:0,WIDGET:1,EMBEDDED:2,NATIVE:3};var z=-1;u.mode=function(){if(-1!==z)return z;z=u.MODE.NORMAL;var a=d("__target");if("widget"===a)z=u.MODE.WIDGET;else if("embedded"===a)z=u.MODE.EMBEDDED;else{var b=/(iPhone|iPod|iPad)/i.test(navigator.userAgent),c=/(Safari)/i.test(navigator.userAgent);b&&!c&&(z=u.MODE.NATIVE)}return z},u.getHiddenControls=function(){var a=d("hidecontrol");return a=a?a.split(","):[],console.log("hiddenControls",a),a},u.visualizationStartedUnique={_counter:0},u.visualizationStarted=function(a){var c={WORD_CLOUD:1e3,ZOOMABLE_MAP:2e3,VERTICAL_BARS:100,HEAT_MAP:1e3,MULTI_METRIC_TREND:100,SIDE_BY_SIDE_BARS:900,STACKED_BARS:900,TRENDS:100,PIE:600,PIVOT_TABLE:1e3,DEFAULT:100},d=c.DEFAULT,e=b.main?b.main.currentSection.widgetGrid.collection.length:null;if(a){if(u.visualizationStartedUnique[a.UUID])return!1;u.visualizationStartedUnique[a.UUID]=!0,d=a.customReadyStatusDelay?a.customReadyStatusDelay:c[a.config.type]||c.DEFAULT,d+=1002}b.Utilities.preventSwipeForBack();var f="screenshot_status_ready",g=$("body");return setTimeout(function(){u.visualizationStartedUnique._counter++,e===u.visualizationStartedUnique._counter&&(g.addClass(f),console.log(a.UUID+" started with delay "+d+"ms."))},d),!0},u.isSingleVizualization=function(){return b.main.currentSection.widgetGrid.childViews.length<2},u.isSmallWidget=function(a,b){var c=500,d=380;return c>=a||d>=b},u.getWidgetSizeClass=function(a,b){var c=500,d=380,e=1e3,f=700,g=["small","medium","large"],h=g[1];return(a>e||b>f)&&(h=g[2]),(e>=a||f>=b)&&(a>=c||b>=d)&&(h=g[1]),(c>a||d>b)&&(h=g[0]),h},u.generateUUID=function(){return"xxxxxxxxxxxxxxxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},"undefined"!=typeof Hammer&&(Hammer.plugins.fakeMultitouch(),$(function(){$("body").hammer()})),u.getVersion=function(){var a=$.Deferred(),c=b.pageData&&b.pageData.version?b.pageData.version:null;return c?a.resolve(c):$.ajax({url:"service/version/",success:function(b){a.resolve(b)},fail:function(){a.reject()}}),a.promise()},u.getUrlVars=function(){{var a={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(b,c,d){a[c]=d})}return a},u.detectTouchDevice=function(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0},u.sourceExists=function(a,b,c){var d=!1;return admin.sources.each(function(a){b.toLowerCase()===a.get("name").toLowerCase()&&a.get("id")!==c&&(d=!0)}),d},u.isIOS=function(){return/(iPhone|iPod|iPad)/i.test(navigator.userAgent)},u.rTrim=function(a){return a.replace(/\s+$/,"")},u.lTrim=function(a){return a.replace(/^\s+/,"")},u.appendStylesWithScoping=function(a,b){a&&a.each(function(a,c){var d=document.createElement("STYLE"),e=!1;$(c.attributes).each(function(a,b){var c=b.name||b.nodeName,f=b.value||""===b.value?b.value:b.nodeValue;e=e||"scoped"===c,d.setAttribute(c,f)}),d.innerHTML=c.innerText,b.appendChild(d),e&&$(d).scopedPolyFill()})},u.scopedPolyFill=function(a){function b(a,c){if(c&&(a=c),!a.nodeName)return a.jquery?a.each(b):void 0;if("STYLE"===a.nodeName&&!e.scopeSupported){for(var d,g,h,i=a[e.sheet],j=i[e.rules],k=a.parentNode,l=(k.id||(k.id="scopedByScopedPolyfill_"+ ++f),""),m=j.length||0;k;)k.id&&(l="#"+k.id+" "+l),k=k.parentNode;for(;m--;)d=j[m],g=l+" "+d.selectorText.split(",").join(", "+l),g=g.replace(/[\ ]+:root/gi,""),e.changeSelectorTextAllowed?d.selectorText=g:d.type&&1!==d.type||(h=d.style.cssText,i.removeRule?i.removeRule(m):i.deleteRule(m),i.addRule&&h.length>0?i.addRule(g,h):i.insertRule(g+"{"+h+"}",m))}}var c,d,e=function(){var b,c,d,e=a.createElement("style"),f="undefined"!=typeof e.sheet?"sheet":"undefined"!=typeof e.getSheet?"getSheet":"styleSheet",g="undefined"!=typeof e.scoped;a.body.appendChild(e),b=e[f],b.addRule?b.addRule("c","blink"):b.insertRule("c{}",0),c=b.rules?"rules":"cssRules",d=b[c][0];try{d.selectorText="d"}catch(h){}var i="d"===d.selectorText.toLowerCase();return e.parentNode.removeChild(e),{scopeSupported:g,rules:c,sheet:f,changeSelectorTextAllowed:i}}(),f=0;if(a.querySelectorAll)c=a.querySelectorAll("style[scoped]");else{var g,h=[];for(c=a.getElementsByTagName("style"),d=c.length;d--;)g=c[d].getAttribute("scoped"),("scoped"===g||""===g)&&h.push(c[d]);c=h}for(d=c.length;d--;)b(c[d]);return"function"==typeof jQuery&&"object"==typeof jQuery.fn&&(jQuery.fn.scopedPolyFill=function(){return this.each(b)}),b}(document),u.getImgFromSvg=function(a){function b(a,c){function d(a,b){var c=u.getStyles(a),d=a[0];"text"==d.tagName&&"undefined"==typeof c["font-size"]&&(c["font-size"]=h),b.css(c)}a.children().length?a.children().each(function(){var a=$(this),d=a.clone();d.children().remove(),c.append(d),b(a,d)}):d(a,c)}var c,d=$.Deferred(),e=new Image,f=$(a).width(),g=$(a).height(),h=$("body").css("font-size"),i={prefix:'<svg                        version="1.1"                        xmlns="http://www.w3.org/2000/svg"                        xmlns:xlink="http://www.w3.org/1999/xlink"                        width="'+f+'" height="'+g+'">                        <defs>                            <style>                                @font-face {                                    font-family: "source-sans-pro";                                    src: url(data:application/x-font-woff;charset=utf-8;base64,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) format("woff"),                                    url("sourcesanspro-regular-webfont.ttf") format("truetype");                                }                            </style>                        </defs>                        ',postfix:"</svg>"},j=$([i.prefix,i.postfix].join(""));
return e.width=f,e.height=g,$(a).each(function(){var a=$(this);b(a,j)}),e.onload=function(){var a,b=new Image;c=document.createElement("canvas"),document.body.appendChild(c),c.width=f,c.height=g,a=c.getContext("2d"),a.drawImage(e,0,0),b.width=f,b.height=g,b.onload=function(){document.body.removeChild(c),d.resolve(b)},b.src=c.toDataURL("image/png")},e.src="data:image/svg+xml;base64,"+btoa([i.prefix,j.html(),i.postfix].join("")),d.promise()},u.getStyles=function(a){function b(a){var b=document.styleSheets,d={};for(var e in b){var f=b[e].rules||b[e].cssRules;for(var g in f)a.is(f[g].selectorText)&&(d=$.extend(d,c(f[g].style),c(a.attr("style"))))}return d}function c(a){var b={};if(!a)return b;if(a instanceof CSSStyleDeclaration)for(var c in a)a[c].toLowerCase&&(b[a[c].toLowerCase()]=a[a[c]]);else if("string"==typeof a){a=a.split(/[;][ ]?/);for(var c in a){var d=a[c].split(": ");b[d[0].toLowerCase()]=d[1]}}return b}return b(a)},function(a){function b(a){var b=document.querySelectorAll("svg image"),c=b.length;0==c&&a();for(var d=0;d<b.length;d++)!function(b){if(b.getAttribute("xlink:href")){var d=b.getAttribute("xlink:href").value;if(/^http/.test(d)&&!new RegExp("^"+window.location.host).test(d))throw new Error("Cannot render embedded images linking to external hosts.")}var e=document.createElement("canvas"),f=e.getContext("2d"),g=new Image;g.src=b.getAttribute("xlink:href"),g.onload=function(){e.width=g.width,e.height=g.height,f.drawImage(g,0,0),b.setAttribute("xlink:href",e.toDataURL("image/png")),c--,0==c&&a()}}(b[d])}function c(a){for(var b="",c=document.styleSheets,d=0;d<c.length;d++)for(var e=c[d].cssRules,f=0;f<e.length;f++){var g=e[f];if("undefined"!=typeof g.style){var h=a.querySelectorAll(g.selectorText);h.length>0&&(b+=g.selectorText+" { "+g.style.cssText+" }\n")}}var i=document.createElement("style");i.setAttribute("type","text/css"),i.innerHTML="<![CDATA[\n"+b+"\n]]>";var j=document.createElement("defs");return j.appendChild(i),j}var d="undefined"!=typeof a&&a||this,e='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">';d.svgAsDataUri=function(a,d,f){d=d||1,b(function(){var b=document.createElement("div"),g=a.cloneNode(!0),h=a.clientWidth,i=a.clientHeight,j="http://www.w3.org/2000/xmlns/";g.setAttribute("version","1.1"),g.setAttributeNS(j,"xmlns","http://www.w3.org/2000/svg"),g.setAttributeNS(j,"xmlns:xlink","http://www.w3.org/1999/xlink"),g.setAttribute("width",h*d),g.setAttribute("height",i*d),g.setAttribute("viewBox","0 0 "+h+" "+i),b.appendChild(g),g.insertBefore(c(g),g.firstChild);var k=e+b.innerHTML,l="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(k)));f&&f(l)})},d.saveSvgAsPng=function(a,b){var c=$.Deferred();return d.svgAsDataUri(a,b,function(a){var b=new Image;b.src=a,b.onload=function(){var a=document.createElement("canvas"),d=new Image;a.width=b.width,a.height=b.height;var e=a.getContext("2d");e.drawImage(b,0,0),d.src=a.toDataURL("image/png"),d.onload=function(){c.resolve(d)}}}),c.promise()}}(u),b.Utilities=u}(window,Zoomdata),function(a,b){"use strict";b.Models=b.Models||{},b.Models.Visualization=b.MVC.Model.extend({urlRoot:"service/visualizations",initialize:function(){b.MVC.Model.prototype.initialize.apply(this,arguments),this.on("change sync",this.setIconUrl),this.setIconUrl()},setIconUrl:function(){var a=this.get("thumbnailId"),b=this.get("type"),c="";if(a)c=this.urlRoot+"/"+this.get("visId")+"/thumbnail/"+a+".svg?v=09191456";else switch(b){case"VERTICAL_BARS":c="images/Template_Bars_Button_sm.png?v=09191456";break;case"BUBBLES":c="images/Template_Bubbles_Button_sm.png?v=09191456";break;case"SCATTERPLOT":c="images/Template_Scatterplot_Button_sm.png?v=09191456";break;case"PIE":c="images/Template_Pie_Button_sm.png?v=09191456";break;case"WORD_CLOUD":c="images/Template_WordCloud_Button_sm.png?v=09191456";break;case"MAP":c="images/Template_ZoomableMap_Button_sm.png?v=09191456";break;case"TRENDS":c="images/Template_TimeTrend_Button_alt_sm.png?v=09191456";break;case"ZOOMABLE_MAP":c="images/Template_ZoomableMap_Button_sm.png?v=09191456";break;case"PIVOT_TABLE":c="images/Template_GridView_Button_sm.png?v=09191456";break;case"HEAT_MAP":c="images/Template_HeatMap_Button_sm.png?v=09191456";break;case"HORIZONTAL_BARS":c="images/Template_HorizBar_Button_sm.png?v=09191456";break;case"SIDE_BY_SIDE_BARS":c="images/Template_MultiBar_Button_sm.png?v=09191456";break;case"MULTI_METRIC_BARS":c="images/Template_MultiBar_Button_sm.png?v=09191456";break;case"VERTICAL_STACKED_BARS":c="images/Template_MultiGroup_Bar_Button_sm.png?v=09191456";break;case"VERTICAL_100PCT_STACKED_BARS":c="images/Template_Vertical_100pct_Stacked_sm.png?v=09191456";break;case"HORIZONTAL_SIDE_BY_SIDE_BARS":c="images/Template_SideBySide_Horiz_Button_sm.png?v=09191456";break;case"MULTI_LINE":c="images/Template_MultiLine_Button_sm.png?v=09191456";break;case"MULTI_METRIC_TREND":c="images/Template_LineAndBar_Button_sm.png?v=09191456";break;case"FINGERPAINT":c="images/Template_Fingerpaint_Button_sm.png?v=09191456";break;case"DONUT":c="images/Template_Donut_Button_sm.png?v=09191456";break;default:c="images/Template_Custom_Button_sm.png?v=09191456"}this.set("thumbnailUrl",c,{silent:!0})},saveEnabled:function(a){this.save({enabled:a})}})}(window,Zoomdata),function(a,b){"use strict";var c=b.Models.Visualization;b.Models=b.Models||{},b.Models.SourceVisualization=c.extend({idAttribute:"visId",initialize:function(a,c){return b.Models.Visualization.prototype.initialize.apply(this,arguments),c=c||{},c.sourceId?(this.setSource(c.sourceId),delete c.sourceId):this.attributes.source&&this.attributes.source.sourceId&&this.setSource(this.attributes.source.sourceId),this},setSource:function(a){return this.sourceId=a,this},getSourceId:function(){return this.sourceId||this.collection.sourceId},url:function(){if(this.getSourceId())return"service/sources/"+this.getSourceId()+"/visualizations/"+this.get("visId");throw new Error("sourceId must be defined")}})}(window,Zoomdata),function(a,b){var c=b.Models.SourceVisualization;b.Models=b.Models||{},b.Models.VisualizationConfig=c.extend({idAttribute:"id",fetch:function(){var a=this,c=_.clone(this.attributes),d=$.Deferred();return b.Models.SourceVisualization.prototype.fetch.apply(this,arguments).done(function(){$.extend(!0,a.attributes,c),d.resolve(arguments)}).fail(function(){d.reject(arguments)}),d.promise()}})}(window,Zoomdata),function(a,b){"use strict";b.Models=b.Models||{},b.Models.Filter=b.MVC.Model.extend({defaults:{path:null,operation:"IN",value:[],editable:!1},idAttribute:"path",initialize:function(){_.bindAll(this,"hasAttribute","addAttribute","removeAttribute","hasValue","isEqualToFilter")},hasAttribute:function(a){return"number"==typeof this.attributes.value?this.attributes.value===a:this.attributes.value&&this.attributes.value.indexOf(a.toString())>=0},hasValue:function(){var a=this.attributes.value;return null!==a&&("number"==typeof a||a.length>0)},addAttribute:function(a,b){var c=_.clone(this.get("value"))||[];return-1==c.indexOf(a)&&(c.push(a),this.set("value",c,b)),this},removeAttribute:function(a,b){var c=_.clone(this.get("value")),d=c&&c.indexOf(a);return c&&-1!==d?(c.splice(d,1),this.set("value",c,b),c.length?this:(this.collection&&this.collection.remove(this,b),null)):this},isEqualToFilter:function(a){if(!a)return!1;var b=a.get("operation")===this.get("operation")&&a.get("path")===this.get("path");if(b){var c=this.get("value"),d=a.get("value");b=c===d||2===c.length&&2===d.length&&c[0]===d[0]&&c[1]===d[1]}return b},toRequest:function(){return{path:this.get("path"),value:this.get("value"),operation:this.get("operation")}}})}(window,Zoomdata),function(a,b){"use strict";b.Models=b.Models||{},b.Models.ObjectField=b.MVC.Model.extend({initialize:function(){b.MVC.Model.prototype.initialize.apply(this,arguments),this.on("change:name change:type",this._setComposedId),this._setComposedId()},_setComposedId:function(){this.id=this._composedId()},_composedId:function(){return this.get("name")+this.get("type")},updateFacetValues:function(a,b,c,d){var e=this,f=this.get("name"),g="service/stream/"+this.collection.sourceId+"/facet/"+f+"?from="+c+"&to="+d+(a?"&query="+a:""),h=$.ajax({type:"POST",url:g,data:JSON.stringify(b),contentType:"application/json"}).done(function(){}).fail(function(){console.warn("Couldn't get values for ObjectField ",e.get("name"))});return h.promise()},updateValues:function(a){var b=this,c=this.get("name"),d=this.collection.url()+c+"/values"+(a?"?query="+a:"/"),e=$.ajax({type:"GET",url:d,contentType:"application/json"}).done(function(a){b.values=a}).fail(function(){console.warn("Couldn't get values for ObjectField ",b.get("name"))});return e.promise()}})}(window,Zoomdata),function(a,b){"use strict";b.Collections=b.Collections||{},b.Collections.Filters=b.MVC.Collection.extend({model:b.Models.Filter,toRequest:function(){return this.map(function(a){return{path:a.get("path"),value:a.get("value"),operation:a.get("operation")}})}})}(window,Zoomdata),function(a,b){"use strict";var c=b.MVC.Model.extend({idAttribute:"name"});b.Collections=b.Collections||{},b.Collections.Formulas=b.MVC.Collection.extend({model:c,initialize:function(a,c){return c=c||{},c.sourceId&&(this.sourceId=c.sourceId,delete c.sourceId),b.MVC.Collection.prototype.initialize.apply(this,arguments),this},setSource:function(a){return this.sourceId=a,this},url:function(){if(this.sourceId)return"service/sources/"+this.sourceId+"/formulas/";throw new Error("sourceId must be defined")}})}(window,Zoomdata),function(a,b){"use strict";function c(a){var b="boolean"==typeof a.get("visible")?a.visible:!0;return new d({name:a.get("name"),label:a.get("label"),type:"FORMULA",func:"mvel",visible:b})}var d=b.Models.ObjectField,e=b.Collections.Formulas,f=["ATTRIBUTE","TEXT","NUMBER","MONEY","INTEGER","COUNT OF","FORMULA"];b.Collections=b.Collections||{},b.Collections.ObjectFields=b.MVC.Collection.extend({model:d,volumeField:new d({label:"Volume",name:"count",type:"NUMBER",visible:!0}),noneField:new d({label:"None",name:"none",type:"NONE",visible:!0}),defaults:{},initialize:function(a,c){var d;c=c||{},c.sourceId&&(this.sourceId=c.sourceId,delete c.sourceId),b.MVC.Collection.prototype.initialize.apply(this,arguments),d=this.where({type:"FORMULA"}),this.formulas=new e(d,{secure:this.secure,remote:this.remote,apiKey:this.apiKey,sourceId:this.sourceId}),this.listenTo(this.formulas,"add",this._onFormulaAdd),this.listenTo(this.formulas,"remove",this._onFormulaRemove),this.listenTo(this.formulas,"change",this._onFormulaChange),this.listenTo(this.formulas,"reset",this._onFormulasReset),this.listenTo(this.formulas,"sync",this._syncFormulas)},constructor:function(){b.MVC.Collection.prototype.constructor.apply(this,arguments),this._ensureVolumeField(),this._ensureNoneField(),this.on("all",this._ensureVolumeField),this.on("all",this._ensureNoneField)},_syncFormulas:function(){var a=this.formulas,b=a.map(c),d=this.where({type:"FORMULA"}),e=_.filter(d,function(a){var c=_.find(b,function(b){return b.id!==a.id});return"undefined"==typeof c});this.set(b,{remove:!1}),this.remove(e)},_onFormulaAdd:function(a){var b=c(a);this.add(b,{merge:!0})},_onFormulaRemove:function(a){var b=c(a);this.remove(b,{merge:!0})},_onFormulaChange:function(a){var b=c(a),d=this.get(b.id);d&&d.set(b.toJSON())},_onFormulasReset:function(a){var b=a.map(c);this.add(b)},_ensureVolumeField:function(a){var b=this.volumeField,c=this.get(b.id);c?null:this.add(b,a)},_ensureNoneField:function(a){var b=this.noneField,c=this.get(b.id);c?null:this.add(b,a)},setSource:function(a){return this.sourceId=a,this.formulas.setSource(a),this},url:function(){if(this.sourceId)return"service/sources/"+this.sourceId+"/attributes/";throw new Error("sourceId must be defined")},fetch:function(a){function c(){f++,2==f&&(e._ensureVolumeField(),e._syncFormulas(),g.resolve(e.toJSON()))}function d(a){_.each(a,function(a){if(a.distinctCount){var b={name:a.name,label:a.label,type:"COUNT OF",func:"distinct_count",visible:!0};e.add(b)}})}a=a||{},a.reset=!0;var e=this,f=0,g=$.Deferred(),h=this.formulas.fetch(),i=b.MVC.Collection.prototype.fetch.call(this,a);return i.done(function(a){d(a),c()}).fail(g.reject),h.done(c).fail(g.reject),g.promise()},filterByTypes:function(a){return this.remove(this.filter(function(b){return-1==a.indexOf(b.get("type"))&&"COUNT OF"!=b.get("type")})),this},removeBlueAttributes:function(){return this.remove(this.filter(function(a){return"ATTRIBUTE"!=a.get("type")})),this},filterHidden:function(){return this.remove(this.filter(function(a){return!a.get("visible")})),this},comparator:function(a){return f.indexOf(a.get("type"))}})}(window,Zoomdata),function(a,b){"use strict";var c=b.Models.SourceVisualization;b.Collections=b.Collections||{},b.Collections.SourceVisualizations=b.MVC.Collection.extend({defaults:{},initialize:function(a,c){return c=c||{},c.sourceId&&(this.sourceId=c.sourceId,delete c.sourceId),b.MVC.Collection.prototype.initialize.apply(this,arguments),this},setSource:function(a){return this.sourceId=a,this},model:c,url:function(){if(this.sourceId)return"service/sources/"+this.sourceId+"/visualizations";throw new Error("sourceId must be defined")}})}(window,Zoomdata),function(a,b){"use strict";b.Models=b.Models||{},b.Models.GroupBy=b.MVC.Model.extend({defaults:{name:"",limit:30,sort:{name:"count",dir:"Descending Value"}},setAttribute:function(a,b){return this.set({name:a},b),this},getAttribute:function(){return this.get("name")},getLabel:function(){return this.label},setLimit:function(a,b){return this.set({limit:+a},b),this},getLimit:function(){return+this.get("limit")},setSort:function(a,b){var c=_.clone(this.get("sort"));return c.name=a.name,c.dir=a.dir,this.set({sort:c},b),this},setSortMetric:function(a,b){var c=_.clone(this.get("sort"));return c.name=a,this.set({sort:c},b),this},setSortDirection:function(a,b){var c=_.clone(this.get("sort"));return c.dir=a,this.set({sort:c},b),this},_updateDomain:function(a){var b=this,c=this.collection.indexOf(this);this.domainValue=[],a.forEach(function(a){"string"==typeof a.group&&0===c?b.domainValue.push(a.group):-1===b.domainValue.indexOf(a.group[c])&&b.domainValue.push(a.group[c])}),b.domainValue.sort()},colorRange:function(){var a,b=this.get("groupColors")||{},c=this.domain()||[],d=c.length;if(0===d)return[];3>d&&(d=3),this.get("autoColor")&&(b={});do a=colorbrewer[this.get("groupColorSet")][d],d-=1;while(!a&&colorbrewer[this.get("groupColorSet")]);return d=a.length,c.map(function(c,e){return b[c]||a[e%d]})},domain:function(){return _.clone(this.domainValue)},_setField:function(a){this.field=a},getColorKeyLabel:function(){return this.field.get("label")},isMetric:function(){return!1},toJSON:function(a){var c=this,d=b.MVC.Model.prototype.toJSON.call(this,arguments),e=d.sort.dir,f=e;return"Ascending Value"===e&&(f="asc"),"Descending Value"===e&&(f="desc"),d.sort.dir=f,d.limit=+d.limit,a||$.each(d,function(a){"undefined"==typeof c.defaults[a]&&delete d[a]}),d}})}(window,Zoomdata),function(a,b){"use strict";b.Collections=b.Collections||{},b.Collections.GroupBy=b.MVC.Collection.extend({model:b.Models.GroupBy,initialize:function(a,c){return c=c||{},b.MVC.Collection.prototype.initialize.apply(this,arguments),this.options=$.extend({},this.defaults,c),this.options.definition?(this.definition=_.extend({},this.options.definition),this.definition.config=this.definition.config?JSON.parse(this.definition.config):{},delete this.options.definition):this.definition={},c.silent=!1,this.on("add",this.initGroupByLabel,this),this},getName:function(){var a=this.definition.config,b=a&&a.groupNames?a.groupNames[0]:this.definition.name;return b},initGroupByLabel:function(a){var b=this.definition.config,c=b&&b.groupNames?b.groupNames.slice(0):[this.definition.name],d=this.models.indexOf(a);c&&"string"==typeof c[d]&&(a.label=c[d])},getAttribute:function(){var a=this.at(0),b="";return a&&(b=a.getAttribute()),b},getAttributes:function(){return this.pluck("name")},setAttribute:function(a,b){var c=this.at(0);return c&&c.setAttribute(a,b),this},setAttributes:function(a,b){var c=this;return Array.isArray(a)?(a.forEach(function(a,b){c.at(b)&&c.at(b).setAttribute(a,{silent:!0})}),b&&b.silent||this.trigger("change",this)):this.setAttribute(a,b),this},getLimit:function(){var a=this.at(0);return a.getLimit()},setLimit:function(a,b){var c=this.at(0);return c&&c.setLimit(a,b),this}})}(window,Zoomdata),function(a,b){"use strict";{var c=b.Collections.SourceVisualizations,d=b.Collections.ObjectFields,e=b.Collections.Formulas;b.Collections.Attributes}b.Models=b.Models||{},b.Models.Source=b.MVC.Model.extend({urlRoot:"service/sources",initialize:function(){b.MVC.Model.prototype.initialize.apply(this,arguments),this.visualizations=new c(this.attributes.visualizations,{secure:this.secure,remote:this.remote,apiKey:this.apiKey}),this.objectFields=new d(this.attributes.objectFields,{secure:this.secure,remote:this.remote,apiKey:this.apiKey}),this.formulaList=this.objectFields.formulas,this.on("sync",this._onSync),this._onSync()},_onSync:function(){this.updateVisualizations(),this.updateObjectFields()},_detectTypeViaJdbc:function(a,b){return-1!=a.indexOf("redshift.amazonaws.com")?b="REDSHIFT":-1!=a.indexOf("jdbc:oracle")?b="ORACLE":-1!=a.indexOf("jdbc:mysql")?b="MYSQL":-1!=a.indexOf("jdbc:sqlserver")?b="SQLSERVER":-1!=a.indexOf("jdbc:postgresql")?b="POSTGRESQL":a&&-1!=a.indexOf("jdbc:presto")&&(b="PRESTO"),b},_detectTypeViaPathFile:function(a,b){return b=a&&0===a.indexOf("s3")?"S3":"HDFS"},updateVisualizations:function(){var a=this.get("id");this.visualizations.setSource(a),this.visualizations.set(this.attributes.visualizations)},updateObjectFields:function(){var a=this.get("id"),b=new d(this.attributes.objectFields),c=new e(this.attributes.formulas);this.objectFields.setSource(a),this.objectFields.set(b.toArray()),this.formulaList.set(c.toArray())},validate:function(){this.attributes.visualizations=this.visualizations.toJSON()},saveViewCount:$.noop()})}(window,Zoomdata),function(a,b){"use strict";var c=b.Models.Source,d=["name","description","type","streamType","lastModified","viewsCount","storageConfiguration","enabled"].join(",");b.Collections=b.Collections||{},b.Collections.Sources=b.MVC.Collection.extend({url:"service/sources",model:c,initialize:function(a,c){return c=c||{},"boolean"==typeof c.lightweight&&(this.lightweight=c.lightweight,delete c.lightweight),b.MVC.Collection.prototype.initialize.apply(this,arguments)},filterByVisualizations:function(a){var b=[];return this.each(function(c){c.visualizations.where(a).length&&b.push(c)}),b},filterDisabled:function(){return this.remove(this.filter(function(a){return!a.get("enabled")})),this},fetch:function(a){var c=_.clone(a)||{};return("boolean"==typeof c.lightweight?c.lightweight:this.lightweight)&&(c.data=$.extend({},c.data,{fields:d})),b.MVC.Collection.prototype.fetch.call(this,c)}})}(window,Zoomdata),function(a,b){"use strict";b.Models=b.Models||{},b.Models.Metric=b.MVC.Model.extend({defaults:{label:"",name:"",func:""},initialize:function(a,c){return b.MVC.Model.prototype.initialize.apply(this,arguments),c=c||{},this.options=$.extend({},this.defaults,c),this._setModelId(),this},_setModelId:function(){var a,b=this.get("label");this.get("id")||(a=this.collection?this.collection.where({label:b}):[],this.set("id",b+"-"+a.length,{silent:!0}))},isCount:function(){return"count"==this.get("name")},isNone:function(){var a=this.get("name");return"none"==a},getColorKeyLabel:function(){return this.get("label")},isMetric:function(){return!0}})}(window,Zoomdata),function(a,b){"use strict";var c=b.Models.Metric;b.Collections=b.Collections||{},b.Collections.Metrics=b.MVC.Collection.extend({model:c,initialize:function(a){return a=a||{},b.MVC.Collection.prototype.initialize.apply(this,arguments),this.options=$.extend({},this.defaults,a),this}})}(window,Zoomdata),function(a,b){"use strict";function c(a){return a.substring(0,a.lastIndexOf("."))}b.Models=b.Models||{},b.Models.ComponentSource=b.MVC.Model.extend({defaults:{},getConstructorName:function(){return c(this.get("name"))},url:function(){var a="string"==typeof this.remote?this.remote+"/":"",c="string"==typeof this.remote&&"boolean"==typeof this.secure?this.secure?"https://":"http://":"",d=b.MVC.Model.prototype.url.apply(this,arguments);return d+="/"+this.get("uploadDate"),c+a+d},load:function(a){var c=this,d=this.get("type"),e=$.Deferred(),f=this.url(),g=($("head"),a),h=this.apiKey||b.Utilities.getURLParameter("key");switch(d){case"text/template":f+=h?"?unwrapped=true&key="+h:"?unwrapped=true",$.ajax({cache:!0,dataType:"text",url:f}).done(function(a){$("<script type='text/template'>"+a+"</script>").appendTo($("head")),e.resolve()}).fail(function(a,b,d){console.error("Failed to load: "+c.get("name")+" with exception: "+d),e.reject(a)});break;case"text/css":h&&(f+="?key="+h),$.ajax({cache:!0,dataType:"text",url:f}).done(function(a){var b=c.get("visualizationId")||c.collection.visId,d=c.get("id");$(".widgetContent[data-visid="+b+"]").each(function(c,e){var f=$(e).parent();if(f.children('[data-componentid="'+d+'"]').length>0);else{var g=$('<style data-visid="'+b+'" data-componentid="'+d+'" scoped>'+a+"</style>").appendTo(f);g.scopedPolyFill&&g.scopedPolyFill()}});$("body style").length+$("body link").length;e.resolve()}).fail(function(a,b,d){console.error("Failed to load: "+c.get("name")+" with exception: "+d),e.reject(a)});break;default:f+="?namespace="+g+"&function="+this.getConstructorName(),$.ajax({cache:!0,dataType:"script",url:f}).done(function(){e.resolve()}).fail(function(a,b,d){console.error("Failed to load: "+c.get("name")+" with exception: "+d),e.reject(a)})}return e.promise()}})}(window,Zoomdata),function(a,b){"use strict";var c=b.Models.ComponentSource;b.Collections=b.Collections||{},b.Collections.ComponentSources=b.MVC.Collection.extend({model:c,initialize:function(a,c){return c=c||{},c.visId&&(this.setVisId(c.visId),delete c.visId),c.name&&(this.setVisName(c.name),delete c.name),b.MVC.Collection.prototype.initialize.apply(this,arguments),this},getComponentsNamespace:function(){return this.getVisName().replace(/[^\w]/g,"_")},load:function(a){var c=$.Deferred(),d=this.apiKey||b.Utilities.getURLParameter("key"),e="string"==typeof this.remote?this.remote+"/":"",f="string"==typeof this.remote&&"boolean"==typeof this.secure?this.secure?"https://":"http://":"";a=a||this.getComponentsNamespace(),requirejs.config({urlArgs:d?"key="+d:null,paths:{noext:f+e+"js/libs/require/noext"}});var g=[],h=[],i=[];a?this.forEach(function(a){var b=a.url();"text/javascript"===a.get("type")?(g.push("noext!"+b),h.push(a.getConstructorName())):i.push(a)}):(console.error("Namespace is not defined"),c.reject({message:"Namespace is not defined"}));var j=function(d){var e=0;console.log("Loading scripts:"),console.log(d),h.forEach(function(c){"function"==typeof b.Visualizations[a][c]?e++:null}),require.config({waitSeconds:100}),e==d.length?(console.log("Already Loaded: ",a),c.resolve()):require(d,function(){for(var d=0;d<arguments.length;d++){var e=arguments[d],f=h[d];b.Visualizations[a][f]=e}c.resolve()},function(a){c.reject(a)})},k=i.length,l=g.slice(0);if(k>0){var m=0;console.log("Loading resources:"),console.log(i),i.forEach(function(b){b.load(a).done(function(){m++,m==k&&j(l)}).fail(function(a){c.reject(a)})})}else j(l);return c.promise()},execute:function(){this.each(function(){})},url:function(){if(this.visId)return"service/visualizations/"+this.visId+"/source/";throw new Error("Visualization id for the component is not defined")},setVisName:function(a){this.name=a},getVisName:function(){return this.name},setVisId:function(a){this.visId=a}})}(window,Zoomdata),function(a,b){"use strict";b.Models=b.Models||{},b.Models.LibrarySource=b.Models.ComponentSource.extend({defaults:{},initialize:function(a){b.Models.ComponentSource.prototype.initialize.apply(this,arguments),"string"==typeof a&&this.set("name",a)},idAttribute:"id",url:function(){var a="string"==typeof this.remote?this.remote+"/":"",b="string"==typeof this.remote&&"boolean"==typeof this.secure?this.secure?"https://":"http://":"";return b+a+"service/visualizations/libs/"+this.id+"/"+(this.get("uploadDate")||"")},load:function(){var a=this,c=this.get("type"),d=$.Deferred(),e=this.url(),f=($("head"),this.apiKey||b.Utilities.getURLParameter("key"));switch(c){case"text/template":e+=f?"?unwrapped=true&key="+f:"?unwrapped=true",$.ajax({cache:!0,dataType:"text",url:e}).done(function(a){$("<script type='text/template'>"+a+"</script>").appendTo($("head")),d.resolve()}).fail(function(b,c,e){console.error("Failed to load: "+a.get("name")+" with exception: "+e),d.reject(b)});break;case"text/css":f&&(e+="?key="+f),$.ajax({cache:!0,dataType:"text",url:e}).done(function(a){$("<style>"+a+"</style>").appendTo($("head")),d.resolve()}).fail(function(b,c,e){console.error("Failed to load: "+a.get("name")+" with exception: "+e),d.reject(b)});break;default:$.ajax({cache:!0,dataType:"script",url:e+"/"}).done(function(){d.resolve()}).fail(function(b,c,e){console.error("Failed to load: "+a.get("name")+" with exception: "+e),d.reject(b)})}return d.promise()}})}(window,Zoomdata),function(a,b){"use strict";var c=b.Models.LibrarySource;b.Collections=b.Collections||{},b.Collections.LibrariesSources=b.Collections.ComponentSources.extend({model:c,load:function(){var a=$.Deferred(),c=b.Utilities.getURLParameter("key")||this.apiKey,d=[],e=!1,f=[];return this.forEach(function(a){var b=a.url();-1!==b.indexOf("d3.v3.min.js")&&(e=!0,d.push(b)),f.push(b)}),requirejs.config({urlArgs:c?"key="+c:null}),console.log("Loading libraries:"),console.log(f),e?requirejs(d,function(b){window.d3=b,requirejs(f,function(){a.resolve()},function(b){console.error(f," failed to load."),a.reject(b)})},function(b){console.error(d," failed to load."),a.reject(b)}):requirejs(f,function(){a.resolve()},function(b){console.error(b.details),a.reject(b)}),a.promise()},url:function(){return"service/visualizations/libs/"}})}(window,Zoomdata),function(a,b){"use strict";b.Components=b.Components||{},b.Components.MetricFormatter=function(a,b){b="NONE"===b?!1:b;var c=a,d=!1,e=b,f=function(a){return d||(d=new Date(1*a)),d};this.format=function(a){var b=null;switch(d=!1,c){case"MONEY":b=$.formatNumber(a,{format:"$#,##0.00",locale:"us"});break;case"TIME":b=new Date(a).toLocaleString();break;case"DATE":b=f(a).getDay();break;case"MINUTE":if(isNaN(1*a))return"";var g=f(a).getHours(),h=f(a).getMinutes(),i=g>12?g-12:g||12;b=(10>i?"0":"")+i+":"+(10>h?"0"+h:h)+(g>=12?" pm":" am");break;case"HOUR":if(isNaN(1*a))return"";var g=f(a).getHours(),i=g>12?g-12:g||12;b=(10>i?"0":"")+i+(g>=12?" pm":" am");break;case"DAY":if(isNaN(1*a))return"";var j="DAY"==e?f(a).getUTCDate():f(a).getDate(),k="DAY"==e?f(a).getUTCMonth()+1:f(a).getMonth()+1;b=(10>k?"0"+k:k)+" / "+(10>j?"0"+j:j);break;case"WEEK":if(isNaN(1*a))return"";var j="DAY"==e?f(a).getUTCDate():f(a).getDate(),k="DAY"==e?f(a).getUTCMonth()+1:f(a).getMonth()+1;b=(10>k?"0"+k:k)+" / "+(10>j?"0"+j:j);break;case"MONTH":if(isNaN(1*a))return"";var k="DAY"==e?f(a).getUTCMonth()+1:f(a).getMonth()+1,l="DAY"==e?f(a).getUTCFullYear():f(a).getFullYear();b=l+" / "+(10>k?"0"+k:k);break;case"YEAR":if(isNaN(1*a))return"";b="DAY"==e?f(a).getUTCFullYear():f(a).getFullYear();break;default:Math.abs(a)>=1e-4&&Math.abs(a)<=1?b=$.formatNumber(a,{format:"0.####",locale:"us"}):Math.abs(a)>1?b=$.formatNumber(a,{format:"#,##0.##",locale:"us"}):(null===a&&(a=0),b=a?a.toExponential(4).toString():a.toString())}return b}}}(window,Zoomdata),function(a,b){"use strict";function c(a,b){this.setAccessTo(a,b),this.setColorRangeType("gradient")}var d=b.Components.MetricFormatter;b.Components=b.Components||{},b.Components.MetricAccessor=c,c.prototype.setAccessTo=function(a,b){return this.metric=a,this.metric.colors=this.metric.colors||this.metric.savedColors,this.objectField=b,this._updateFormatter(),this},c.prototype._updateDomain=function(a,b){var c,d,e,f,g,h=this,i=b;if(this.objectFields)this.domainValue=this.objectFields.map(function(a){return a.get("label")});else{if(c=d3.extent(a,function(a){return h.raw(a)}),e=(c[1]-c[0])/i,"gradient"!==this.colorRangeType&&(i+=1),0===e)return void(this.domainValue=c.slice(0));if(this.domainValue=this.domainValue||[],4===this.domainValue.length&&"gradient"!==this.colorRangeType)f=this.domainValue[1],g=this.domainValue[2],f<c[0]&&(f=c[0]),g>c[1]&&(g=c[1]),f>g&&(f=g),this.domainValue[0]=c[0],this.domainValue[1]=f,this.domainValue[2]=g,this.domainValue[3]=c[1];else{d=c[0],this.domainValue=[];do this.domainValue.push(d),d+=e;while(this.domainValue.length<i);this.domainValue[this.domainValue.length-1]=c[1]}}},c.prototype._recountDomain=function(){this._formatter=new d(this.objectField.type)},c.prototype._updateFormatter=function(){this._formatter=new d(this.objectField.type)},c.prototype.isCount=function(){return"count"===this.metric.name},c.prototype.isNone=function(){return"none"==this.metric.name},c.prototype.raw=function(a){var b,c,d=this.isCount(),e=this.isNone();return e?0:(b=this.metric.name,c=d?null:this.metric.func,d&&a.hasOwnProperty("current")&&a.current.hasOwnProperty("count")?a.current.count:a.hasOwnProperty("current")&&a.current.hasOwnProperty("metrics")&&a.current.metrics.hasOwnProperty(b)&&a.current.metrics[b].hasOwnProperty(c)&&a.current.metrics?a.current.metrics[b][c]:null)},c.prototype.formatted=function(a,b){var c=isNaN(a)?this.raw(a):a,d=this.objectField.type;return"count"===d?c:this._formatter.format(c,b)},c.prototype.get=function(a){return this.objectField[a]},c.prototype._updateFormatter=function(){this._formatter=new d(this.objectField.type)},c.prototype.get=function(a){return this.objectField[a]},c.prototype.colorRange=function(){var a=this,b=[];return"none"===this.metric.name?_.each(this.metric.colors,function(){b.push(a.metric.colors[0])}):b=this.metric.colors,_.clone(b)},c.prototype.minimum=function(){return this.domainValue?this.domainValue[0]:0},c.prototype.maximum=function(){return this.domainValue?this.domainValue[this.domainValue.length-1]:0},c.prototype.domain=function(){return _.clone(this.domainValue)},c.prototype.setColorRangeType=function(a){this.colorRangeType=a},c.prototype.getColorKeyLabel=function(){return this.get("label")},c.prototype.isMetric=function(){return!0}}(window,Zoomdata),function(a,b){"use strict";b.Models=b.Models||{},b.TIME_WINDOW_SCALE={HOUR:"HOUR",ROLLING_HOUR:"ROLLING_HOUR",DAY:"DAY",WEEK:"WEEK",MONTH:"MONTH",QUARTER:"QUARTER",YEAR:"YEAR",CUSTOM:"CUSTOM",ALL:"ALL"},b.Models.TimeWindowScale=b.MVC.Model.extend({idAttribute:"value"})}(window,Zoomdata),function(a,b){"use strict";var c=b.Utilities,d=c.time.millisecondsIn,e=b.Collections.Metrics,f=(b.Components,b.Models.GroupBy,b.Collections.GroupBy);b.Models=b.Models||{},b.Models.Time=b.MVC.Model.extend({defaults:{paused:!1,speed:1,minSpeed:1,timeWindow:"ROLLING_HOUR",time:null,groupTime:null,tz:c.determineTimeZone(),min:0,max:(new Date).getTime(),speedValues:[1,10,60,3600,86400,864e3,5184e3],speedNames:["1x","10x","60x","1h/sec","1d/sec","10d/sec","60d/sec"],live:!1},startTimeFunctions:{},initialize:function(a){_.bindAll(this,"firstMinuteTime","firstHourTime","rollingTime","getStartTime","getEndTime"),this.set("LIVE"==a.time?{time:(new Date).getTime(),live:!0}:"number"!=typeof a.time?{time:c.getTimestamp(a.time),paused:!0}:{time:a.time,paused:!0}),this.on("change:timeWindow",this._updateLimits)},firstMinuteTime:function(a){var b=new Date(a);return b.setMinutes(0,0,0),b.getTime()},firstHourTime:function(a){var b=new Date(a);return b.setHours(0,0,0,0),b.getTime()},rollingTime:function(a){return a-d.hour},getStartTimeStamp:function(){return this.get("fromTime")},getEndTimeStamp:function(){var a=this.get("time");return a},getStartTime:function(a,b,d){var e=this.get("ALL"==this.get("timeWindow")?"min":"fromTime");return a?c.formattedDate(e,b)+" "+c.timeZoneFromTime(e):"DAY"===d?c.formattedDateOnly(e,b,!0):c.formattedDate(e,b)
},getEndTime:function(a,b,d){var e=this.get("time");return a?c.formattedDate(e,b)+" "+c.timeZoneFromTime(e):"DAY"===d?c.formattedDateOnly(e,b):c.formattedDate(e,b)},formattedCustomDate:function(a,b,d){return b=1*b,a?c.formattedDate(b,d)+" "+c.timeZoneFromTime(b):c.formattedDate(b,d)},getStartTimeForComparisonPeriod:function(a){var b=this.get("fromTime"),d=new Date(b);if("YESTERDAY"===a)d.setDate(d.getDate()-1);else if("WEEK_AGO"===a)d.setDate(d.getDate()-7);else{var e=a.split("-"),f=new Date(1*e[0],1*e[1]-1,1*e[2]);f.setHours(d.getHours()),f.setMinutes(d.getMinutes()),f.setSeconds(d.getSeconds()),d=f}return b=d&&d.getTime()||b,c.formattedDate(b,!0)+" "+c.timeZoneFromTime(b)},getEndTimeForComparisonPeriod:function(a){var b=this.get("time"),d=new Date(b);if("YESTERDAY"===a)d.setDate(d.getDate()-1);else if("WEEK_AGO"===a)d.setDate(d.getDate()-7);else{var e=a.split("-"),f=new Date(1*e[0],1*e[1]-1,1*e[2]);f.setHours(d.getHours()),f.setMinutes(d.getMinutes()),f.setSeconds(d.getSeconds()),d=f}return b=d&&d.getTime()||b,c.formattedDate(b,!0)+" "+c.timeZoneFromTime(b)},getStartTimeForTimeWindowScaleAndComparisonPeriod:function(a,b){var d=this.get("fromTime"),e=new Date(d);if("YESTERDAY"===b)e.setDate(e.getDate()-1);else if("WEEK_AGO"===b)e.setDate(e.getDate()-7);else{var f=b.split("-"),g=new Date(1*f[0],1*f[1]-1,1*f[2]);g.setHours(e.getHours()),g.setMinutes(e.getMinutes()),g.setSeconds(e.getSeconds()),e=g}return"HOUR"===a?(e.setMinutes(0),e.setSeconds(0)):"DAY"===a&&(e.setHours(0),e.setMinutes(0),e.setSeconds(0)),d=e&&e.getTime()||d,c.formattedDate(d,!0)+" "+c.timeZoneFromTime(d)},getEndTimeForTimeWindowScaleAndComparisonPeriod:function(a,b){var d=this.get("time"),e=new Date(d);if("YESTERDAY"===b)e.setDate(e.getDate()-1);else if("WEEK_AGO"===b)e.setDate(e.getDate()-7);else{var f=b.split("-"),g=new Date(1*f[0],1*f[1]-1,1*f[2]);g.setHours(e.getHours()),g.setMinutes(e.getMinutes()),g.setSeconds(e.getSeconds()),e=g}return"HOUR"===a?(e.setMinutes(59),e.setSeconds(59)):"DAY"===a&&(e.setDate(e.getDate()+1),e.setHours(0),e.setMinutes(59),e.setSeconds(59),e.setHours(-1)),d=e&&e.getTime()||d,c.formattedDate(d,!0)+" "+c.timeZoneFromTime(d)}}),b.Models.Datum=b.MVC.Model.extend({idAttribute:"group"});var g={"Descending Value":"valueDescending","Ascending Value":"valueAscending",Alphabetical:"alphabetical","Reverse Alphabetical":"reverseAlphabetical"},h={valueDescending:"Descending Value",valueAscending:"Ascending Value",alphabetical:"Alphabetical",reverseAlphabetical:"Reverse Alphabetical"},i=b.Models.Filter,j=b.Collections.Filters;b.Models.State=b.MVC.Model.extend({defaults:{groupBy:null,timeWindowScale:"ROLLING_HOUR",comparison:!1,comparisonPeriod:"YESTERDAY",sort:{dir:"DESC",name:"count"},limit:1e3,clientSort:"valueDescending"},initialize:function(a,c){c||(c={});var d,h,i=this,k=this.defaults,l={},m=(c.config,c.config&&c.config.get("source")),n=m.variables,o=m.filters||[],p=m.minSpeed?m.minSpeed:1,q=p>1?p:1,r=m.startFrom;switch(this.options=this.options||{},c.config&&(this.config=c.config,delete c.config),c.objectFields&&(this.options.fields=c.objectFields.toJSON(),delete c.objectFields),"BEGINNING"===r&&(d=this.options.fields.filter(function(a){return a.name===m.date})[0],d&&(r=d.min,"ROLLING_HOUR"===m.timeWindowScale&&(r+=36e5))),this.metrics=new e(this._retrieveMetrics()),p){case 86400:k.timeWindowScale="WEEK";break;case 3600:k.timeWindowScale="DAY";break;default:k.timeWindowScale="ROLLING_HOUR"}h=this.getGroupTime(),this.time=new b.Models.Time({time:r,speed:q,minSpeed:p,timeWindow:m.timeWindowScale,groupTime:h}),this.on("change:timeWindowScale",function(a,b){i.time.set("timeWindow",b)}),l.limit=n.Limit,l.sort=this.metrics.size()>0?"Bottom"==n["Limit Results by Rank"]?{name:this.metrics.at(0).get("name")||"count",dir:"asc"}:{name:this.metrics.at(0).get("name")||"count",dir:"desc"}:{name:"count",dir:"desc"},this.queryBuilderSource=m.variables.queryBuilderSource,this.filters=new j(o),this.groupBy=new f(this._retrieveGroupBy(),this._retrieveGroupByDefinition()),l.timeTrendStep=h?h.timeScale:m.timeTrendStep,l.timeWindowScale=m.timeWindowScale||k.timeWindowScale,l.comparison="On"===n.Comparison,l.comparisonPeriod=n._comparisonPeriod||m.comparisonPeriod||this._getDefaultComparison(),l.sort=l.sort||k.sort,l.clientSort=g[n.Sort]||k.clientSort,l.delay=m.delay,l.delayUnit=m.delayUnit,l.timestampField=m.date,this.set(l)},_getDefaultComparison:function(){var a="YESTERDAY";if(!this.time.get("live")){var b=new Date(this.time.get("time")),c=b.getFullYear().toString(),d=(b.getMonth()+1).toString(),e=b.getDate().toString();a=c+"-"+(d[1]?d:"0"+d[0])+"-"+(e[1]?e:"0"+e[0])}return a},_setupTrend:function(a){var c=this.config.get("source").variables._limitPeriod,d=this.config.get("source").startFrom?new Date(this.config.get("source").startFrom):null,e=c?!0:!1,f=_.findWhere(this.options.fields,{name:this.groupBy.getAttribute()}),g=f.timestampGranularity,h="DAY"===g,i=new Date(f.min),j=new Date(f.max),k=60,l=a.timeTrendStep||null,m=b.Utilities.time.getMaxStepLimit();if(null!==l)return void this.groupBy.setLimit(e?c:k,{silent:!0});this.unset("timeWindowScale"),g="NONE"===g||"SECOND"===g?!1:g;var n=b.Utilities.time.getRoundedDateRange(i,j,!1,0,h);l="YEAR"===n.step&&n.amount<=2?"MONTH":n.step||l;var o=b.Utilities.time.getRoundedDateRange(i,j,g||l,0,h);if(o.amount<5&&!l&&(o.step=b.Utilities.time.getLowerStep(o.step),o=b.Utilities.time.getRoundedDateRange(i,j,o.step,1,h)),o.amount=o.amount>m?m:o.amount,k=o.amount,g&&l!==g){var p=b.Utilities.time.getMaxStep(l,g,h);p===l&&(k=b.Utilities.time.getRoundedDateRange(i,j,l,1,h).amount,"MONTH"===l&&k++)}if(i.getTime()-j.getTime()===0){var q=b.Utilities.time.millisecondsIn[l.toLowerCase()],r=i.getTime()+q;k=1,j.setTime(r)}else{var s=j.getTime();s%1e5===99999&&"DAY"===l?s+=1:s=s%1e3===0?s+1:s,j.setTime(s)}this.time.set({time:e&&d&&d.getTime()||j.getTime()},{silent:!0}),a.timeTrendStep=l,this.groupBy.setLimit(e?c:k,{silent:!0}),this.customStep=l},_retrieveGroupByDefinition:function(){var a=this._retrieveGroup(),b=this._retrieveGroups();return{definition:b||a}},getGroupTime:function(){var a,b=this.config.get("variables").filter(function(a){return"group"===a.type&&"time"===a.groupType})[0]||null,c=this.config.get("source").variables;return b&&(a=c[b.name],a?b=$.extend(b,JSON.parse(a)):b.name=this.config.get("source").date,b.sort=b.sort||{},b.timeScale=this.config.get("source").timeTrendStep||b.timeScale),b},_retrieveGroupBy:function(){var a=this,b=this.config,c=[],d="",e=b&&b.get("source"),f=e.variables,g=this.time.get("groupTime"),h=a._retrieveGroup(),i=a._retrieveGroups();if(i)if(f&&f[i.name])c=JSON.parse(f[i.name]);else if(d=i.defaultValue,d&&""!==d)c=[JSON.parse(i.defaultValue)];else{var j=JSON.parse(i.config).groupLevel||2;c=a._getDefaultGroups(j)}else h&&(f&&f[h.name]?c=[JSON.parse(f[h.name])]:(d=h.defaultValue,c=d&&""!==d?[JSON.parse(h.defaultValue)]:a._getDefaultGroup()));return g&&(c=[{name:g.name||e.date,limit:g.limit||10,sort:{name:"date",dir:g.sort.dir||"Ascending Value"}}]),("ZOOMABLE_MAP"===b.get("type")||"ZOOMABLE_MAP"===b.get("templateType"))&&(c=[{name:f.State,limit:1e4,sort:{name:"count",dir:"Descending Value"}}]),c},_getDefaultGroup:function(){var a,b,c="ATTRIBUTE",d={name:"",limit:10,groupType:"attribute",sort:{name:"count",dir:"Descending Value"}};return a=this.options.fields,b=_.findWhere(a,{type:c}),d.name=b?b.name:"none",d},_getDefaultGroups:function(a){var b,c="ATTRIBUTE",d=[];b=this.options.fields;for(var e=0;e<b.length;e++){var f=b[e];if(f.type===c){var g={name:f.name,limit:10,sort:{name:"count",dir:"Descending Value"}};if(d.push(g),d.length>=a)break}}return d},_retrieveGroup:function(){var a=this.config.get("variables"),b=_.findWhere(a,{type:"group"});return b||(b=!1),b},_retrieveGroups:function(){var a=this.config.get("variables"),b=_.findWhere(a,{type:"multi-group"});return b||(b=!1),b},_retrieveMetrics:function(){function a(a){var b=a.name,c=e[b]||"none",g=c.split(":"),h=g[0],i=d.filter(function(a){return a.name===h})[0],j=g[1]||i.func||("count"!==h&&"none"!=h?"sum":null),k={};g[2]&&(k=JSON.parse(g[2].replace(/\|/g,":")),$.extend(a,k)),f.push($.extend(k,{label:b,name:h,func:j,id:b}))}function b(b){var c=b.name,g=e[c].split(" ");"color"===b.metricType?a(b):g.forEach(function(a){var b=a.split(":")[0],e=d.filter(function(a){return a.name===b})[0],g=a.split(":")[1]||e.func;f.push({label:c,name:b,func:g,id:c+"-"+f.length})})}var c=this.config.get("variables"),d=this.options.fields||[],e=this.config.get("source").variables,f=[];return c.forEach(function(c){"metric"==c.type?a(c):"multi-metric"==c.type?b(c):null}),f},addFilter:function(a,b){var c,d,e,f,g=this.filters;if(b=b||{},Array.isArray(a))return this.filters.add(a,_.extend({merge:!0},b)),this;if(a instanceof i?null:a=new i(a),d=a.get("path"),f=a.get("operation"),e=a.get("value"),c=g.findWhere({path:d})){var h=!1;b.silent=!0,"number"==typeof e||"number"==typeof c.get("value")||"number"==typeof e[0]?(c.set("value",e,b),h=!0):(_.each(e,function(a){c.hasAttribute(a,b)||(h=!0,c.addAttribute(a,b))}),_.each(c.get("value"),function(d){a.hasAttribute(d,b)||c.removeAttribute(d,b)})),c.get("operation")!==f&&(h=!0,c.set("operation",f,b)),h&&b.trigger!==!1&&c.trigger("change")}else this.filters.add(a,b);return this},addFilters:function(a){var b=this;a=_.sortBy(a,function(a){return b.filters.findWhere({path:a.path})}),a.forEach(function(c,d){b.addFilter(c,{silent:d!==a.length-1})})},removeFilter:function(a,b){function c(a){var c,e,f,g=d.filters;return a instanceof i?null:a=new i(a),e=a.get("path"),f=a.get("value"),c=g.findWhere({path:e}),c&&1===f.length&&c.hasAttribute(f[0],b)?(c.removeAttribute(f[0],b),d):"undefined"==typeof f[0]||f.length>1?(d.filters.remove(c),d):void 0}var d=this;if($.isArray(a))for(var e=0;e<a.length;e++)c(a[e]);else c(a);return this},setFilter:function(a,b){var c,d,e=this.filters;a instanceof i?null:a=new i(a),d=a.get("path"),c=e.findWhere({path:d}),c?c.set(a.attributes,b):this.addFilter(a,b)},toRequest:function(){var a=this.time.get("live"),c=this.config.get("source"),d=this.queryBuilderSource||c.variables.queryBuilderSource,e=c.variables._limitPeriod;e&&(c.variables._TempLimitPeriod=e,delete c.variables._limitPeriod);var f=$.extend({},this.attributes),g=this.get("timestampField"),h=(this.get("timeWindowScale"),{});delete f.clientSort,f.time=!g||a?null:this.time.get("time"),console.log("time: "+(f.time?b.Utilities.convertTimeToStringUTC(new Date(f.time),!1):null)),f.tz=86400==this.time.get("minSpeed")||"DAY"===c.dataResolution?"GMT":this.time.get("tz"),f.speed=this.time.get("speed"),h.pauseAfterRead=this.time.get("paused");var i="count",j="desc";this.get("sort")&&(delete f.sort,h=h||{},this.metrics.size()>0&&(i=this.metrics.at(0).get("name")),j=this.get("sort").dir,h.sort={name:i,dir:j}),this.groupBy&&(delete f.groupBy,h=h||{},h.group={},h.group.limit=1,h.group.fields=this.groupBy.toJSON(),h.group.fields.forEach(function(a){h.group.limit=h.group.limit*+a.limit;var b=_.clone(a.sort);b.name="count"===b.name?i:b.name,a.sort=b}),1===h.group.fields.length&&h.group.limit&&delete h.group.limit,h.group.metrics=h.group.metrics||[],this.metrics.each(function(a){a.isCount()||a.isNone()||h.group.metrics.push({name:a.get("name"),func:a.get("func").toUpperCase()})}),this.get("timeTrendStep")&&(delete f.timeTrendStep,h.group.timeTrendStep=this.get("timeTrendStep"))),this.filters.length>0&&(delete h.filters,h=h||{},h.filters=this.filters.toRequest()),this.get("sort")&&(delete f.sort,delete h.sort),d&&(h=h||{},h.queryBuilderSource=d);var k=this.get("comparisonPeriod");return f.comparisonPeriod=this.dataToFormatString(this.getTimeByType(f.time,k)),h&&(f.cfg=h),f.volume?delete f.volume:null,f.color?delete f.color:null,f.timestampField=g,f},getTimeByType:function(a,b){var c=b,d=a&&a<=new Date?new Date(a):new Date,e=new Date(d);e.setDate(d.getDate()-1);var f=new Date(d);f.setDate(d.getDate()-7);var g=new Date(d);g.setDate(d.getDate()-30);var h=new Date(d);h.setDate(d.getDate()-365);var i=new Date(d);switch(i.setDate(d.getDate()-365),b){case"YESTERDAY":c=e;break;case"WEEK_AGO":c=f;break;case"LAST_MONTH":c=g;break;case"MONTH_YEAR_AGO":c=h;break;case"LAST_YEAR":c=i}return c},dataToFormatString:function(a){var b="";return b=a.getFullYear?a.getFullYear()+"-"+(a.getMonth()+1<10?"0":"")+(a.getMonth()+1)+"-"+(a.getDate()<10?"0":"")+a.getDate():a},isSingleGroupBy:function(){var a=!0,b=this.groupBy;return b.length>1&&(a=!1),a},convertToBookmark:function(){var a=this,b=this.config.get("source"),c=this.metrics.pluck("label"),d=$.extend({},b,{filters:this.filters.toJSON(),timeWindowScale:this.get("timeWindowScale"),timeTrendStep:this.get("timeTrendStep"),startFrom:this.time.getEndTime(),sourceId:b.sourceId,sourceName:b.sourceName});if(d.variables=d.variables||{},d.variables.Sort=h[this.attributes.clientSort],d.variables.Comparison=this.get("comparison")?"On":"Off",d.variables._comparisonPeriod=this.get("comparisonPeriod"),this.isSingleGroupBy()){var e="",f=null,g=_.findWhere(a.config.get("variables"),{type:"group"});g&&(e=g.name,f=this.groupBy.at(0),d.variables[e]=JSON.stringify(f.toJSON(!0)))}else{var e="",f=null,g=_.findWhere(a.config.get("variables"),{type:"multi-group"});g&&(e=g.name,f=this.groupBy,d.variables[e]=JSON.stringify(f.toJSON(!0)))}return c.forEach(function(a){d.variables[a]=""}),this.metrics.map(function(b){var c,e,f=b.get("label"),g=b.get("name"),h=b.get("func");d.variables.hasOwnProperty(f)?d.variables[f]+=(d.variables[f].length>0?" ":"")+("count"==g?g:g+":"+h):null,a.colorDataObj&&a.colorDataObj.id===b.id&&(1===d.variables[f].split(":").length&&(d.variables[f]+=":"),c=a.colorDataObj.get("colors")||a.colorDataObj.get("savedColors"),"string"!=typeof c&&(c=JSON.stringify(c)),"distinct"===a.divergingColorRange&&(e=a.colorMetricDomain),d.variables[f]+=":"+JSON.stringify({colorNumb:a.colorNumb,legendType:a.legendType,divergingColorRange:a.divergingColorRange,autoShowColorLegend:a.colorDataObj.get("autoShowColorLegend"),savedColors:c,domain:e}).replace(/:/g,"|"))}),d},isTimeTrends:function(){return"TRENDS"===this.config.get("type")||"MULTI_METRIC_TREND"===this.config.get("type")||"TRENDS"===this.config.get("templateType")||"MULTI_METRIC_TREND"===this.config.get("templateType")}})}(window,Zoomdata),function(a,b){"use strict";b.Utilities;b.Collections=b.Collections||{},b.Collections.Graph=Backbone.Collection.extend({model:b.Models.Datum,metric:null,initialize:function(a,b){_.bindAll(this,"setSortOrder"),this.metric=b.metric},setSortOrder:function(a){this.comparator="valueAscending"===a?function(a){return this.metric.raw(a.attributes)}:"valueDescending"===a?function(a){return-this.metric.raw(a.attributes)}:"alphabetical"===a?function(a){return a.get("group")}:"reverseAlphabetical"===a?function(a,b){return a.get("group")>b.get("group")?-1:a.get("group")<b.get("group")?1:0}:"date"===a?function(a){return 1*a.get("group")}:null,this.comparator&&this.sort()}})}(window,Zoomdata),function(a,b){"use strict";var c={},d=b.Utilities;c.Slider=b.MVC.View.extend({defaults:{orientation:"vertical",range:!1,value:50,min:0,max:100},initialize:function(a){var c=this,d={start:function(a,b){c.trigger("slide:start",b.value,c),c.data.set("value",b.value,{silent:!0})},stop:function(a,b){c.trigger("slide:stop",b.value,c),c.data.set("value",b.value,{silent:!0})},change:function(a,b){c.trigger("slide:change",b.value,c),c.data.set("value",b.value,{silent:!0})}};this.options=$.extend({},this.defaults,a),this.data=new b.MVC.Model({min:this.options.min,max:this.options.max,value:this.options.value}),this.$el.slider($.extend({},d,this.options)),this.listenTo(this.data,"change",this.render)},render:function(){return this.$el.slider(this.data.attributes),this},value:function(a){function b(){return d.data.get("value")}function c(a){d.data.set("value",a)}var d=this;return"number"==typeof a?(c(a),this):b()},min:function(a){function b(){return d.data.get("min")}function c(a){d.data.set("min",a)}var d=this;return"number"==typeof a?(c(a),this):b()},max:function(a){function b(){return d.data.get("max")}function c(a){d.data.set("max",a)}var d=this;return"number"==typeof a?(c(a),this):b()}});var e=_.template('            <button class="arrow-left btn" title="left" value="left"><i class="icon-arrow-left"></i></button>            <button class="arrow-right btn" title="right" value="right"><i class="icon-arrow-right"></i></button>        '),f=_.template('            <div class="btn-group-vertical">                <button class="arrow-up btn" title="up" value="up"><i class="icon-arrow-up"></i></button>                <button class="arrow-down btn" title="down" value="down"><i class="icon-arrow-down"></i></button>            </div>        '),g=_.template('            <button class="arrow-left btn" title="left" value="left"><i class="icon-arrow-left"></i></button>            <div class="btn-group-vertical">                <button class="arrow-up btn" title="up" value="up"><i class="icon-arrow-up"></i></button>                <button class="arrow-down btn" title="down" value="down"><i class="icon-arrow-down"></i></button>            </div>            <button class="arrow-right btn" title="right" value="right"><i class="icon-arrow-right"></i></button>        ');c.Arrows=b.MVC.View.extend({_horizontalTemplate:e,_verticalTemplate:f,_allTemplate:g,defaults:{direction:"all"},events:{'click button[value="up"]':"_onUpClick",'click button[value="down"]':"_onDownClick",'click button[value="left"]':"_onLeftClick",'click button[value="right"]':"_onRightClick"},initialize:function(a){switch(this.childViews=[],this.options=$.extend({},this.defaults,a),this.options.direction){case"vertical":this.template=this._verticalTemplate;break;case"horizontal":this.template=this._horizontalTemplate;break;case"all":default:this.template=this._allTemplate}},render:function(){return this.$el.html(this.template()),this},_onUpClick:function(){this.trigger("translate:up")},_onDownClick:function(){this.trigger("translate:down")},_onLeftClick:function(){this.trigger("translate:left")},_onRightClick:function(){this.trigger("translate:right")}}),c.Zoomable=b.MVC.View.extend({className:"zoomable",defaults:{snapToEdges:!0,maxScale:!1,minScale:!1,eventNamespace:"zoomable:",mouseWheel:!1},initialize:function(a){var c=this;this._enabled=!0,this.childViews=[],this.options=$.extend({},this.defaults,a),this.$content=$('<div class="zoomable-content"></div>').appendTo(this.$el),b.Utilities.MODE.NATIVE!==b.Utilities.mode()&&(this._zoomHammer=this.$content.zoomHammer(this.options).data("zoomHammer"),this.$el.on("zoomable:transformstart",function(){c.trigger("transform:start",c)}),this.$el.on("zoomable:transformend",function(){c.trigger("transform:end",c)}),this.$el.on("zoomable:transform",function(){c.trigger("transform:transition",c)}))},disable:function(a){var b=a?a.resizeStart:null;this._zoomHammer&&this._zoomHammer.disable(),this.$el.hasClass("zoomable-disabled")||b?null:this.$el.addClass("zoomable-disabled"),this._enabled=!1},enable:function(a){var b=a?a.resizeStop:null;this._zoomHammer&&this._zoomHammer.enable(),this.$el.hasClass("zoomable-disabled")&&!b?this.$el.removeClass("zoomable-disabled"):null,this._enabled=!0},isEnabled:function(){return this._enabled},getMinScale:function(){return this._zoomHammer&&this._zoomHammer.parsedScale().min||1},setMinScale:function(a){return a||(a=this._zoomHammer.options.minScale),this._zoomHammer.options.minScale=a,this},getMaxScale:function(){return this._zoomHammer&&this._zoomHammer.parsedScale().max||1},setMaxScale:function(a){return a||(a=this._zoomHammer.options.maxScale),this._zoomHammer.options.maxScale=a,this},getScale:function(){return this._zoomHammer&&this._zoomHammer.scale()||1},getTranslation:function(){return this._zoomHammer&&this._zoomHammer.translate()||null},zoom:function(a,b,c){return this._zoomHammer&&this._zoomHammer.move({scale:a},b,c),this},translate:function(a,b){return a=a||{},"number"==typeof a.x?a.left=a.x:null,"number"==typeof a.y?a.top=a.y:null,delete a.x,delete a.y,this._zoomHammer&&this._zoomHammer.move(a,b),this},refresh:function(a,b){this._zoomHammer&&this._zoomHammer.adjust(a,b)},render:function(a){return this.$content.html(a),this}});var h=_.template('        <div class="modal hide fade <%= customClass %>" >            <div class="modal-header">                <button title="Close" value="dialog-reject" class="close">&times;</button>                <h3 class="dialog-head pull-left"></h3>                <div class="clearfix"></div>            </div>            <div class="modal-body dialog-body">            </div>            <div class="modal-footer dialog-controls">                <button title="<%= rejectButtonTitle %>" value="dialog-reject" class="btn btnNo" aria-hidden="true"><%= rejectButtonLabel %></button>                <button title="<%= acceptButtonTitle %>" value="dialog-accept" class="btn btn-primary btnYes"><%= acceptButtonLabel %></button>            </div>        </div>    ');c.Dialog=b.MVC.View.extend({template:h,defaults:{mode:"dialog",draggable:!1,wide:!1,modal:"static",rejectButtonLabel:"Close",acceptButtonLabel:"Accept",rejectButtonTitle:"Close",acceptButtonTitle:"Accept",containment:"body",docked:!0,customClass:""},events:{'click button[value="dialog-reject"]':"hide",'click button[value="dialog-accept"]':"accept",'click button[value="dialog-back"]':"back"},initialize:function(a){b.MVC.View.prototype.initialize.apply(this,arguments),_.bindAll(this,"back");var c=this;switch(a=a||{},a.actions&&(this.actions=a.actions,delete a.actions),a.template&&(this.template=a.template,delete a.template),this.settings=$.extend({},this.defaults,a),this.removeOtherDocked(),$(".modal-backdrop.zd-overlay").remove(),this.setElement(this.template({rejectButtonLabel:this.settings.rejectButtonLabel,acceptButtonLabel:this.settings.acceptButtonLabel,rejectButtonTitle:this.settings.rejectButtonTitle,acceptButtonTitle:this.settings.acceptButtonTitle,customClass:this.settings.customClass})),this.$el.appendTo("body"),this.$el.modal({show:!1,backdrop:this.settings.modal,keyboard:!1}),this.settings.mode){case"palette":this.$(".dialog-controls").hide();break;case"alert":this.$('button[value="dialog-accept"]').hide()}this.$head=this.$(".dialog-head"),this.$body=this.$(".dialog-body"),this.$actions=$('<div class="zd-dialog-actions btn-group btn-block"></div>'),this.setActions(a.actions),this.settings.draggable&&this.$el.draggable({handle:this.$(".dialog-head, .header"),start:function(){c.$el.removeClass("fade"),"function"==typeof c.settings.draggable.onDragStart&&c.settings.draggable.onDragStart.apply(this,arguments)},stop:function(){c.$el.addClass("fade"),"function"==typeof c.settings.draggable.onDragStop&&c.settings.draggable.onDragStop.apply(this,arguments)},cursor:"move",containment:this.settings.containment}),this.settings.wide&&this.goWide(),this.$el.one("hidden",function(){c.trigger("dialog:rejected"),c.remove(),c.onReject(),c.onHide()}),this.listenTo(b.eventDispatcher,"visualization:add",function(){this.hide()}),this.listenTo(b.eventDispatcher,"admin-control:clicked",this.removeOtherDocked)},removeOtherDocked:function(){var a=$(".modal.zd-palette.docked"),b=$(".modal.zd-infopopup.docked");$(".control-rounded").removeClass("active"),$(".control-button").removeClass("active"),$(".header-control").removeClass("active"),a.remove(),b.remove()},setActions:function(a){var b=this;return a?this.actions=a:a=this.actions,this.$actions.empty(),_.each(this.actions,function(a){var c=$(j({type:a.type,label:a.label,title:a.title||a.label}));b.$actions.append(c),c.on("click",a.callback),c.css({width:100/b.actions.length+"%"})}),this},clearActions:function(){return this.actions=null,this.$actions.empty(),this},render:function(a,c){return this.$el.attr("data-name",c),this.$body.empty(),this.$head.empty(),this.$body.append(a),void 0!==c?(this.$head.append(c),this.$head.show()):this.$head.hide(),this.$el.modal("show"),this._onFullScreenMode()&&(this.zIndex=this.zIndex||this.$el.zIndex(),this.$el.zIndex(this.zIndex+10),this.listenToOnce(b.eventDispatcher,"widget:fullOff",this.hide)),this.$el.find('button[value="dialog-back"]').on("click",this.back),this.actions&&0==this.$(this.$actions).length?this.$body.after(this.$actions):null,this.delegateEvents(),b.eventDispatcher.trigger("dialog:show"),this},goWide:function(){return this.$el.hasClass("wide")?null:this.$el.addClass("wide"),this.resetSizes(),this},goNormal:function(){return this.$el.hasClass("wide")?this.$el.removeClass("wide"):null,this.resetSizes(),this},resetSizes:function(){return this.$el.css({width:"",height:""}),this.$body.css({width:"",height:""}),this.adjustBodySizes(),this},adjustBodySizes:function(){var a=this.$el,b=$(this.settings.containment),c=b.offset(),d=this.$el.offset(),e=d,f={};d.left+=44,d.top+=44,e.left=d.left-c.left,e.top=d.top-c.top,e.right=b.width()-e.left-a.width(),e.bottom=b.height()-e.top-a.height(),e.left<0?(f.maxWidth+=e.left,f.marginLeft=parseInt(this.$el.css("margin-left"))-e.left):null,e.right<0?(f.maxWidth+=e.right,f.marginRight=parseInt(this.$el.css("margin-right"))-e.right):null,f.maxHeight=b.height()-e.top-d,this.$el.css(f),this.$body.css({maxHeight:f.maxHeight})},position:function(a){var b=this.$el.data().modal;return a=a||{},b&&b.$element.css({left:a.left||"auto",top:a.top||"auto",right:a.right||"auto",bottom:a.bottom||"auto"}),(a.of||a.my||a.at||a.collision)&&(this.$el.position({of:a.of,my:a.my,at:a.at,collision:a.collision,within:$(this.settings.containment),using:a.using}),this.adjustBodySizes()),this},positionInToolbar:function(a){this.position({of:a,my:"right+40px bottom-20px",at:"center top",collision:"flip flip"});var b=this.$el,c=($(this.settings.containment),a.getBoundingClientRect()),d=document.body.offsetWidth,e=(document.body.offsetHeight,d-(c.width+c.left)),f=c.left,g={left:0,top:c.top,width:0,height:0},h=(parseInt(b.css("maxWidth"),10),{left:10,top:-35});g.width=f>e?f-120:e-40,g.left=c.width+c.left-40,b.css({margin:0,left:g.left+"px",top:g.top+50+"px",width:g.width+"px"}),this.$pointer.css({left:h.left+"px","-webkit-transform":"scale(1, -1)","-moz-transform":"scale(1, -1)","-ms-transform":"scale(1, -1)"})},onBeforeHide:$.noop,hide:function(){if(this.onBeforeHide()!==!1){var a=this;this.$el.hasClass("rail-control")?this.$el.animate({left:-1*this.$el.width()},300,function(){a.$el.modal("hide")}):this.$el.fadeOut(200,function(){a.$el.modal("hide")})}},onReject:$.noop,onBeforeAccept:$.noop,accept:function(){var a=this;this.onBeforeAccept()!==!1&&(this.$el.off("hidden"),this.$el.one("hidden",function(){a.trigger("dialog:accepted"),a.remove(),a.onAccept(),a.onHide()}),this.$el.modal("hide"))},back:function(){this.onBack()},_onFullScreenMode:function(){return $(".fullScreenView").is(":visible")},onAccept:$.noop,onHide:$.noop,onBack:$.noop});var i=_.template('        <div class="modal hide zd-palette <%= customClass %>">            <div class="modal-header zd-palette-titlebar">                <button title="Close" value="dialog-reject" class="zd icon close" />                 <button title="" value="dialog-back" class="zd icon back" style="display:none;" />                 <div class="zd icon header"/>                 <h3 class="dialog-head zd-palette-header"></h3>                <div class="clearfix"></div>            </div>            <div class="modal-body dialog-body zd-palette-body">            </div>            <div class="zd-palette-background">            </div>            <div class="zd-palette-background small">            </div>        </div>    '),j=_.template('            <button title="<%=title%>" class="zd btn btn-<%=type%>"><%=label%></button>        ');c.Palette=c.Dialog.extend({template:i,events:{"mousedown .modal-header":"moveToFront",'click button[value="dialog-reject"]':"hide","click .zd-palette-background":"hideDocked","keypress input":"keyEnterPressed"},defaults:{template:h,mode:"palette",draggable:!0,docked:!1,modal:!0,containment:"body",minWidth:250,minHeight:100,defaultWidth:264},keyEnterPressed:function(a){b.Views.SearchBox.prototype.keyEnterPressed.apply(a,arguments)},initialize:function(a){b.MVC.View.prototype.initialize.apply(this,arguments);var d=this;a=a||{},_.bindAll(this,"showBackButton","hideBackButton"),c.Dialog.prototype.initialize.apply(this,arguments),this.$body.css({maxHeight:"none"}),$(this.settings.containment).length&&this.$body.css({height:$(this.settings.containment).height()-this.$el.offset().top-79}),this.$el.on("dragstop",function(){d.adjustBodySizes()}),this.options.draggable&&this.setDragEvents()},render:function(){return c.Dialog.prototype.render.apply(this,arguments),this.$el.resizable({containment:".zd-main",alsoResize:this.$body,minWidth:this.settings.minWidth,minHeight:this.settings.minHeight}).data().modal.$backdrop.addClass("zd-overlay"),this.isDocked()?null:this.undock(),this.actions?this.$body.append(this.$actions):null,this},setDragEvents:function(){var a=this,c={left:b.main.$section.find(".leftPane").width()+2,top:b.main.$header.height()};this.palettePosition=c,this.settings.draggable={onDragStart:function(){a.$el.removeClass("docked"),a.$el.addClass("undocked"),a.settings.docked=!1,a.$("div.zd-palette-background").remove()}}},isDocked:function(){return this.settings.docked},undock:function(){return this.$el.removeClass("docked"),this.$el.hasClass("undocked")?null:this.$el.addClass("undocked"),this.$("div.zd-palette-background").hide(),this.settings.docked=!1,this},dock:function(a){function b(){var a=!c.$("div.zd-palette-background").length>0;a&&(c.$el.css({width:c.settings.defaultWidth,height:$(c.settings.containment).height()}),c.$body.css({width:c.settings.defaultWidth-24,height:$(c.settings.containment).height()-c.$head.parent().height()-24}))}var c=this;return this.position(a),this.$el.removeClass("undocked"),this.$el.hasClass("docked")?null:this.$el.addClass("docked"),this.$("div.zd-palette-background").show(),this.settings.docked=!0,b(),this},hide:function(){this.$el.removeClass("active"),this.$el.removeClass("fade"),c.Dialog.prototype.hide.apply(this,arguments)},hideDocked:function(){this.settings.docked&&this.hide()},moveToFront:function(){this._onFullScreenMode()?($(".zd-palette").zIndex($(".leftPane").zIndex()-2),this.$el.zIndex($(".leftPane").zIndex()-1)):($(".zd-palette").zIndex(1018),this.$el.zIndex(1019))},showBackButton:function(){this.$('button[value="dialog-back"]').show()},hideBackButton:function(){this.$('button[value="dialog-back"]').hide()},remove:function(){this.clearActions(),b.Controls.Dialog.prototype.remove.apply(this,arguments)}});var k=_.template('        <div class="modal hide zd-infopopup <%= customClass %>" >            <div class="modal-header zd-infopopup-titlebar">                <button title="Close" value="dialog-reject" class="zd icon close" />                <button title="" value="dialog-back" class="zd icon back" style="display:none;" />                  <h3 class="dialog-head zd-infopopup-header"></h3>                <div class="clearfix"></div>            </div>            <div class="modal-body dialog-body zd-infopopup-body">            </div>            <div class="zd-infopopup-background">            </div>            <div class="zd-infopopup-background small">            </div>        </div>    ');c.InfoPopup=c.Dialog.extend({template:k,events:{"click .zd-infopopup-background":"hide","keypress input":"keyEnterPressed"},defaults:{autohide:!0,mode:"palette",draggable:!1,resizable:!1,modal:!1,containment:"body"},keyEnterPressed:function(a){c.Palette.prototype.keyEnterPressed.apply(a,arguments)},initialize:function(a){function d(){e._lastPostiton?e.position():null}var e=this;this.options=$.extend({},this.options,a),this._lastPostiton=null,this._repostionCallback=_.debounce(d,300),$.extend(this.events,c.Dialog.prototype.events),c.Dialog.prototype.initialize.apply(this,arguments),this.$pointer=$('<div class="zd-infopopup-pointer"><div class="zd-infopopup-pointer-arrow"></div> </div>'),$("body").one("dragstart",function(){e.hide()}),this.$el.on("dragstart",!1),$(window).on("resize",this._repostionCallback),(1==this.options.autohide||"string"==typeof this.options.autohide&&-1!==this.options.autohide.search("onStop"))&&this.listenTo(b.eventDispatcher,"visualization:stop",this.hide)
},render:function(){return c.Dialog.prototype.render.apply(this,arguments),this.$(".zd-infopopup-background").show(),this.$el.addClass("docked"),this.$el.on("mousewheel","textarea",function(a,b,c,d){a.preventDefault();var e=$(this).scrollTop();$(this).scrollTop(e+d)}),this},position:function(a){function b(a,b){d.$el.css(a),d._showPointer(b)}var d=this;return a=a||this._lastPostiton||{},this._lastPostiton=a,a.using=a.using||b,c.Dialog.prototype.position.call(this,a)},_showPointer:function(a){var b=this.options.pointerWidth?this.options.pointerWidth:14,c=a.element,d=a.target,e={},f="behind",g=b+"px solid transparent",h=b+"px solid rgba(50, 50, 50, 0.9)",i=parseInt(this.$el.css("border-radius"));if(d.center={left:d.left+d.width/2,top:d.top+d.height/2},c.center={left:c.left+c.width/2,top:c.top+c.height/2},e.vertical=d.center.top-c.center.top,e.vertical=e.vertical<0?e.vertical+"px":"+"+e.vertical+"px",e.horizontal=d.center.left-c.center.left,e.horizontal=e.horizontal<0?e.horizontal+"px":"+"+e.horizontal+"px",c.left+c.width<=d.center.left&&(f+=" right"),c.left>=d.center.left&&(f+=" left"),c.top+c.height<=d.center.top&&(f+=" bottom"),c.top>=d.center.top&&(f+=" top"),f=f.split(" ").splice(1),1==f.length){switch(this.$pointer.appendTo(this.$el),f[0]){case"left":this.$pointer.css({"border-top":g,"border-bottom":g,"border-right":h}).position({my:"right center",at:"left center"+e.vertical,of:this.el}),0===d.width&&a.element.element.css({left:"+=20"});break;case"right":this.$pointer.css({"border-top":g,"border-bottom":g,"border-left":h}).position({my:"left center",at:"right center"+e.vertical,of:this.el}),0===d.width&&a.element.element.css({left:"-=20"});break;case"top":this.$pointer.css({"border-top":h,"border-right":g,"border-left":g}).position({my:"center bottom",at:"center"+e.horizontal+" top",of:this.el});break;case"bottom":this.$pointer.css({"border-right":g,"border-top":h,"border-left":g}).position({my:"center top",at:"center"+e.horizontal+" bottom",of:this.el})}var j={};switch(j.top=parseInt(this.$pointer.css("top")),j.left=parseInt(this.$pointer.css("left")),j.offset=this.$pointer.offset(),f[0]){case"left":break;case"right":c.top+i>j.offset.top&&this.$pointer.css("top",j.top+i);break;case"top":break;case"bottom":c.left+i>j.offset.left&&this.$pointer.css("left",j.left+i)}}},remove:function(){$(window).off("resize",this._repostionCallback),c.Dialog.prototype.remove.apply(this,arguments)}});var l=_.template('        <div class="modal hide zd-smallpopup <%= customClass %>" >            <div class="modal-body dialog-body zd-smallpopup-body">            </div>            <div class="zd-smallpopup-background">            </div>            <div class="zd-smallpopup-background small">            </div>        </div>    ');c.SmallPopup=c.Dialog.extend({template:l,events:{"click .zd-smallpopup-background":"hide","keypress input":"keyEnterPressed"},defaults:{mode:"palette",draggable:!1,resizable:!1,modal:!1,containment:"body"},keyEnterPressed:function(a){c.Palette.prototype.keyEnterPressed.apply(a,arguments)},initialize:function(){function a(){d._lastPostiton?d.position():null}var d=this;this._lastPostiton=null,this._repostionCallback=_.debounce(a,300),$.extend(this.events,c.Dialog.prototype.events),c.Dialog.prototype.initialize.apply(this,arguments),this.$pointer=$('<div class="zd-smallpopup-pointer"><div class="zd-smallpopup-pointer-arrow"></div></div>'),$("body").one("dragstart",function(){d.hide()}),this.$el.on("dragstart",!1),$(window).on("resize",this._repostionCallback),this.listenTo(b.eventDispatcher,"visualization:stop",this.hide)},render:function(){return c.Dialog.prototype.render.apply(this,arguments),this.$(".zd-smallpopup-background").show(),this.$el.on("mousewheel","textarea",function(a,b,c,d){a.preventDefault();var e=$(this).scrollTop();$(this).scrollTop(e+d)}),this},position:function(a){function b(b,c){b.top-=a.pointerTop||0,d.$el.css(b),d._showPointer(c)}var d=this;return a=a||this._lastPostiton||{},this._lastPostiton=a,a.using=a.using||b,c.Dialog.prototype.position.call(this,a)},_showPointer:function(a){var b=a.element,c=a.target,d={},e="behind",f="10px solid transparent",g="10px solid rgb(230, 230, 230)";if(c.center={left:c.left+c.width/2,top:c.top+c.height/2},b.center={left:b.left+b.width/2,top:b.top+b.height/2},d.vertical=c.center.top-b.center.top,d.vertical=d.vertical<0?d.vertical+"px":"+"+d.vertical+"px",d.horizontal=c.center.left-b.center.left,d.horizontal=d.horizontal<0?d.horizontal+"px":"+"+d.horizontal+"px",b.left+b.width<c.center.left&&(e+=" right"),b.left>c.center.left&&(e+=" left"),b.top+b.height<c.center.top&&(e+=" bottom"),b.top>c.center.top&&(e+=" top"),e=e.split(" ").splice(1),1==e.length)switch(this.$pointer.appendTo(this.$el),e[0]){case"left":this.$pointer.css({"border-top":f,"border-bottom":f,"border-right":g}).position({my:"right center",at:"left center"+d.vertical,of:this.el});break;case"right":this.$pointer.css({"border-top":f,"border-bottom":f,"border-left":g}).position({my:"left center",at:"right center"+d.vertical,of:this.el});break;case"top":this.$pointer.css({"border-top":g,"border-right":f,"border-left":f}).position({my:"center bottom",at:"center"+d.horizontal+" top",of:this.el});break;case"bottom":this.$pointer.css({"border-right":f,"border-top":g,"border-left":f}).position({my:"center top",at:"center"+d.horizontal+" bottom",of:this.el})}},remove:function(){$(window).off("resize",this._repostionCallback),c.Dialog.prototype.remove.apply(this,arguments)},closeModal:function(){this.$el.fadeOut(300)}}),c.PalettePopup=c.InfoPopup.extend({initialize:function(){return b.MVC.View.prototype.initialize.apply(this,arguments),_.bindAll(this,"showBackButton","hideBackButton"),c.InfoPopup.prototype.initialize.apply(this,arguments),this.$el.on("dragstart",!1),this},render:function(){var a={top:12,bottom:66};return c.InfoPopup.prototype.render.apply(this,arguments),this.$el.addClass("zd-palettepopup"),this.settings.handlers&&this.showHandlers(),this.$body.css("max-height",this.options.containment.height()-a.top-a.bottom-(this.$el.outerHeight()-this.$body.height())),this},showHandlers:function(){var a=this;this.handlers=this.options.handlers,this.$footer=$('<div class="zd-infopopup-footer"></div>'),this.$el.append(this.$footer),_.each(this.handlers,function(b){var c=b.tagName||"button",d=$("<"+c+' class="">'+b.title+"</"+c+">");b.icon&&d.prepend('<i class="zd icon '+b.icon+'"></i>'),b.className&&d.addClass(b.className),d.click(function(){b.callback()}),a.$footer.append(d)})},showBackButton:function(){return b.Controls.Palette.prototype.showBackButton.apply(this,arguments),this},hideBackButton:function(){return b.Controls.Palette.prototype.hideBackButton.apply(this,arguments),this}}),c.DetailsPopup=c.Dialog.extend({template:k,events:{"click .zd-infopopup-background":"hide"},defaults:{mode:"palette",draggable:!1,resizable:!1,modal:!1,containment:"body"},initialize:function(){$.extend(this.events,c.Dialog.prototype.events),c.Dialog.prototype.initialize.apply(this,arguments)}});var m=_.template('        <div>             <div class="zd-side-pane">                <div class="zd-side-pane-header"/>                <button value="closeSidePane" class="close">&times;</button>                <div class="zd-side-pane-body"/>            </div>        </div>     '),n=_.template('        <div class="zd-modal sidepane">             <div class="zd-side-pane">                <div class="zd-side-pane-loading"/>                <div class="zd-side-pane-header"/>                <div class="zd-side-pane-body"/>            </div>        </div>     ');c.SidePane=b.MVC.View.extend({initialize:function(){function a(){var a=b.user||new b.Models.User;a.bootstrap().done(function(){var b=a.get("name");window.localStorage["sidePaneHasBeenClosedBy"+b]="true"}),c.$el.hide(),b.eventDispatcher.trigger("sidepane:manualhide")}b.MVC.View.prototype.initialize.apply(this,arguments),_.bindAll(this,"render","hide","show","close","getHeader","visible");var c=this;this.hasCloseButton=this.options.hasCloseButton,this.template=this.hasCloseButton?m:n,this.setElement(this.template()),this.$el.appendTo("body"),this.hide(),this.$loading=this.$(".zd-side-pane-loading"),this.$body=this.$(".zd-side-pane-body"),this.$header=this.$(".zd-side-pane-header"),this.$closeButton=this.$(".close"),this.hasCloseButton||(this.$(".zd-side-pane").on("click",function(a){a.stopPropagation()}),this.$el.on("click",a))},events:{"click .close":"hide"},render:function(a){return this.$body.empty(),this.$body.append(a),this.delegateEvents(),this},hide:function(){this.$el.hide()},show:function(){$(".zd-side-pane").parent("div").hide(),this.$el.show(),this.$el.find("input").blur()},close:function(){this.$el.remove()},getHeader:function(){return this.$header},visible:function(){return this.$el&&this.$el.is(":visible")}});var o=_.template('        <span><%= message %></span>        <i title="<%= acceptTitle%>" class="icon-ok icon-white"></i>        <i title="<%= cancelTitle%>" class="icon-remove icon-white"></i>    ');c.ConfirmMessage=b.MVC.View.extend({tagName:"span",className:"label label-warning pull-right confirmMessage",defaults:{template:o,message:"Warning",acceptTitle:"Accept",cancelTitle:"Cancel"},events:{"click .icon-ok":"accept","click .icon-remove":"cancel"},initialize:function(a){this.settings=$.extend({},this.defaults,a),this._deferred=$.Deferred(),this.result=this._deferred.promise()},accept:function(){var a=this;return this.$el.fadeOut(function(){a.remove(),a._deferred.resolve()}),!1},cancel:function(){var a=this;return this.$el.fadeOut(function(){a.remove(),a._deferred.reject()}),!1},render:function(){return this.$el.html(this.settings.template({message:this.settings.message,acceptTitle:this.settings.acceptTitle,cancelTitle:this.settings.cancelTitle})),this.$el.hide().fadeIn(),this.delegateEvents(),this}}),c.Notification=b.MVC.View.extend({defaults:{delay:3e3,type:"info"},events:{click:"remove"},initialize:function(a){a=a||{},a.template&&(this.template=a.template,delete a.template),this.options=$.extend({},this.defaults,a),this.$el.addClass("zd notification alert alert-"+this.options.type).appendTo("body").hide()},render:function(a){var b=this,c=this.options.delay;return this.empty(),this.$el.append(a),"number"==typeof c?setTimeout(function(){b.remove()},c):this.$el.append('<div class="zd icon remove"></div>'),this.$el.slideDown(),this},remove:function(){var a=this,c=arguments;this.$el.slideUp(function(){b.MVC.View.prototype.remove.apply(a,c)})}}),c.Popover=function(){var a=b.MVC.View.extend({contentView:null,_data:!1,_container:!1,_stopHide:!1,_setEvents:!1,_setHeadEvents:!1,_buttons:{},_headTemplate:'<span style="overflow: hidden;display: block;"><%=name%></span>',_bodyTemplate:'<div class="span4" style="margin-left:0">                     <div class="row-fluid">                           <div class="popoverWindow" id="popowerWindow_1" style="min-height:<%=height%>px;">                        <div style="height: <%=height-40%>px; overflow: auto;">                         <% _.each(data, function(period) { %>                            <div class="span12 popoverSmallHeader">                                <%=period.name%>                             </div>                              <div class="span12 popoverDataInfo">                                Time Window                                 <div><%=period.time%></div>                             </div>                              <% _.each(period.values, function(val) { %>                                <div class="span12 popoverDataInfo">                                    <%=val.name%>                                     <div><%=val.value%></div>                                 </div>                              <%});%>                        <%});%>                        </div>                             <div class="span12 popoverFooter">                                <span></span>                                <div class="btn-group">                                    <button class="btn<% if (buttons.zoom == false) {%> dis<%}%>" data-type="zoom">Zoom In</button>                                    <button class="btn<% if (buttons.details == false) {%> dis<%}%>" data-type="details">Details</button>                                    <button class="btn<% if (buttons.trend == false) {%> dis<%}%>" data-type="trend" data-name="_ts">Trend</button>                                    <% if (buttons.twitter) {%><button class="btn" data-type="twitter" data-name="_ts">Twitter</button><%}%>                                </div>                            </div>                        </div>                        <div class="popoverWindow" id="popowerWindow_2" style="display:none;min-height:<%=height%>px;">                            <div style="height: <%=height%>px; overflow: auto;">                                 <% _.each(zoomInFields, function(val) { %>                                    <div class="span12 popoverDataInfo">                                        <div class="popoverZoomTo" data-name="<%=val.name%>"><%=val.label%></div>                                     </div>                                  <%});%>                            </div>                        </div>                                            </div>                </div>',initialize:function(a){b.MVC.View.prototype.initialize.apply(this,arguments),_.bindAll(this,"render","buildPopoverHeader","buildPopoverBody","show","hide","setTemplate","data","stopHide"),a=$.extend({setEvents:!1,setHeadEvents:!1,body:!1,head:!1,container:$("body"),buttons:!1},a),this._buttons={zoom:!0,details:!1,trend:!1,twitter:!1};return"function"==typeof a.setEvents&&(this._setEvents=a.setEvents),"function"==typeof a.setHeadEvents&&(this._setHeadEvents=a.setHeadEvents),a.body&&(this._bodyTemplate=a.body),a.buttons&&(this._buttons=$.extend(this._buttons,a.buttons)),a.head&&(this._headTemplate=a.head),a.container&&(this._container=a.container),$("#popoverElement").remove(),$("body").append($("<div>").attr("id","popoverElement").css({position:"absolute",width:1,height:1,display:"none","z-index":1010}).append("<div>")),this.render()},render:function(){var a=this;return $("#popoverElement>div").popover({html:!0,title:function(){return a.buildPopoverHeader()},content:function(){return a.buildPopoverBody()}}).on("show",function(){console.log("popover shown"),$(".zd-main-section").off("click").on("click",function(b){a.hide(b)}),b.eventDispatcher.trigger("freezeTime")}).on("hide",function(){console.log("popover hidden"),$(".zd-main-section").off("click"),b.eventDispatcher.trigger("unfreezeTime")}),b.eventDispatcher.trigger("rendered"),this.listenToOnce(b.eventDispatcher,"visualization:stop",function(){$("#popoverElement").remove()}),this},buildPopoverHeader:function(){var a=$(_.template(this._headTemplate,this._data));return"function"==typeof this._setHeadEvents&&this._setHeadEvents(a,this._data),a},buildPopoverBody:function(){this._data.buttons=this._buttons,this._data.height=Math.max(250,Math.min(500,$("body").height()/2));var a=$(_.template(this._bodyTemplate,this._data));return"function"==typeof this._setEvents&&this._setEvents(a,this._data),a},hideDelay:!1,show:function(a,c){var d=c.x,e=c.y;this._data=a;var f=this;$("#popContainer").attr("class",b.main.$section.width()<500?"span3":"span4"),$("#popoverElement .popoverFooter .btn-group").css("paddingLeft",b.main.$section.width()<500?"6%":"15%");var g=$("body").height(),h=null,i=null,j=null,k=0,l=0,m=b.Utilities.MODE.WIDGET!==b.Utilities.mode()&&g>=450?300:10,n=b.Utilities.MODE.WIDGET!==b.Utilities.mode()&&g>=450?50:10;l=Math.max(200,Math.min(Math.max(e,m),g-n)),h=$("#popoverElement"),h.css({top:l,left:d}).show().find("div").popover("show"),i=$("#popoverElement .popover"),j=$("#popoverElement .arrow"),d+1*i.width()>b.main.$section.width()+$("#popContainer").width()/2&&h.css("left",Math.max(10,d-i.width()-10)).find(".popover").removeClass("right").addClass("left");var o=$("#popoverElement>.popover").height();l+o/2>g-n&&(l=g-n-o/2,h.css("top",l)),k=e-(l+i.position().top);var p=o,q=2,r=j[0].offsetHeight;k=Math.min(p-r/2-q,k),k=Math.max(r/2+2*q,k),j.css("top",k),this.hideDelay=!0,setTimeout(function(){f.hideDelay=!1},200)},hide:function(a){return this._stopHide?void(this._stopHide=!1):void(void 0!==a&&($(a.target).parents(".popover").length||$(a.target).parent(".bar").length||this.hideDelay)||$("#popoverElement>div:first").popover("hide"))},setTemplate:function(a,b){void 0!==b&&b?this._headTemplate=a:this._bodyTemplate=a},data:function(){return this._data},stopHide:function(){this._stopHide=!0}});return a}(),c.TwittViewer=b.MVC.View.extend({contentView:null,_data:!1,_stopHide:!1,_setEvents:!1,_bodyTemplate:"<div></div>",initialize:function(a){b.MVC.View.prototype.initialize.apply(this,arguments),a=$.extend({setEvents:!1,body:!1},a);return"function"==typeof a.setEvents&&(this._setEvents=a.setEvents),a.body&&(this._bodyTemplate=a.body),$("#twittViewerElement").remove(),$("body").append($("<div>").attr("id","twittViewerElement").attr("class","modal hide fade").attr("tabindex","-1").attr("role","dialog").attr("aria-labelledby","myModalLabel").attr("aria-hidden","true")),this.render()},render:function(){return $("#twittViewerElement").html(this.buildTwittViewerBody()),$("#twittViewerElement").modal({show:!1}),this},buildTwittViewerBody:function(){console.log(this._data);var a=$(_.template(this._bodyTemplate,this._data)());return"function"==typeof this._setEvents&&this._setEvents(a,this._data),a},show:function(a){this._data=a;$("#twittViewerElement").modal("show")},hide:function(){$("#twittViewerElement").modal("hide"),b.eventDispatcher.trigger("twittViewerHide")},data:function(){return this._data}});var p=_.template('        <span class="zd-radial-item-label"><%=label%></span>    ');c.RadialMenu=b.MVC.View.extend({className:"zd-radial-menu",defaults:{template:p,arc:{start:-40,end:220,gap:4,radius:66,width:44,color:"rgba(0, 0, 0, 0.7)"},arcClosed:{radius:66,width:44,start:89,angle:2}},events:{},initialize:function(a){var c;return a=a||{},this.items=[],this.icons=[],this.closed=[],this.position={left:"50%",top:"50%"},b.MVC.View.prototype.initialize.apply(this,arguments),c={start:90,end:90,gap:0,radius:this.options.arc.radius,width:this.options.arc.width},this.start=$('<div class="zd-radial-start"></div>'),this._renderStart(c),this.end=$('<div class="zd-radial-end"></div>'),this._renderEnd(c),a.items&&(this.reset(a.items),delete this.options.items),this},render:function(a){var b=this;return a=a||{},this.empty(),""===a.group?this.$el.addClass("zd-empty-group"):this.$el.removeClass("zd-empty-group"),this.$el.append(this.start.show()),this.$el.append(this.end.show()),this.start.off("transitionend"),this.end.off("transitionend"),this.start.on("click",function(){b.items[0].arc.$donut.click()}).on("mouseenter",function(){b.items[0].arc.$donut.hasClass("active")?null:b.items[0].arc.$donut.addClass("active")}).on("mouseleave",function(){b.items[0].arc.$donut.hasClass("active")?b.items[0].arc.$donut.removeClass("active"):null}),this.end.on("click",function(){var a=b.items.length-1;b.items[a].arc.$donut.click()}).on("mouseenter",function(){var a=b.items.length-1;b.items[a].arc.$donut.hasClass("active")?null:b.items[a].arc.$donut.addClass("active")}).on("mouseleave",function(){var a=b.items.length-1;b.items[a].arc.$donut.hasClass("active")?b.items[a].arc.$donut.removeClass("active"):null}),requestAnimationFrame(function(){b._renderStart(),b._renderEnd()}),this.trigger("open"),this.setPosition(a),this.renderItems(),this.renderIcons(),this},renderIcons:function(){var a=this;return _.each(this.icons,function(b,c){a.renderIcon(c)}),this},renderIcon:function(a){var b=this,c=this.icons;return 0>a||a>=c.length?this:(this.$el.children().has(c[a].$icon).length?null:this.$el.append(c[a].$icon),requestAnimationFrame(function(){c[a].$icon.css(a%2?{top:20,right:b.options.arc.radius,opacity:1}:{top:20,left:b.options.arc.radius,opacity:1})}),this)},setPosition:function(a){return this.position.left=a.left||this.position.left,this.position.top=a.top||this.position.top,this.$el.css({left:this.position.left,top:this.position.top}),this},renderItems:function(){{var a=this;this.items.length}return _.each(this.items,function(b,c){a.renderItem(c)}),this},renderItem:function(a){var b=this.items;return this.isClosed(a)?this:0>a||a>=b.length?this:(this._renderArc(a),b[a].arc.$el.show(200),this)},reset:function(a){var b=this;return this.clear(),_.each(a,function(a){b.add(a)}),this},clear:function(){return this.clearItems(),this.clearIcons(),this},clearItems:function(){for(;0!==this.items.length;)this.removeItem(0);return this.closed=[],this},clearIcons:function(){for(;0!==this.icons.length;)this.removeIcon(0);return this},add:function(a){switch(a.type){case"icon":this.addIcon(a);break;case"arc":default:this.addItem(a)}return this},addIcon:function(a){var b=this;return a.$icon=$('<div class="zd-radial-icon" title="'+a.label+'"></div>'),a.$icon.append('<i class="zd-icon zd-icon-'+a.label.toLowerCase()+'"/>'),a.$icon.on("click",function(c){return"function"==typeof a.action?a.action.call(this,c,b.$el):null}),this.icons.push(a),this},addItem:function(a){var b=this,c=this.items,e=c[0],f=c[c.length-1];a.arc=new d.Arc(this.options.arcClosed),a.arc.$donut.on("click",function(c){return""!==a.group.group&&"function"==typeof a.action?a.action.call(this,c,b.$el):(""===a.group.group&&c.stopPropagation(),null)}),a.arc.$center.html(this.options.template(a)),f&&f.arc.$donut.off("mouseenter"),f&&f.arc.$donut.off("mouseleave"),a.arc.$donut.on("mouseenter",function(){b.end.hasClass("active")?null:b.end.addClass("active")}).on("mouseleave",function(){b.end.hasClass("active")?b.end.removeClass("active"):null}),e&&e.arc.$donut.on("mouseenter",function(){b.start.hasClass("active")?null:b.start.addClass("active")}).on("mouseleave",function(){b.start.hasClass("active")?b.start.removeClass("active"):null});var g=this.allOrUnFilterAll(a);return void 0!==a.disabled&&$.isFunction(a.disabled)&&a.disabled()===!0?this:(g!==a.name&&this.items.push(a),this)},allOrUnFilterAll:function(a){var c=b.main.currentSection.widgetGrid.childViews,d="un_filter_all";return("un_filter_all"===a.name||"filter_all"===a.name)&&_.each(c,function(b){if(b.controller.filtersIndicator){var c=b.controller.filtersIndicator.collection.models;_.each(c,function(b){b.get("value").indexOf(a.group.group)>=0?d="filter_all":null})}}),d},removeItem:function(a){var b=this.items[a];return this.isClosed(a)&&this.closed.splice(this.closed.indexOf(a),1),b.arc.$donut.off("click"),b.arc.$donut.off("mouseenter"),b.arc.$donut.off("mouseleave"),b.arc.remove(),this.items.splice(a,1),this},removeIcon:function(a){var b=this.icons[a];return b.$icon.off("click"),b.$icon.remove(),this.icons.splice(a,2),this},close:function(){var a=this,b={start:90,end:90,gap:0,radius:this.options.arc.radius,width:this.options.arc.width};return _.each(this.items,function(b,c){a.closeItem(c)}),_.each(this.icons,function(b,c){a.closeIcon(c)}),this.start&&(this._renderStart(b),this.start.one("transitionend",function(){a.start.hide(),a.empty()})),this.end&&(this._renderEnd(b),this.end.one("transitionend",function(){a.end.hide(),a.empty()})),this.trigger("close"),this},open:function(){return this.closed=[],this.renderItems(),this.renderIcons(),this},closeItem:function(a){var b=this.items;return this.isClosed(a)?this:0>a||a>=b.length?this:(b[a].arc.set(this.options.arcClosed),b[a].arc.$el.fadeOut(200),this.closed.push(a),this)},closeIcon:function(a){var b=this.icons;return b[a].$icon.css({width:0,height:0,opacity:0}),this},openItem:function(a){var b=this.items;return this.isClosed(a)?0>a||a>=b.length?this:(this.closed.splice(this.closed.indexOf(a),1),this.renderItem(a),this):this},isClosed:function(a){return-1!==this.closed.indexOf(a)},_renderArc:function(a){var b=a,c=this.items.length-this.closed.length,d=this.items[a].arc,e={};return _.each(this.closed,function(c){a>c?b--:null}),e.gap=this.options.arc.gap,e.radius=this.options.arc.radius,e.angle=(this.options.arc.end-this.options.arc.start)/c,e.start=this.options.arc.start+e.angle*b,this.$el.children().has(d.$el).length?null:this.$el.append(d.$el),requestAnimationFrame(function(){d.set(e)}),this},_renderStart:function(a){var b=this.start,a=a||this.options.arc,c=a.end+90,d=a.width,e=a.radius-a.width,f=-a.width/2+a.gap/2;b.css({transform:"rotate("+c+"deg)",transformOrigin:-f+"px "+-e+"px",width:d/2,height:d,borderBottomLeftRadius:d/2,borderTopLeftRadius:d/2,top:e,left:f})},_renderEnd:function(a){var b=this.end,a=a||this.options.arc,c=a.start+90,d=a.width,e=a.radius-a.width,f=-a.gap/2;b.css({transform:"rotate("+c+"deg)",transformOrigin:-f+"px "+-e+"px",width:d/2,height:d,borderBottomRightRadius:d/2,borderTopRightRadius:d/2,top:e,left:f})}});var q='        <div class="color-picker-button" style="background: <%=color%>;"></div>     ';c.ColorPicker=b.MVC.View.extend({initialize:function(a){return b.MVC.View.prototype.initialize.apply(this,arguments),this.color=a.color,this.render()},render:function(){return this.button=$(_.template(q,{color:this.color})),this.$el.append(this.button),this.renderPopup(),this},setColor:function(a){this.color=a,this.button.css("background",this.color),this.button.spectrum("set",this.color)},renderPopup:function(){var a,c,d=this;this.button.spectrum({color:this.color,preferredFormat:"hex",showInput:!0,showInitial:!0,chooseText:"Apply",cancelText:"Cancel",change:function(a){d.color=a.toHexString(),d.button.css("background",d.color),d.trigger("change",d.color)},beforeShow:function(){d.trigger("beforeShow")},show:function(){c||(c=$(".sp-container:visible"),c.find(".sp-choose").addClass("zd btn btn-success btn-block"),c.find(".sp-cancel").addClass("zd btn btn-cancel btn-block").insertAfter(c.find(".sp-choose"))),a=new b.Controls.SmallPopup({containment:b.main.$section,customClass:"colorPickerPalette",pointerWidth:14}),a.render(c).position({of:d.button,my:"left+10 center+10",at:"right center",collision:"flipfit flipfit"})},hide:function(){c.appendTo("body"),a.hide()}})}});var r='<div class="zd_controls_tooltip_content">\n                <%=content%>\n            </div>\n            <div class="zd_controls_tooltip_shape">\n            </div>';c.VisualizationTooltip=b.MVC.View.extend({className:"zd_controls_tooltip_container",infoTemplate:_.template('<%var key = key || false;%><h4 class="zd_tooltip_info_header"><%= (Array.isArray(group) ? group.join(", ") : (key ? key + ", " + group : group)) %></h4>\n            <div class="zd_tooltip_info_group">\n                <%if(historical){%>\n                    <span class="zd_tooltip_info_title">Current</span>\n                <%}%>\n                <div class="zd_tooltip_info_table">\n                    <div class="zd_tooltip_info_table_row">\n                        <div class="zd_tooltip_info_table_col">\n                            Volume\n                        </div>\n                        <div class="zd_tooltip_info_table_col">\n                            <%=current.count%>\n                        </div>\n                    </div>\n                    <%if(current.metrics){%>\n                        <%_.each(current.metrics, function(metric, name){%>\n                            <%_.each(current.metrics[name], function(value, func){%>\n                                <div class="zd_tooltip_info_table_row">\n                                    <div class="zd_tooltip_info_table_col">\n                                        <%=name%> (<%=func%>)\n                                    </div>\n                                    <div class="zd_tooltip_info_table_col">\n                                        <%=value%>\n                                    </div>\n                                </div>\n                            <%});%>\n                        <%});%>\n                    <%}%>\n                </div>\n            </div>\n            <%var historical = historical || false;%>\n            <%if(historical){%>\n            <div class="zd_tooltip_info_group">\n                <span class="zd_tooltip_info_title">Historical</span>\n                <div class="zd_tooltip_info_table">\n                    <div class="zd_tooltip_info_table_row">\n                        <div class="zd_tooltip_info_table_col">\n                            Volume\n                        </div>\n                        <div class="zd_tooltip_info_table_col">\n                            <%=historical.count%>\n                        </div>\n                    </div>\n                    <%if(historical.metrics){%>\n                        <%_.each(historical.metrics, function(metric, name){%>\n                            <%_.each(metric, function(value, func){%>\n                                <div class="zd_tooltip_info_table_row">\n                                    <div class="zd_tooltip_info_table_col">\n                                        <%=name%> (<%=func%>)\n                                    </div>\n                                    <div class="zd_tooltip_info_table_col">\n                                        <%=value%>\n                                    </div>\n                                </div>\n                            <%});%>\n                        <%});%>\n                    <%}%>\n                </div>\n            </div>\n            <%}%>\n        '),converter:function(a){var b=Object.keys(this.controller.metrics),c={};return c.current={count:a.current.count},c.group=a.group,a.key&&(c.key=a.key),b.length>0&&a.current.metrics&&(c.current.metrics={},_.each(this.controller.metrics,function(b){if(Array.isArray(b))_.each(b,function(b){"count"!==b.metric.name&&(c.current.metrics[b.metric.label+" : "+b.objectField.label]={},c.current.metrics[b.metric.label+" : "+b.objectField.label][b.objectField.func]=b.formatted(a))});else{if("count"===b.metric.name)return;c.current.metrics[b.objectField.label]={},c.current.metrics[b.objectField.label][b.objectField.func]=b.formatted(a)}})),a.historical&&(c.historical={count:a.historical.count},b.length>0&&a.historical.metrics&&(c.historical.metrics={},_.each(this.controller.metrics,function(b){"count"!==b.metric.name&&(c.historical.metrics[b.objectField.label]={},c.historical.metrics[b.objectField.label][b.objectField.func]=b.formatted(a))}))),c},initialize:function(a){return b.MVC.View.prototype.initialize.apply(this,arguments),this.SETTINGS={radius:22,border:2,color:"#939393",bg_color:"white",opacity:1,edge_margin:5},this.$body=$("body"),this.$root=this.$body,this.hidden=!0,this.at={left:0,top:0},this.getter=null,this.template=_.template(r),a.template&&(this.infoTemplate="string"==typeof a.template?_.template(a.template):a.template,delete a.template),a.converter&&(this.converter=a.converter,delete a.converter),a.controller&&(this.controller=a.controller,this.$root=this.controller.$el,this.$body=this.$root.parents(".widgetBody").eq(0),delete a.controller,this.applyEvents()),this.$root.append(this.$el),this.position={x:0,y:0},this.SHAPES={corner:"<svg width="+this.SETTINGS.radius+" height="+2*this.SETTINGS.radius+'><path class="zd_controls_tooltip_stroke" d="" /></svg>',between:"<svg width="+this.SETTINGS.radius+" height="+3*this.SETTINGS.radius+'><path class="zd_controls_tooltip_stroke" d="" /></svg>'},this.$styles=$("<style></style>"),this.$tailDiv=$('<div class="zd_controls_tooltip_tail"></div>'),this},$in:function(){return this.$(".zd_controls_tooltip_content").eq(0)},$main:function(){return this.$(".zd_controls_tooltip_shape").eq(0)},applyEvents:function(){var a=this;return this.listenTo(this.controller.thread,"thread:message",function(){setTimeout(function(){a.update()},60)}),this},show:function(a){return this.hidden=!1,this.render(a),this},hide:function(){return this.hidden=!0,this.render(),this},render:function(a){var b=null;return this.hidden?(this.$el.empty().hide(),this):(this.$el.appendTo(this.$root),this.$el.html(this.template({content:""})),a.color&&(this.color=a.color,this.updateColor(),delete a.color),a.getter&&(this.updateGetter(a.getter),delete a.getter),a.event&&(b=a.event,delete a.event),this.$tailDiv.appendTo(this.$main()),this.prepareStyles(),this.prepareCurve(),this.$el.show(),this.move(b?{event:b}:!1),this.update(),this)
},update:function(a){if(!this.hidden&&this.getter){var b=this.getter?this.getter():{};this.$in().html(this.infoTemplate(this.converter(b())));var c=$(this.$el.find(".zd_tooltip_info_header")),d=c.width();return d%2!==0&&c.width(d+1),this.updateColor(),a&&(a.event||a.at)&&this.move(a),this}},move:function(a){function b(){var a=[[0,0,0],[0,0,0],[0,0,0]],b=[["corner top left","between top","corner top right"],["between left","between top","between right"],["corner bottom left","between bottom","corner bottom right"]],c=null;return a.forEach(g/2+l+k>=e?function(a,d){1===a[0]&&(c=b[d][0]),a[0]=a[0]+1}:e>=i-g/2-l-k?function(a,d){1===a[2]&&(c=b[d][2]),a[2]=a[2]+1}:function(a,d){1===a[1]&&(c=b[d][1]),a[1]=a[1]+1}),h+l+k>=f?a[0]=a[0].map(function(a,d){return 1===a&&(c=b[0][d]),a+1}):f>=j-h-l-k?a[2]=a[2].map(function(a,d){return 1===a&&(c=b[2][d]),a+1}):a[1]=a[1].map(function(a,d){return 1===a&&(c=b[1][d]),a+1}),c}var c=this.$root.offset(),d={top:0,left:0};a&&a.at&&(this.at=a.at,delete a.at),a&&a.event?(d.top=a.event.clientY,d.left=a.event.clientX):(d.top=this.at.top,d.left=this.at.left),d.top-=c.top,d.left-=c.left;var e=d.left,f=d.top,g=this.$el.width(),h=this.$el.height(),i=this.$root.width(),j=this.$root.height(),k=this.SETTINGS.edge_margin,l=this.SETTINGS.radius+k,m=[0,0,0,0],n=b();this.$tailDiv.attr("class","zd_controls_tooltip_tail "+n),this.$tailDiv.html(this.SHAPES[n.split(" ")[0]]),this.updateColor();var o=n.split(" ");switch(o[0]){case"corner":f="top"===o[1]?f+l+k:f-h-l-k,"right"===o[2]&&(e-=g);break;case"between":"top"===o[1]?(e-=g/2,f=f+l+k):"bottom"===o[1]&&(e-=g/2,f=f-h-l-k),"left"===o[1]?(e=e+l+k,f-=h/2):"right"===o[1]&&(e=e-g-l-k,f-=h/2)}var p=m.join("px ")+"px";return this.position={x:e,y:f},this.$el.css({left:this.position.x,top:this.position.y,margin:p}),this},updateColor:function(){if(this.color){var a="function"==typeof this.color()?this.color()():this.color();if(a)return this.$tailDiv.find("path").css({stroke:a}),this.$el.find(".zd_tooltip_info_header").css({color:a}),this.$main().css({"border-color":a}),this}},updateGetter:function(a){this.getter!==a&&(this.getter=a,this.update())},prepareStyles:function(){function a(a,b){return"#"+h+" "+a+"{"+b+"}"}function b(a){var b="";for(var d in a)b+=c(d,a[d]);return b}function c(a,b){return" "+a+":"+b+"; "}function d(c,d){f+=a(c,b(d))}function e(a){return a+"px "}var f="",g=this.SETTINGS,h=this.$body.attr("id");return d(".zd_controls_tooltip_shape",{opacity:g.opacity,"background-color":g.bg_color,border:e(g.border)+"solid "+g.color,"border-radius":e(g.radius/1.5)}),d(".zd_controls_tooltip_content",{padding:e(Math.round(g.radius/1.5))}),d(".zd_controls_tooltip_tail.corner",{width:e(g.radius),height:e(2*g.radius)}),d(".zd_controls_tooltip_tail.corner.right",{right:e(-g.border)}),d(".zd_controls_tooltip_tail.corner.left",{left:e(-g.border),transform:"scaleX(-1)"}),d(".zd_controls_tooltip_tail.corner.top",{top:e(-(g.radius+g.border/2))}),d(".zd_controls_tooltip_tail.corner.bottom",{transform:"scaleY(-1)",bottom:e(-(g.radius+g.border/2))}),d(".zd_controls_tooltip_tail.corner.bottom.left",{transform:"scaleY(-1) scaleX(-1)",bottom:e(-(g.radius+g.border/2))}),d(".zd_controls_tooltip_tail.between",{width:e(g.radius),height:e(3*g.radius)}),d(".zd_controls_tooltip_tail.between.right",{margin:e(1.5*-g.radius)+"0 0 0",right:e(-g.radius)}),d(".zd_controls_tooltip_tail.between.left",{margin:e(1.5*-g.radius)+"0 0 0",left:e(-g.radius),transform:"scaleX(-1)"}),d(".zd_controls_tooltip_tail.between.top",{top:e(2*-g.radius-g.border/2+1),left:"50%",margin:"0 0 0 "+e(-(g.radius/2+g.border/2)),transform:"rotate(-90deg)"}),d(".zd_controls_tooltip_tail.between.bottom",{bottom:e(2*-g.radius-g.border/2+1),left:"50%",margin:"0 0 0 "+e(-(g.radius/2+g.border/2)),transform:"rotate(90deg)"}),d(".zd_controls_tooltip_stroke",{stroke:g.color,fill:g.bg_color,"stroke-width":e(g.border),"stroke-linecap":"round"}),this.$styles[0].innerText=f,this.$styles.appendTo(this.$body),this},prepareCurve:function(){var a=this.SETTINGS.radius,b=this.SETTINGS.border,c={corner:"M0,"+a+" C"+a/2+","+(a-b/2)+" "+(a-b/2)+","+a/2+" "+(a-b/2)+",0 V"+(a-b/2)+","+2*a,between:"M0,0 C0,"+a+" "+a/2+","+1.5*a+" "+a+","+1.5*a+" C"+a/2+","+1.5*a+" 0,"+2*a+" 0,"+3*a};return this.SHAPES.corner=this.SHAPES.corner.replace('d=""','d="'+c.corner+'"'),this.SHAPES.between=this.SHAPES.between.replace('d=""','d="'+c.between+'"'),this}}),b.Controls=c}(window,Zoomdata),function(a,b){"use strict";var c='        <table class="table table-striped">            <tr>                <td>Item No</td>                <td><%=index%></td>            </tr>            <%_.each(_.keys(attributes), function (key) {%>                <tr>                    <td><%=key%></td>                    <td><%=attributes[key]%></td>                </tr>            <%});%>        </table>         ';b.Views=b.Views||{},b.Views.ListItem=b.MVC.View.extend({tagName:"li",className:"zd-list-item",model:new b.MVC.Model,events:{click:"_onClick"},defaults:{template:_.template(c),selectedClass:"zd-item-selected",selectable:!1},initialize:function(a){return this.childViews=[],this.settings=$.extend({},this.defaults,a),this.$el.data("itemView",this),this.listenTo(this.model,"change",this.render),this},render:function(){return this.$el.html(this.settings.template({attributes:this.model.attributes,index:this.model.index})),this.delegateEvents(),this},_onClick:function(){if(this.settings.selectable)return this.toggle(),!1;var a=$(".widgetBody").has(".configure-palette");0!=a.length&&b.eventDispatcher.trigger("close:configurePalette")},toggle:function(){this.$el.toggleClass(this.settings.selectedClass),this.trigger("toggle",this.model)}})}(window,Zoomdata),function(a,b){"use strict";var c=b.Views.ListItem,d=b.Views.SearchBox,e=b.MVC.Collection,f=_.template('            <span class="zd-loader">Loading...</span>         ');b.Views=b.Views||{},b.Views.ListView=b.MVC.View.extend({tagName:"ul",className:"unstyled",defaults:{loaderTemplate:f,search:!1,sortable:!1,selectable:!1,sortOptions:{tolerance:"pointer"},sortbyOptions:null,sortOpened:!1,filter:function(){return!0},ItemView:c,selectAll:!1},events:{sortstop:"onSortstop",sortreceive:"onSortreceive",sortremove:"onSortremove"},initialize:function(a){var b=this;return this.childViews=[],this.options=$.extend({},this.defaults,a),this.collection=this.collection||new e,this.selectAllItem=this.options.selectAll?new this.options.ItemView({selectAll:!0}):null,this.removeListeners(),this.applyListeners(),this.options.sortable&&this.$el.sortable(this.options.sortOptions),this.options.search!==!1&&(this.searchBox=new d,this.listenTo(this.searchBox,"search",this._renderItems)),this.options.selectable&&(this.selected=[],this.listenTo(this.collection,"toggle",function(a){var c=b.selected.indexOf(a),d=b.childViews,e=b.selected;"checkbox"!==b.options.selectable&&(_.each(d,function(b){b.model!==a&&-1!==e.indexOf(b.model)?b.toggle():null}),c=b.selected.indexOf(a)),-1==c?e.push(a):e.splice(c,1)})),this},applyListeners:function(){this.listenTo(this.collection,"request:collection",this._showLoader),this.listenTo(this.collection,"remove reset sync:collection",this.render),this.listenTo(this.collection,"add",this._onAddItem),this.selectAllItem&&this.listenTo(this.selectAllItem.model,"change",this._selectAll)},removeListeners:function(){this.stopListening(this.collection,"request:collection"),this.stopListening(this.collection,"remove reset sync:collection"),this.stopListening(this.collection,"add"),this.selectAllItem&&this.selectAllItem.model.off("change")},getItemByModel:function(a){var b=this.childViews,c=null;return _.each(b,function(b){b.model==a?c=b:null}),c},_resize:function(){_.each(this.childViews,function(a){a._resize&&a._resize()})},getSelectedItems:function(){return this.selected},sortCollection:function(a){function b(a,b){_.each(a.models,function(d,e){var f=d.get("name");if(b&&b.indexOf(f)>=0){var g=a.models.splice(e,1);a.models.unshift(g[0])}else if(f===c.options.sortOpened){var g=a.models.splice(e,1);a.models.unshift(g[0])}})}{var c=this,d=this.collection.comparator,e=a&&a.sortby,f=a&&a.ascending;a&&a.limitShowCount?a.limitShowCount:null}if(a&&"Name"!==e&&"Filter Name"!==e){if("Author"===e){var g=_.sortBy(this.collection.models,function(b){var c=(b.get("userName")||"").toLowerCase();return a&&a.topValue===b.get("userName")&&(c=" "+c),a&&!a.ascending?c=_.map(c.split(""),function(a){return String.fromCharCode(-a.charCodeAt(0))}):c});this.collection.models=g}else if("Last Used"===e){var g=_.sortBy(this.collection.models,function(a){return f?-a.get("lastModified"):a.get("lastModified")});this.collection.models=g}else if("Popularity"===e){var g=_.sortBy(this.collection.models,function(a){return f?-a.get("viewsCount"):a.get("viewsCount")});this.collection.models=g}else if("Type"===e){var g=_.sortBy(this.collection.models,function(a){return a.get("type")});this.collection.models=f?g:g.reverse()}}else{var g=_.sortBy(this.collection.models,function(b){if(a&&!a.ascending){var c=b.get("name").toLowerCase();return c=c.split(""),c=_.map(c,function(a){return String.fromCharCode(-a.charCodeAt(0))})}return d?void 0:b.get("name")?b.get("name").toLowerCase():""});this.collection.models=g}this.options.sortOpened&&("string"==typeof this.options.sortOpened?b(this.collection):b(this.collection,this.options.openedSources)),this.collection.findWhere({selectAll:!0})&&(this.collection.models=_.sortBy(g,function(a){return a.get("selectAll")}))},onSortstop:function(){this.sortCollection()},onSortreceive:function(a,b){var c=b.item,d=c.data("itemView"),e=d.model;this.collection.add(e,{silent:!0}),this.sortCollection(),this.collection.trigger("add")},onSortremove:function(a,b){var c=b.item,d=c.data("itemView"),e=d.model;this.collection.remove(e,{silent:!0}),this.childViews.splice(this.childViews.indexOf(d),1)},_onAddItem:function(a){return!a||this.searchBox&&!a.matchesSearch(this.options.search,this.searchBox.model.toJSON())?!1:(this._renderItem(a),!1)},_renderItem:function(a){var b=this,c={model:a,template:this.options.template,selectable:this.options.selectable};this.options.itemOption&&(c=$.extend({},this.options.itemOption,c));var d=new this.options.ItemView(c);this.sources&&d.model.set("sources",this.sources),this.$el.append(d.render().el),this.childViews.push(d),this.listenTo(d,"select",function(a,c){b.renderSelectAll(),b.trigger("select",a,c)}),this.listenTo(d,"toggle",function(a){b.trigger("toggle",a)})},_renderItems:function(){var a=this,b=this.collection.models,c=a.options.sortbyOptions,d=c&&c.limitShowCount?c.limitShowCount:null;this._removeItems(),this.searchBox&&(b=this.collection.search(this.options.search,this.searchBox.model.toJSON())),_.each(_.filter(b,this.options.filter),function(b,c){d&&c>=d||a._renderItem(b)}),this.options.sortable&&this.$el.sortable("refresh"),this.renderSelectAll(b),this._resize()},_removeItems:function(){this._removeChildViews()},render:function(a){a=$.extend({},this.options.sortbyOptions,a);var b=this.options.sortbyOptions||a&&a.sortby?a:null;return this.empty(),b?this.sortCollection(b):this.sortCollection(),this.searchBox?this.$el.prepend(this.searchBox.render().el):null,this._renderItems(),this},_showLoader:function(){this.empty(),this.$el.html(this.options.loaderTemplate())},renderSelectAll:function(a){var b=this,c=!!this.$el.parent().length,d=0,e=!0;this.selectAllItem&&(a=a||this.collection.models,c?a.forEach(function(a,c){var f=b.childViews[c];f&&f.$el.is(":visible")&&(d+=1,e=e&&!!a.get("selected"))}):e=!1,this.selectAllItem.model.set({selected:e},{silent:!0}),a.length&&(this.$el.prepend(this.selectAllItem.render().el),!d&&c?this.selectAllItem.$el.hide():this.selectAllItem.$el.show()))},_selectAll:function(){var a=this,b=this.collection.models,c=this.selectAllItem.model.get("selected");this.searchBox&&(b=this.collection.search(this.options.search,this.searchBox.model.toJSON())),b.forEach(function(b,d){var e=a.childViews[d];e&&e.$el.is(":visible")&&b.get("selected")!==c&&(b.set("selected",c,{silent:!0}),e.render())}),this.collection.trigger("change")},remove:function(){b.MVC.View.prototype.remove.apply(this,arguments),this.searchBox?this.searchBox.remove():null}})}(window,Zoomdata),function(a,b){"use strict";var c=b.Views.ListItem,d=b.Views.ListView,e=b.MVC.Collection,f='              <legend class="subhead"><%= label %></legend>        ',g='<div class="selected-attr-box"><%= label %></div>';b.Views=b.Views||{},b.Views.GroupedListView=b.MVC.View.extend({className:"unstyled",defaults:{ItemView:c,ListView:d,groupClassName:"nav nav-tabs nav-stacked",selectable:!1,showSelected:!1,filter:function(){return!0}},events:{},initialize:function(){var a=this;return b.MVC.View.prototype.initialize.apply(this,arguments),this.childViews=[],this.groups={},this.collection=this.collection||new e,this.listenTo(this.collection,"add",function(b){var c=a.options.groupBy,d=b.get(c);"undefined"!=typeof d?this._addToGroup(b.get(c),b):null}),this.listenTo(this.collection,"remove",function(b){var c=b.get(a.options.groupBy);"undefined"!=typeof c?this._removeFromGroup(b.get(a.options.groupBy),b):null}),this.listenTo(this.collection,"reset",function(){this._resetGroups()}),this._resetGroups(),this},_createGroup:function(a,b){var c=this;"undefined"!=typeof this.groups[a]&&this._removeGroup(a);var d=new e(b);this.options.comparator&&(d.comparator=this.options.comparator,d.sort()),this.groups[a]=new this.options.ListView({className:this.options.groupClassName,ItemView:this.options.ItemView,itemOption:this.options.itemOption||null,selectable:this.options.selectable,template:this.options.template,collection:d,filter:this.options.filter}),this._renderGroup(a),this.childViews.push(this.groups[a]),this.listenTo(this.groups[a],"select",function(a){c.trigger("select",a),c.options.showSelected&&c._renderSelectedAttr()})},_removeGroup:function(a){"undefined"!=typeof this.groups[a]&&(this.groups[a].$el.prev().remove(),this.groups[a].remove(),this.childViews.splice(this.childViews.indexOf(this.groups[a]),1),delete this.groups[a])},_clearGroups:function(){var a=this;_.each(this.groups,function(b,c){a._removeGroup(c)})},_removeFromGroup:function(a,b){var c;"undefined"!=typeof this.groups[a]&&(c=this.groups[a].collection.findWhere(b.attributes),c?this.groups[a].collection.remove(c):null,0==this.groups[a].collection.length?this._removeGroup(a):null)},_addToGroup:function(a,b){"undefined"==typeof this.groups[a]&&this._createGroup(a),this.groups[a].collection.add(b,{merge:!0})},_resetGroups:function(){var a=this;this._clearGroups();var b=this.collection.groupBy(function(b){return b.get(a.options.groupBy)});_.each(b,function(b,c){a._createGroup(c,b)})},_renderGroup:function(a){var c=this.groups[a].render().el;c.childNodes.length&&(this.$el.append(_.template(f,{label:b.Utilities.toTitleCase(a)})),this.$el.append(this.groups[a].el))},_sortGroups:function(){var a=this.groups,b={},c=Object.keys(a).sort(function(b,c){return a[b]-a[c]});c.sort();for(var d in a)_.each(c,function(d,e){b[c[e]]=a[d]});this.groups=b},_sortGroupModels:function(a){var b=a.groups,c={};_.each(b,function(a,b){var d=[],e=[];_.each(a.collection.models,function(b,c){var b=a.collection.models[c].get("label");d.push([b,c,a.collection.models[c]])}),d.sort(),_.each(d,function(b,c){var f=d[c][2];a.collection.model[c]=f,e.push(f)}),c[b]=e,a.collection.models=e})},setFilter:function(a){this.options.filter=a,_.each(this.groups,function(b,c){c.options.filter=a})},render:function(){var a=this;return this.empty(),this._sortGroups(),this.options.showSelected&&this._renderSelectedAttr(),_.each(this.groups,function(b,c){a._renderGroup(c)}),this},_renderSelectedAttr:function(){this.$el.find(".selected-attr-box").remove(),this.$el.prepend(_.template(g,{label:this.options.selectedModel.getColorKeyLabel()}))}})}(window,Zoomdata),function(a,b){"use strict";var c=b.Models.Source,d=_.template('            <div class="object-field-container ">                <div title="<%= attributes.type.toLowerCase()%>" class="zd icon drag-icon <%= attributes.type.toLowerCase()%>"></div>                <div class="text"><%= attributes.label%></div>                <i class="zd icon right-chevron" style="display: none"></i>            </div>        '),e=_.template('            <div class="attributeItem">                <div class="text"><%= attributes.label%></div>            </div>        ');b.Views=b.Views||{},b.Views.ObjectFieldItem=b.Views.ListItem.extend({model:new c,className:"object-field",events:{click:"select"},defaults:{template:d},select:function(){this.model.collection.trigger("select",this.model),this.trigger("select",this.model)}}),b.Views.SmallObjectFieldItem=b.Views.ObjectFieldItem.extend({className:"",selectTemplate:'<span class="zd icon checkbox radio"><span class="zd checked <%=selected %>"></span></span>',defaults:{template:e,checkbox:!0},initialize:function(a){return b.Views.ObjectFieldItem.prototype.initialize.apply(this,arguments),this.options=$.extend({},this.defaults,a),this},render:function(){if(b.Views.ObjectFieldItem.prototype.render.apply(this,arguments),this.settings.checkbox){var a=this.model.get("selected"),c=this.model.get("disabled"),d=_.template(this.selectTemplate,{selected:a?" selected":""});this.$el.prepend(d),a?this.$el.addClass("selected"):null,c?this.$el.addClass("disabled"):null}else this.$el.addClass("minimal");return this}})}(window,Zoomdata),function(a,b){"use strict";var c=function(a){return new b.Components.MetricFormatter(a)},d=_.template('            <dt title="<%= label==="Count"?"Volume":label%> <%=func ? "("+func+")": ""%>"><%= label==="Count"?"Volume":label%> <%=func ? "("+func+")": ""%>:</dt>            <dd><%=value%></dd>        '),e=_.template('            <dt title="<%= label%>"><%= label%>:</dt>            <dd><%= from%></dd>            <dd><%= to%></dd>        '),f=_.template("            <legend><%= label%></legend>        "),g=_.template('            <button title="Show Details" value="button-details" class="zd btn btn-success btn-block">Details</button>         '),h=b.Utilities.time.getEndTimeWithinStep;b.Views=b.Views||{},b.Views.DataItem=b.MVC.View.extend({className:"zd-data-item",defaults:{dataItemTemplate:d,timeItemTemplate:e,groupDelimiter:f,detailsButton:g},events:{},initialize:function(a){return a=a||{},a.state&&(this.state=a.state,delete a.state),a.fields&&(this.fields=a.fields,delete a.fields),a.data?(this.data=a.data,delete a.data):this.data={},b.MVC.View.prototype.initialize.apply(this,arguments),this.options=$.extend({},this.defaults,a),this},render:function(a){this.state.get("timeTrendStep");a?this.data=a:a=this.data;var b=this.getCurrentTime(a);return this.$el.empty(),this.renderGroup("Current",a.current,b),a.historical&&this.renderGroup("Historical",a.historical,this.getHistoricalTime(a)),this.delegateEvents(),this},update:function(a){var b=this.data,c=b.group,d=_.where(a,{group:c})[0];return d&&this.render(d),this},isTrends:function(){var a=this;return function(){return a.state.isTimeTrends()}()},getCurrentTime:function(a){var b=this.isTrends(),c=this.state.config.get("source"),d=this.state.get("timeTrendStep");if("undefined"==typeof c.date||b){if(b){if("DAY"===this.state.config.get("source").dataResolution){var e=new Date(a.group),f=new Date(h(a.group,d));return{from:e.getUTCMonth()+1+"/"+e.getUTCDate()+"/"+e.getUTCFullYear(),to:f.getUTCMonth()+1+"/"+f.getUTCDate()+"/"+f.getUTCFullYear()}}return{from:new Date(a.group).toLocaleString(),to:new Date(h(a.group,d)).toLocaleString()}}return null}if("DAY"===this.state.config.get("source").dataResolution){var e=new Date(this.state.time.get("fromTime")),f=new Date(this.state.time.get("time"));return{from:e.getUTCMonth()+1+"/"+e.getUTCDate()+"/"+e.getUTCFullYear(),to:f.getUTCMonth()+1+"/"+f.getUTCDate()+"/"+f.getUTCFullYear()}}return{from:new Date(this.state.time.get("fromTime")).toLocaleString(),to:new Date(this.state.time.get("time")).toLocaleString()}},getHistoricalTime:function(a){var b=this.isTrends(),c=this.state.config.get("source"),d=this.state.get("timeTrendStep");return"undefined"==typeof c.date||b?b?{from:new Date(a.historical.group).toLocaleString(),to:new Date(h(a.historical.group,d)).toLocaleString()}:null:{from:new Date(this.state.time.get("historicalFrom")).toLocaleString(),to:new Date(this.state.time.get("historicalTo")).toLocaleString()}},renderGroup:function(a,b,e){var f=$("<dl></dl>"),g=this.fields;this.$el.append(this.options.groupDelimiter({label:a})).append(f),null!==e?f.append(this.options.timeItemTemplate({label:"Time Window",from:e.from||null,to:e.to||null})):null,f.append(this.options.dataItemTemplate({label:"Count",value:c("NUMBER").format(b.count),func:null})),b.metrics&&_.each(b.metrics,function(a,b){var e="";for(var h in a){e=h;var i=_.filter(g.models,function(a){return b===a.get("name")||a.distinctCount}),j=_.find(i,function(a){return a.get("func")&&"distinct_count"===e?a.get("distinctCount"):a.get("func")&&"distinct_count"!==e?e===a.get("func").toLowerCase():"avg"===e||"distinct_count"===e});j||(j=_.find(i,function(a){return a.get("name")===b}));var k=j.get("label"),l=j.get("type");f.append(d({label:k,value:"distinct_count"!==e?c(l).format(a[e]):a[e],func:e}))}})},_onShowDetails:function(){this.renderDetails()}})}(window,Zoomdata),function(a,b){"use strict";var c=b.Views.ListView,d=b.MVC.Model.extend({idAttribute:"_id",initialize:function(){var a=this;return b.MVC.Model.prototype.initialize.apply(this,arguments),this.fields=this.collection.fields,this.setFields(),this.on("change",function(){a.setFields()}),this},setFields:function(a){var b=this;this.fields=a||this.fields,_.each(_.keys(this.attributes),function(a){if("_zdFields"!==a){var c=b.fields.findWhere({name:a});b.attributes._zdFields=b.attributes._zdFields||{},b.attributes._zdFields[a]=c&&c.toJSON()||{label:a}}})}}),e=b.MVC.Collection.extend({model:d,initialize:function(a,c){return c.fields&&(this.fields=c.fields,delete c.fields),b.MVC.Collection.prototype.initialize.apply(this,arguments),this}}),f=function(a){return new b.Components.MetricFormatter(a)},g=_.template('            <button title="Get More Details" value="button-more" class="zd btn btn-success btn-block">                More            </button>         '),h=_.template('            <div class="progress progress-striped active">                <div class="bar" style="width: <%=value%>%"></div>             </div>        '),i=_.template('            <legend>                <h4 class="pull-left"><%=title%></h4>                <div class="clearfix"></div>             </legend>        '),j=_.template('            <div class="media minimized" data-role="item-holder">                <div class="media-body">                    <h4 class="media-heading">                        <%= attributes.time !== null ? new Date(attributes.time).toLocaleString(): ("Item " + index) %>                    </h4>                    <div class="media">                        <blockquote data-role="item-holder">                            <div class="zd-data-item-details-holder" data-role="details-holder">                                <table class="table table-striped">                                    <%_.each(_.keys(attributes), function (key, index) {%>                                        <% if (key !== "_id" && key !== "time" && key !== "_zdFields" && attributes._zdFields[key]) {%>                                            <tr>                                                <td><%=attributes._zdFields[key].label%></td>                                                <td>                                                    <% var imageLink = new RegExp("[/|.|w|s]*/(?:image)/");%>                                                    <% var imageExt = new RegExp("(http|https)"+".*?"+"(jpg|gif|png|jpeg|JPG|GIF|PNG|JPEG)");%>                                                    <% var imageLink = new RegExp("(http|https)"+".*?"+"(image)");%>                                                    <% var image = imageExt.test(attributes[key]) || imageLink.test(attributes[key]); %>                                                    <% if (image) { %>                                                        <img style="max-width: 300px" src="<%= attributes[key] %>"/>                                                     <% } else { %>                                                         <%= attributes[key] %>                                                    <% } %>                                                </td>                                            </tr>                                        <%}%>                                    <%});%>                                </table>                             </div>                            <button value="button-item-details" class="zd btn-link">                                Expand <i class="icon-chevron-down"></i>                            </button>                         </blockquote>                    </div>                 </div>             </div>         '),k=(_.template('            <div class="media minimized" data-role="item-holder">                <div class="media-body">                    <h4 class="media-heading">                        <span><%=attributes.rep_dn%></span>                        <small class="pull-right"><%=new Date(attributes._ts).toLocaleString()%></small>                        <div class="clearfix"></div>                     </h4>                    <div class="media">                        <blockquote>                            <%=attributes.text%>                            <br>                            <div data-role="details-holder" data-itemid="<%=attributes._id%>" style="display: none;" class="media">                                <div class="media-body">                                    <blockquote>                                    </blockquote>                                 </div>                             </div>                             <button value="button-item-details" class="zd btn-link">Expand <i class="icon-chevron-down"></i></button>                         </blockquote>                    </div>                 </div>             </div>         '),_.template('            <div data-role="item-holder" class="media">                <a class="zd pull-left thumbnail" target="_blank" href="https://twitter.com/<%=attributes.user_screen_name%>" class="pull-left">                    <img title="<%=attributes.user_name%>" class="media-object" src="<%=attributes.profile_image_url%>">                </a>                <div class="media-body">                    <h4 class="media-heading">                        <a title="<%=attributes.user_name%>" target="_blank" href="https://twitter.com/<%=attributes.user_screen_name%>">                        <%=attributes.user_name%>                        </a>                        <small class="pull-right"><%=new Date(attributes.created).toLocaleString()%></small>                        <div class="clearfix"></div>                     </h4>                    <blockquote>                        <a                             title="<%=attributes.user_name%>"                            target="_blank"                            href="https://twitter.com/<%=attributes.user_screen_name%>/status/<%=attributes.id%>"                        >                        <%=attributes.text%>                        </a>                         <small>                            <a title="<%=attributes.user_name%>" target="_blank" href="https://twitter.com/<%=attributes.user_screen_name%>">                                @<%=attributes.user_screen_name%>                            </a>                        </small>                    </blockquote>                </div>            </div>        '));b.Views=b.Views||{},b.Views.DataDetails=b.MVC.View.extend({className:"zd-data-item-details",defaults:{template:i,itemTemplate:j,filter:function(){return!0},search:!1,count:15,offset:0},events:{"click button[value='button-more']":"_onMoreClick","click button[value='button-item-details']":"_onItemDetailsClick"},initialize:function(a){a.state&&(this.state=a.state,delete a.state),a.fields&&(this.fields=a.fields,delete a.fields),a.data?(this.data=a.data,delete a.data):this.data={},b.MVC.View.prototype.initialize.apply(this,arguments),this.collection=this.collection||new e([],{fields:this.fields}),this.list=new c({collection:this.collection,filter:this.options.filter,search:this.options.search,template:this.options.itemTemplate}),this.childViews.push(this.list),this.$progressBar=$(h({value:100})),this.$moreButton=$(g());var d=this.state.config.get("streamType"),f=this.state.get("streamSourceId"),i=this.state.groupBy.getAttributes(),l=i[0],m=i.length>1,n=this.data.group,o=this.data.key,p=this.data.current.count,q=this.state.filters,r=a.fromTime,s=a.toTime,t=q.toJSON(),u={streamSourceId:f,fromTime:r,toTime:s,restrictions:t,itemTemplate:j,title:p+" Total Record"+(p>1?"s":"")};switch(l!==this.state.get("timestampField")&&(m?(t.push({path:i[1],operation:"EQUALS",value:n}),t.push({path:i[0],operation:"EQUALS",value:o})):t.push({path:l,operation:"EQUALS",value:n})),d){case"TWEET":u.itemTemplate=k,u.title=p+" Total Tweet"+(p>1?"s":"")}return this.setOptions(u),this.fields=b.sources.get(f).objectFields,this},setOptions:function(a){return a=a||{},this.options=$.extend({},this.options,a),this.options.itemTemplate?this.list.options.template=this.options.itemTemplate:null,this},render:function(){return this.$el.html(this.options.template({title:this.options.title})),this.$el.append(this.list.render().el),this.renderDetails(),this.delegateEvents(),this},renderDetails:function(a){var b=this;this.setOptions(a),this.forbidMore(),this.showLoader(),this.getDetails().done(function(a){var c=a.documents;_.each(c,function(a){var c,d,e;for(d in a)c=b.fields.findWhere({name:d}),e=c&&c.get("type"),!c||"MONEY"!==e&&"TIME"!==e&&"NUMBER"!==e||(a[d]=f(c.get("type")).format(a[d]))}),b.hideLoader(),b.allowMore(),b.collection.add(c,{silent:!0}),b.collection.forEach(function(a,b){a.index=b+1}),b.list.render(),a.hasNext?b.allowMore():b.forbidMore()}).fail(function(a){b.$el.append($('<div class="alert alert-error">Failed to fetch documents: '+a.statusText+"</div> "))})},getDetails:function(){var a=$.Deferred(),b={},c=0,d=this.state.get("timestampField"),e=this.state.get("timeWindowScale");this.fields.bootstrap().done(function(){c++,2==c?a.resolve(b):null}).fail(function(b){a.reject(b)});var f={count:this.options.count,offset:this.options.offset,streamSourceId:this.options.streamSourceId},g=this.options.restrictions.filter(function(a){return a.path!==d});return f.restrictions=g,"ALL"===e&&-1!==["IMPALA","SQL"].indexOf(this.options.sourceType)||(f.toTime=this.options.toTime,this.options.fromTime&&(f.fromTime=this.options.fromTime)),d?f.timestampField=d:null,$.ajax({type:"POST",url:"service/stream/preview",data:JSON.stringify(f),contentType:"application/json"}).done(function(d){b=d,c++,2==c?a.resolve(b):null}).fail(function(b){a.reject(b)}),a.promise()},allowMore:function(){var a=this;return this.$el.on("scroll",function(){var b=a.$el.prop("scrollHeight"),c=a.$el.scrollTop(),d=a.$el.height();d>=b-c&&a.renderDetails({offset:a.collection.length})}),this},forbidMore:function(){return this.$el.off("scroll"),this},showLoader:function(){this.$el.append(this.$progressBar)},hideLoader:function(){this.$progressBar.remove()},toggleItemDetails:function(a){var b=this;a=a||this.$('[data-role="item-holder"]'),a.each(function(){var a=$(this),c=a.find('button[value="button-item-details"]'),d=a.find('[data-role="details-holder"]');a.hasClass("open")?(a.removeClass("open"),a.addClass("minimized"),c.html('Expand <i class="icon-chevron-down"></i>'),b.hideDetails(d)):(a.addClass("open"),a.removeClass("minimized"),c.html('Collapse <i class="icon-chevron-up"></i> '),b.showDetails(d))})},showDetails:function(){return this},hideDetails:function(){return this},_onItemDetailsClick:function(a){var b=$(a.currentTarget),c=b.parents('[data-role="item-holder"]');
this.toggleItemDetails(c,b)}})}(window,Zoomdata),function(a,b){"use strict";function c(){var a=window.getComputedStyle(document.documentElement,""),b=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||""===a.OLink&&["","o"])[1];return"-"+b+"-"}var d='            <div class="color-key">                 <div class="color-key-content">                     <div class="color-key-metric-label"><b><%= metricLabel %></b></div>                     <div class="color-key-linear-view">                         <div class="color-key-scale"></div>                         <div class="color-key-labels"></div>                     </div>                     <ul class="color-key-list-view unstyled" style="display: none;"></ul>                 </div>	            </div>	        ',e='<div class="color-item" style="background: <%= color %>;"></div>',f='<li class="color-list-item"><div class="color-item" style="background: <%= color %>;"></div></li>';b.Views=b.Views||{},b.Views.ColorKey=b.MVC.View.extend({defaults:{isDraggable:!0},initialize:function(a){if(_.bindAll(this,"render","remove"),!a.controller)throw new Error("controller must be defined");this.controller=a.controller,delete a.controller,this.controller.state.colorDataObj&&(this.colorMetricLabel=this.controller.state.colorDataObj.getColorKeyLabel()),this.autoShow=a.autoShow,a.type?(this.type=a.type,delete a.type):this.type="gradient",b.MVC.View.prototype.initialize.apply(this,arguments),this.options.isDraggable&&"undefined"!=typeof $.fn.draggable&&(this.$el.draggable({start:function(){$(this).css({bottom:"auto",right:"auto"})},cursor:"move",containment:this.$el.parent()}),this.$el.on("drag mousedown",function(a){a.stopPropagation()}))},render:function(){var a,b=this,c="",e=this.$el.find(".color-key-list-view"),f=e.scrollTop()||0;return this.colorMetricLabel?e.data("mouseScrolling")?(e.off("mouseScrollingEnd").on("mouseScrollingEnd",function(){b.render()}),this):(this.colorDataObj=this.controller._controller.metrics[this.colorMetricLabel],this.colorDataObj&&this.colorDataObj[0]?(this.colorDataObj=this.colorDataObj[0],this.multiMetric=!0):this.controller.state.colorDataObj.isMetric()||(this.colorDataObj=this.controller.state.colorDataObj),this.colorDataObj?(this.multiMetric&&this.colorDataObj.isMetric()?a=this.colorDataObj.metric.label:(a=this.colorDataObj.getColorKeyLabel(),this.colorDataObj.isMetric()&&(c=this.colorDataObj.metric.func,c&&"none"!==this.colorDataObj.metric.name&&(a+=" ("+c+")"))),this.$el.empty().append(_.template(d,{metricLabel:a})),this.initScale(),this.initLabels(),this.autoShow?this.show():this.$el.is(":visible")&&this.fixPosition(),e=this.$el.find(".color-key-list-view"),e.scrollTop(f),this.initScrollingDetection(e),this.delegateEvents(),this):(this.hide(),this)):(this.hide(),this)},initScrollingDetection:function(a){var b=!1;a.on("mousedown",function(){b=!0}).on("scroll",function(){a.data("mouseScrolling",!0)}).on("mouseup",function(){b=!1,a.data("mouseScrolling",!1),a.trigger("mouseScrollingEnd")})},fixPosition:function(){var a=this.$el.parent().width()-this.$el.width()-5,b=this.$el.parent().height()-this.$el.height()-5,c=this.$el.position();c.top>b&&this.$el.css("top",b),c.left>a&&this.$el.css("left",a)},cloneTo:function(a){var b=this.$el.find(".color-key").clone().show();a.append(b),this.initScrollingDetection(b.find(".color-key-list-view"))},initScale:function(){var a=c(),b=this.$el.find(".color-key-scale").empty(),d=this.$el.find(".color-key-list-view").empty(),g=this.colorDataObj.colorRange()||[];return g.length?(this.colorDataObj.isMetric()&&"none"===this.colorDataObj.metric.name&&(g=[g[0],g[0]]),void(this.multiMetric||!this.colorDataObj.isMetric()||"gradient"!==this.controller.state.divergingColorRange&&"none"!==this.colorDataObj.metric.name?!this.multiMetric&&this.colorDataObj.isMetric()&&g.length<=3?(this.$el.find(".color-key").css("width",""),d.hide(),b.show().css("width","85%").css("background","transparent"),$.each(g,function(a,c){b.append(_.template(e,{color:c}))}),b.find(".color-item").css("width",100/g.length+"%")):(this.$el.find(".color-key").css("width","auto"),b.hide(),d.show(),$.each(g,function(a,b){d.append(_.template(f,{color:b}))})):(this.$el.find(".color-key").css("width",""),d.hide(),b.show().css("width",null).css("background",a+"linear-gradient(left, "+g.join(",")+")").css("background","linear-gradient(to right, "+g.join(",")+")")))):void b.hide()},initLabels:function(){var a,c,d=this.colorDataObj.domain()||[],e=this.$el.find(".color-key-list-view li"),f=this.$el.find(".color-key-labels").empty();this.colorDataObj.isMetric()&&(a=this.controller.fields.findWhere({name:this.colorDataObj.metric.name}),c=new b.Components.MetricFormatter(a.get("type")),"gradient"===this.controller.state.divergingColorRange&&(d=[d[0],d[d.length-1]]),"none"===this.colorDataObj.metric.name&&(d=[])),!this.multiMetric&&this.colorDataObj.isMetric()&&d&&"undefined"!=typeof d[0]?($.each(d,function(a,b){b>10?d[a]=b=b.toFixed(0):(100*b).toFixed(0)!==(100*b).toString()&&(d[a]=b=b.toFixed(2)),d.length<=4&&f.append('<span class="color-key-label">'+c.format(b)+"</span>")}),d.length>4&&e.each(function(a,b){var e=c.format(d[a]);e+=d[a+1]?" - "+c.format(d[a+1]):" +",b.innerHTML+=e})):(this.multiMetric||!this.colorDataObj.isMetric())&&e.each(function(a,b){b.innerHTML+=d[a]}),("gradient"!==this.controller.state.divergingColorRange&&d.length<=4||!this.colorDataObj.isMetric())&&f.find(".color-key-label").css("width",100/d.length+"%")},show:function(){this.$el.show(),this.fixPosition()},hide:function(){this.$el.hide(),this.autoShow=!1},isVisible:function(){return this.$el.is(":visible")}})}(window,Zoomdata),function(a,b){"use strict";b.Components=b.Components||{};var c=b.Views.SmallObjectFieldItem,d=b.Views.GroupedListView,e=b.Views.MetricPalette,f=b.Views.TimeScaleControl,g=b.Views.DataItem,h=b.Views.DataDetails,i=b.eventDispatcher,j=b.Utilities.time.getEndTimeWithinStep;b.Components.InteractiveElementsMethods=function(){this.assemblyInteractiveElementActions=function(a){function k(){var b=G.items.reverse()||[];b.forEach(function(a){G[a]?m(G,a):O[a]?O[a]():console.warn('No function assigned to custom action "'+a+'"')});var c={searchDetails:"search",search:"search",timeScale:"timeScale",attribute:"objectField",metric:"metric",groupBy1:"objectField",groupBy2:"objectField",radius:"metric"},d=["objectFieldAcceptor","pivotLabel"];a.droppable===!0&&"function"==typeof F&&(c[E]?z(c[E]):_.contains(d,E)?A():z("objectField"))}function l(){if("function"==typeof F)switch(E){case"searchDetails":x(),z("search");break;case"search":x(),p(),q(),r(),z("search");break;case"timeScale":t(),z("timeScale");break;case"attribute":s(),z("objectField");break;case"metric":u(),z("metric");break;case"groupBy1":s(),z("objectField");break;case"groupBy2":s(),z("objectField");break;case"radius":v(),z("metric");break;case"objectFieldAcceptor":A();break;case"pivotLabel":break;default:J&&!K&&o(),n(),p(),q(),r(),K||y(),w(),z("objectField")}}function m(a,b){M.push({name:b,group:F(),label:b,action:a[b].bind(D)})}function n(){M.push({name:"info",group:F(),label:"Info",type:"icon",action:function(c,d){function e(){C.on("thread:message",i),C.on("thread:timeline",k);var a=new b.Controls.InfoPopup({containment:b.main.$section,customClass:y?"":"zd-infopopup-hide-details"}),c=null;y&&(c=[{label:"Details",type:"success",callback:function(){a.hide(),f()}}]),a.setActions(c).render(x.render().el,B.state.isTimeTrends()?u:(l.key?l.key+", ":"")+l.group).position({of:d,my:"left top-30",at:"center center",collision:"flipfit flipfit"}),a.onHide=function(){C.off("thread:message",i),C.off("thread:timeline",k),x.remove()}}function f(){var a=new b.Controls.DetailsPopup({containment:b.main.$section,modal:!0,wide:!0}),c=o?m[1]:m[0];a.onHide=function(){y.remove()},a.render(y.render().el,B.state.isTimeTrends()?u:p.findWhere({name:c}).get("label")+": "+l.group).position({of:b.main.$section,my:"center top",at:"center top",collision:"flip flip"})}function i(a){x.update(a)}function k(){x.render()}var l=F(),m=B.state.groupBy.getAttributes(),n=m[0],o=m.length>1,p=(B.state.get("volume"),B.fields),q=B.state.time.get("fromTime"),r=B.state.time.get("time"),s=B.state.get("timeTrendStep"),t=B.source.get("type"),u="";if(B.state.isTimeTrends()){var v=B._controller.fields.findWhere({name:n}).get("timestampGranularity"),w="DAY"===v;q=l.group,r=j(l.group,s,w),u=new b.Components.MetricFormatter(s,v).format(l.group)}var x=new g({state:B.state,fields:p,data:l}),y=null;a.hideDetails||(y=new h({state:B.state,fields:p,data:l,sourceType:t,fromTime:q,toTime:r})),e()}})}function o(){M.push({name:"trend",group:F(),label:"Trend",disabled:function(){return void 0===B.config.attributes.source.date},action:function(){var a=function(a){var c=F(),d=B.state.groupBy.getAttributes(),e=B.state.filters,f={editable:!0,operation:"IN",path:d[0],value:[c.group]},g=e.findWhere({path:d});B.state.groupBy.length>1&&(f=[{editable:!0,operation:"IN",path:d[1],value:[c.group]},{editable:!0,operation:"IN",path:d[0],value:[c.key]}]),a.bootstrap().done(function(){B.setVisualization(a),g?g.hasAttribute(c.group)?g.set(f,{silent:!0}):g.addAttribute(c.group,{silent:!0}):$.isArray(f)?_.each(f,function(a){B.state.filters.add(a,{silent:!0})}):B.state.filters.add(f,{silent:!0})}).fail(function(){var a=new b.Controls.Notification({type:"error"});a.render("Couldn't configure Time Trends visualization.")})};I.visualizations.bootstrap().done(function(){if(B._controller.trends){var b=B._controller.trends(I.visualizations.toJSON());b&&a(I.visualizations.findWhere({visId:b.visId}))}else a(I.visualizations.findWhere({type:"TRENDS"}))})}})}function p(){M.push({name:"filter_all",group:F(),disabled:function(){return b.Utilities.isSingleVizualization()},label:"Filter <br> all",action:function(){var a=F(),b=B.state.config.sourceId,c=B.state.groupBy.getAttributes(),d={editable:!0,operation:"IN",path:a.attr||c[0],value:[a.group]};B.state.groupBy.length>1&&(d=[{editable:!0,operation:"IN",path:c[1],value:[a.group]},{editable:!0,operation:"IN",path:c[0],value:[a.key]}]),i.trigger("visualization:filterAll",b,B.UUID,d,{timestampField:B.state.get("timestampField"),timeTrendStep:B.state.get("timeTrendStep")})}})}function q(){M.push({name:"un_filter_all",group:F(),disabled:function(){return b.Utilities.isSingleVizualization()},label:"Un<br>Filter <br> all",action:function(){var a=F(),b=B.state.config.sourceId,c=B.state.groupBy.getAttributes(),d={editable:!0,operation:"NOTIN",path:c[0],value:[a.group]};B.state.groupBy.length>1&&(d=[{editable:!0,operation:"IN",path:c[1],value:[a.group]},{editable:!0,operation:"IN",path:c[0],value:[a.key]}]),i.trigger("visualization:unfilterAll",b,B.UUID,d)}})}function r(){M.push({name:"filter",group:F(),label:"Filter",action:function(a,b){var c=F(),d=B.state.config.sourceId,e=B.state.groupBy.getAttributes(),f={editable:!0,operation:"IN",path:c.attr||e[0],value:[c.group]};B.state.groupBy.length>1&&(f=[{editable:!0,operation:"IN",path:e[1],value:[c.group]},{editable:!0,operation:"IN",path:e[0],value:[c.key]}]),i.trigger("visualization:filter",d,B.UUID,f,b,{timestampField:B.state.get("timestampField"),timeTrendStep:B.state.get("timeTrendStep")})}})}function s(){M.push({name:"attribute",group:F(),label:"Attribute",action:function(a){var e=F();if(B.state.isTimeTrends()){var f=B.state.get("timeTrendStep"),g=new Date(e.group),h=new Date(b.Utilities.time.getEndTimeWithinStep(g,f)),i=b.Utilities.time.getRoundedDateRange(g,h),j=B.state.config.get("source").dataResolution;if(j&&f===j||"MINUTE"===f)return;return B.state.time.set({time:h.getTime()},{silent:!0}),B.state.set({timeTrendStep:i.step,limit:i.amount+1},{silent:!0}),void B.state.trigger("change")}var k=new b.Controls.PalettePopup({containment:b.main.$section,customClass:"attributePalette",pointerWidth:14}),l=new d({className:"nav nav-tabs nav-stacked",ItemView:c,collection:B.fields,groupBy:"type",filter:function(a){var b=!!a.get("visible"),c="ATTRIBUTE"==a.get("type"),d=["SIDE_BY_SIDE_BARS","HORIZONTAL_SIDE_BY_SIDE_BARS","STACKED_BARS","VERTICAL_100PCT_STACKED_BARS","VERTICAL_STACKED_BARS"],f=B.config.get("type");if(a.get("label")===e?a.set({selected:!0},{silent:!0}):a.set({selected:!1},{silent:!0}),-1!=d.indexOf(f)){var g="";D.hasClass("groupBy1")?g=B._controller.variables["Second Group By"]:D.hasClass("groupBy2")&&(g=B._controller.variables["First Group By"]),a.get("name")===g?a.set({disabled:!0},{silent:!0}):a.set({disabled:!1},{silent:!0})}return b&&c},comparator:function(a){return a.get("label")}});k.render(l.render().el,popoverTitle),k.position({of:a,my:"left+20 top-30",at:"right center",collision:"flipfit flipfit"}),B.listenToOnce(l,"select",function(a){if(!a.get("disabled")){var b=B.config.get("type"),c=B.config.get("templateType"),d=["SIDE_BY_SIDE_BARS","STACKED_BARS"];-1!=d.indexOf(b)||-1!=d.indexOf(c)?(D.hasClass("groupBy1")&&B.state.groupBy.at(0).setAttribute(a.get("name")),D.hasClass("groupBy2")&&B.state.groupBy.at(1).setAttribute(a.get("name"))):B.state.groupBy.setAttribute(a.get("name")),k.remove(),l.remove()}})}})}function t(){M.push({name:"timeScale",group:F(),label:"Time Scale",action:function(a){var c=(F(),new b.Controls.PalettePopup({containment:b.main.$section,customClass:"timeScalePaletteContainer",pointerWidth:14})),d=new f({className:"timeScalePalette",currentItem:F()});c.render(d.render().el,popoverTitle),c.position({of:a,my:"left+20 top-30",at:"right center",collision:"flipfit flipfit"}),B.listenToOnce(d,"select",function(a){var e=[{name:"MINUTE",title:"Minutes",limit:60,time:60},{name:"HOUR",title:"Hours",limit:24,time:3600},{name:"DAY",title:"Days",limit:7,time:86400},{name:"WEEK",title:"Weeks",limit:5,time:604800},{name:"MONTH",title:"Months",limit:12,time:2678400},{name:"YEAR",title:"Years",limit:4,time:31536e3}],f=e.filter(function(b){return a.toUpperCase()===b.name})[0],g=this._controller.state.get("timeTrendStep"),h=this._controller.state.get("limit"),i=new Date(this._controller.state.time.get("min")),j=new Date(this._controller.state.time.get("max")),k={MINUTE:b.Utilities.time.getRoundedDateRange(i,j,"MINUTE"),HOUR:b.Utilities.time.getRoundedDateRange(i,j,"HOUR"),DAY:b.Utilities.time.getRoundedDateRange(i,j,"DAY"),WEEK:b.Utilities.time.getRoundedDateRange(i,j,"WEEK"),MONTH:b.Utilities.time.getRoundedDateRange(i,j,"MONTH"),YEAR:b.Utilities.time.getRoundedDateRange(i,j,"YEAR")},l=k[f.name].amount+1;f.limit=b.Utilities.time.recalculateLimit(g,h,f.name),f.limit=f.limit>l?l:f.limit,this._controller.state.set({timeTrendStep:f.name,limit:f.limit},{silent:!0}),this._controller.state.trigger("change"),c.remove(),d.remove()})}})}function u(){M.push({name:"metric",group:F().label,label:"Metric",action:function(a,c){var d=(F(),new b.Controls.PalettePopup({autohide:!1,containment:b.main.$section,customClass:"metricPalette",pointerWidth:14})),f=new e({collection:B.visualizationController.fields,currentItem:$.extend({},B.field.toJSON(),B.metric.toJSON())});B.childViews.push(d),B.childViews.push(f),d.render(f.render().el,B.options.popoverTitle).position({of:c,my:"left+5 center",at:"center center",collision:"flipfit flipfit"}),d.onHide=function(){f.trigger("hide"),B.childViews.splice(B.childViews.indexOf(d),1),B.childViews.splice(B.childViews.indexOf(f),1)},B.listenTo(f,"select:metric",function(a){B.state.metrics.at(0).set(a)})}})}function v(){M.push({name:"radius",group:F().label,label:"Radius",action:function(a,c){var d=F(),f=new b.Controls.PalettePopup({containment:b.main.$section,customClass:"metricPalette",pointerWidth:14}),g=new e({collection:B.fields,currentItem:d});f.render(g.render().el,popoverTitle),f.position({of:c,my:"left top-30",at:"center center",collision:"flipfit flipfit"}),f.onHide=function(){g.trigger("hide")},B.listenTo(g,"select:metric",function(a){B.state.config.get("source").variables["_metric-radius"]=a.name+":"+a.func,B.state.trigger("change")})}})}function w(){M.push({name:"zoom",group:F(),label:"Zoom",action:function(a,e){function f(a){var b=B.state.groupBy.getAttributes(),c=[{editable:!0,operation:"IN",path:b[1],value:[g.group]},{editable:!0,operation:"IN",path:b[0],value:[g.key]}];I.visualizations.bootstrap().done(function(){var b=I.visualizations.findWhere({type:"VERTICAL_BARS"});b.bootstrap().done(function(){b.get("source").variables.Comparison="Off",B.setVisualization(b),B.state.groupBy.setAttribute(a.get("name"),{silent:!0}),_.each(c,function(a){B.state.filters.add(a,{silent:!0})})})})}var g=F(),h=B.state.groupBy.getAttributes(),i=h[0],j=h.length>1;if(B.state.isTimeTrends()){var k=B.state.get("timeTrendStep"),l=new Date(g.group),m=new Date(b.Utilities.time.getEndTimeWithinStep(l,k)),n=b.Utilities.time.getRoundedDateRange(l,m),o=B.state.config.get("source").dataResolution;if(o&&k===o||"MINUTE"===k)return;return B.state.time.set({time:m.getTime()},{silent:!0}),B.state.set({timeTrendStep:n.step,limit:n.amount+1},{silent:!0}),void B.state.trigger("change")}var p={editable:!0,operation:"IN",path:i,value:[g.group]},q=new b.Controls.PalettePopup({containment:b.main.$section,customClass:"attributePalette"}),r=new d({className:"nav nav-tabs nav-stacked",ItemView:c,itemOption:{checkbox:!1},collection:B.fields,groupBy:"type",filter:function(a){var b=!!a.get("visible"),c="ATTRIBUTE"==a.get("type"),d=a.get("name")==i;return b&&c&&!d},comparator:function(a){return a.get("label")}});q.render(r.render().el,"Zoom Into"),q.position({of:e,my:"left+20 top-30",at:"center center",collision:"flipfit flipfit"}),B.listenToOnce(r,"select",function(a){j?f(a):(B.state.addFilter(p,{silent:!0,trigger:!1}),B.state.groupBy.setAttribute(a.get("name"))),q.remove(),r.remove(),b.eventDispatcher.trigger("zoomItem:select")})}})}function x(){M.push({name:"search_details",group:F(),label:"Details",action:function(a,c){function d(){var a=new b.Controls.InfoPopup({containment:b.main.$section,customClass:"searchResultsDetails"}),d=null,f=B.fields,g={};f.each(function(a){g[a.get("name")]=a.get("label")});var h=b.MVC.View.extend({itemTemplate:"<tr>\n                                    <td><%= name %></td>\n                                    <td><%= value %></td>\n                                </tr>",tagName:"table",initialize:function(a){b.MVC.View.prototype.initialize.call(this,a),_.bindAll(this,"render"),this.data=a.data||{},this.query=a.query||""},preg_quote:function(a){return(a+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")},highlightMatchedWords:function(a){var b=a;return"string"==typeof b&&this.query&&""!==this.query&&(b=a.replace(new RegExp("("+this.preg_quote(this.query).replace(" ","|")+")","gi"),"<span class='selected-result'>$1</span>")),b},render:function(){var a="";for(var b in this.data)if(this.data.hasOwnProperty(b)){var c=g[b],d=this.highlightMatchedWords(this.data[b]);a+=_.template(this.itemTemplate,{name:c,value:d})}return this.$el.html(a),this}}),i=new h({data:e.metadata,query:e.query});a.setActions(d).render(i.render().el,"Search Result Detail").position({of:c,my:"left top-30",at:"center center",collision:"flipfit flipfit"}),a.onHide=function(){i.remove()}}var e=F();d()}})}function y(){M.push({name:"exclude",group:F(),label:"Exclude",type:"icon",action:function(){var a=F(),b=B.config.get("type"),c=B.state.groupBy.getAttributes(),d=Array.isArray(c)?c[0]:c,e=a.group;"STACKED_BARS"===b?e=a.key:"SIDE_BY_SIDE_BARS"===b&&(d=Array.isArray(c)?c[1]:c);var f={editable:!0,operation:"NOTIN",path:d,value:[e]},g=B.state.filters.findWhere({path:d,operation:"NOTIN"});if(g){var h=g.get("value");if(-1!==h.indexOf(e))return;f.value=h.concat([e])}B.state.addFilter(f)}})}function z(a){N={scope:a,over:function(){},drop:function(a){var c=$(D),d=c.attr("data-zd-interactive-type"),e=F();if(d)switch(d){case"group":case"multi-group":case"attribute":"ATTRIBUTE"==a.get("type")&&null!==B.fields.findWhere({name:a.get("name")})&&B.state.groupBy.setAttribute(a.get("name"));break;case"metric":if(b.Utilities.isNumericAttributeType(a.get("type"))&&null!==B.fields.findWhere({name:a.get("name")})){var f=new b.Components.Metric({name:a.get("name"),func:a.get("func")?a.get("func").toLowerCase():"avg",type:a.get("type"),label:a.get("label")});B.state.set("volume",f)}}else if("ATTRIBUTE"==a.get("type")&&null!==B.fields.findWhere({name:a.get("name")})){if("TRENDS"===B.config.get("type"))return void b.eventDispatcher.trigger("TimeTrendsZoomIn",e.group);var g=B.state.groupBy.getAttribute(),h={editable:!0,operation:"IN",path:g,value:[e.group]};B.state.addFilter(h,{silent:!0}),B.state.groupBy.setAttribute(a.get("name"))}},out:function(){}}}function A(){N={scope:"objectField",over:function(){},drop:function(b){a.droppable.drop(b)},out:function(){}}}var B=this,C=this.thread,D=a.input||this.element,E=a.role,F=a.getter,G=a.menuConfig,H=this.config.get("source"),I=this.source,J="undefined"!==H.date,K=this.state.isTimeTrends(),L=[],M=[],N=null,O={Filter:r,"Filter All":p,"Unfilter All":q,Info:n,Zoom:w,Trend:o,Exclude:y};return G?k():l(),{actions:M,dropActions:L,droppable:N}},this.registerInteractiveElements=function(a,b,c){"object"==typeof b?c=b:$(a).attr("data-zd-interactive-type",b);var d=this,e=(this.thread,c.data),f=c.menu,g=null,h=c.tooltip||null,i=c.events?c.events.join(" "):null;g=this.assemblyInteractiveElementActions({input:a,getter:e,role:b,menuConfig:f}),d.elementsManager.register(a,{events:i,actions:g.actions,dropActions:g.dropActions,droppable:g.droppable,tooltip:h,data:e})},this.releaseInteractiveElement=function(a,b){return this.isRemote?null:void this.elementsManager.release(a,b)}}}(window,Zoomdata),function(a,b){function c(){return!1}function d(a,b){var c=this,d=this._manager,e=this.options.droppable=$.extend({},this.defaults.droppable,a);return e.over=function(){var b=d.getElementInAction("drag");c.showTooltip(),b&&e.scope&&e.scope==b.options.draggable.scope&&(console.log("hover options",e.scope),$(this).css({opacity:.7}),"function"==typeof a.over?a.over.apply(this,b.$el.data(e.scope)):null)},e.drop=function(c){var f=d.getElementInAction("drag");if(f&&e.scope&&e.scope==f.options.draggable.scope)if($(this).css({opacity:1}),"drop"===b){var g={left:c.pageX||c.originalEvent.pageX,top:c.pageY||c.originalEvent.pageY};this.showActionsList(g)}else"function"==typeof a.drop?a.drop.apply(this,[f.$el.data(e.scope)]):null},e.out=function(){var b=d.getElementInAction("drag");b&&e.scope&&e.scope==b.options.draggable.scope&&($(this).css({opacity:1}),"function"==typeof a.out?a.out.apply(this,b.$el.data(e.scope)):null)},this.$el.droppable(e),this.$el.data("droppable")}function e(){this.droppable?this.droppable.destroy():null}function f(a,b){var d=this,e=this._manager,f=this.options.droppable=$.extend({},this.defaults.droppable,a);this.$el.off("mouseenter"),this.$el.off("mouseup"),this.$el.off("mouseleave"),this.tooltip&&(this.$el.off("mousemove"),this.$el.on("mousemove",function(a,b){d.tooltip&&d.moveTooltip(a,b)})),this.$el.on("mouseenter",function(b,c){var g=e.getElementInAction("drag");if(d.showTooltip(b,c),g&&f.scope&&f.scope==g.options.draggable.scope){var h=this.getAttribute("data-zd-interactive-type");"attribute"===h||"metric"===h?$(this).addClass("over"):$(this).css({opacity:.7}),"function"==typeof a.over?a.over.apply(this,g.$el.data(f.scope)):null}}),this.$el.on("mouseup",function(g){var h=e.getElementInAction("drag");if(h&&f.scope&&f.scope==h.options.draggable.scope){var i=this.getAttribute("data-zd-interactive-type");"attribute"===i||"metric"===i?$(this).removeClass("over"):$(this).css({opacity:1}),h.$el.draggable("option","revert",c);var j=h.$el.data(f.scope);if(-1!==b.indexOf("drop")){var k={left:g.pageX||g.originalEvent.pageX,top:g.pageY||g.originalEvent.pageY};setTimeout(function(){d.showActionsList(k,j)},10)}else"function"==typeof a.drop?a.drop.apply(this,[j]):null}}),this.$el.on("mouseleave",function(){var b=e.getElementInAction("drag");if(d.hideTooltip(),b&&f.scope&&f.scope==b.options.draggable.scope){var c=this.getAttribute("data-zd-interactive-type");"attribute"===c||"metric"===c?$(this).removeClass("over"):$(this).css({opacity:1}),"function"==typeof a.out?a.out.apply(this,b.$el.data(f.scope)):null}})}function g(){}function h(){var a;return a=-1!=navigator.appVersion.indexOf("MSIE 10.")?b.Utilities.detectTouchDevice()?"MSPointerDown click":"MSPointerUp click":"click"}b.eventDispatcher;b.Components=b.Components||{},b.Components.InteractiveElementController=function(a,b,c){var d="function"==typeof c.data,e=!!c.actions,h=!!c.events,i=!!c.tooltip,j=!!c.draggable,k=!!c.droppable;if(_.bindAll(this,"_onInteractionStart","_onInteraction","_onInteractionEnd","_getData","_getTooltipColor"),"undefined"!=typeof $(b).data("interactiveElement")&&null!==$(b).data("interactiveElement"))throw new Error("An element already is an instance of interactiveElement");this._manager=a,this.element=b,this.$el=$(this.element),this.gestureTimeOut=null,this.isSVG()&&(this._createDroppable=f,this._destroyDroppable=g),c.actionList&&(this.actionList=c.actionList,delete c.actionList),this.options={},this.options.interactions=$.extend({},this.defaults.interactions,c.interactions),this.data=d?c.data:null,e?this.options.actions=c.actions:null,h?this.options.interactions.action=c.events:null,i?this.tooltip=c.tooltip:null,i&&c.tooltip.originalConfig&&(this.tooltipOriginalConfig=c.tooltip.originalConfig),this.droppable=k?this._createDroppable(c.droppable,this.options.interactions.action):null,this.draggable=j?this._createDraggable(c.draggable):null,this._allowed=[],this._prevented=[],this._allow(this.options.interactions.start),this._allow(this.options.interactions.action),this._allow(this.options.interactions.end),this.$el.data("interactiveElement",this)},b.Components.InteractiveElementController.prototype={defaults:{interactions:{start:"mousedown",action:h(),end:"mouseup"},draggable:{containment:"body",appendTo:"body",helper:"clone",revert:"invalid",addClasses:!1,dragClass:"zd-interactive-draggable",cursor:"pointer",cursorAt:{left:25,top:25},zIndex:2e3,scope:"default"},droppable:{addClasses:!1,tolerance:"pointer",activeClass:"zd-interactive-droppable-accepts",scope:"default"}},get:function(){var a=[];if(0==arguments.length)a=this.options;else if(1==arguments.length)a=this.options[arguments[0]]||null;else for(var b=0;b<arguments.length;b++)a[arguments[b]]=this.options[arguments[b]]||null;return a},set:function(a){this.data=a.data||this.data,a.tooltip&&a.tooltip.originalConfig&&(this.tooltipOriginalConfig=a.tooltip.originalConfig)},_getData:function(){return this.data},_getTooltipColor:function(){return this.tooltipOriginalConfig&&this.tooltipOriginalConfig.color?this.tooltipOriginalConfig.color:!1},showTooltip:function(a){this.tooltip&&this.tooltip.show({event:a,getter:this._getData,color:this._getTooltipColor})},moveTooltip:function(a){this.tooltip&&this.tooltip.move({at:{top:a.clientY,left:a.clientX},event:a})},hideTooltip:function(){this.tooltip&&this.tooltip.hide()},showActionsList:function(a,b){var c=this;return null!==this.gestureTimeOut?this:("undefined"!=typeof this.actionList&&(a=a||{},a.left="number"!=typeof a.left?this.$el.offset().left+this.$el.width()/2:a.left,a.top="number"!=typeof a.top?this.$el.offset().top+this.$el.height()/2:a.top,-1!=navigator.appVersion.indexOf("MSIE 10.")?(setTimeout(function(){c.actionList.close()},100),setTimeout(function(){c.actionList.reset(b?c.options.dropActions:c.options.actions)},200),setTimeout(function(){c.actionList.render(a)},300),this.gestureTimeOut=setTimeout(function(){c.gestureTimeOut=null},600)):this.actionList.close().reset(b?this.options.dropActions:this.options.actions).render(a)),this)},isSVG:function(){return!("svg"!=this.element.tagName&&null===this.element.ownerSVGElement)},_notify:function(a,b){this._manager._notify(a,this,b)},_createDroppable:d,_destroyDroppable:e,_createDraggable:function(a){var b=this,c=this.options.draggable=$.extend({},this.defaults.draggable,a);return c.start=function(d,e){var f=e.helper;b._dragHelper=f,b._notify("drag:start"),f.css("pointer-events","none"),f.hasClass(c.dragClass)?null:f.addClass(c.dragClass),"function"==typeof a.start?a.start.apply(this,arguments):null},c.drag=function(){"function"==typeof a.drag?a.drag.apply(this,arguments):null},c.stop=function(d,e){var f=e.helper;b._notify("drag:stop"),b.$el.draggable("option","revert",c.revert),f.css("pointer-events","all"),f.hasClass(c.dragClass)?f.removeClass(c.dragClass):null,"function"==typeof a.stop?a.stop.apply(this,arguments):null},this.$el.on("touchend",function(a){var b=document.elementFromPoint(a.originalEvent.changedTouches[0].pageX,a.originalEvent.changedTouches[0].pageY);$(b).trigger("mouseup")}),this.$el.draggable(c),this.$el.data("draggable")},_destroyDraggable:function(){this.draggable?this.draggable.destroy():null,this._dragHelper instanceof jQuery?this._dragHelper.remove():null},_isAllowed:function(a){return-1!==this._allowed.indexOf(a)},_allow:function(a){function b(){f.$el.on(e.start,f._onInteractionStart)}function c(){f.$el.on(e.action,f._onInteraction)}function d(){f.$el.on(e.end,f._onInteractionEnd)}var e=this.options.interactions,f=this;if(!this._isAllowed(a))switch(this._allowed.push(a),a){case e.start:b();break;case e.action:c();break;case e.end:d()}},_restrict:function(a){function b(){f.$el.off(e.start,f._onInteractionStart)}function c(){f.$el.off(e.action,f._onInteraction)}function d(){f.$el.off(e.end,f._onInteractionEnd)}var e=this.options.interactions,f=this;if(this._isAllowed(a))switch(this._allowed.splice(this._allowed.indexOf(a),1),a){case e.start:b();break;case e.action:c();break;case e.end:d()}},_isPrevented:function(a){return-1!==this._prevented.indexOf(a)},_prevent:function(a){var b=this.options.interactions;if(!this._isPrevented(a))switch(this._prevented.push(a),a){case b.start:this.$el.on(b.start,c);break;case b.action:this.$el.on(b.action,c);break;case b.end:this.$el.on(b.end,c)}},_release:function(a){var b=this.options.interactions;if(this._isPrevented(a))switch(this._prevented.splice(this._allowed.indexOf(a),1),a){case b.start:this.$el.off(b.start,c);break;case b.action:this.$el.off(b.action,c);break;case b.end:this.$el.off(b.end,c)}},_onInteractionStart:function(){this.options,this.options.interactions;return this._notify("interaction:start"),null},_onInteraction:function(a){if($(a.target).hasClass("prevent-click-element")||$(a.target).closest(".prevent-click").get(0))return null;var b,c=this.options;if(this._notify("interaction"),c.actions&&c.actions.length){if(1!==c.actions.length)return b=d3.select(this.element).data()[0]||{},this.showActionsList({left:a.pageX||a.originalEvent.pageX,top:a.pageY||a.originalEvent.pageY,group:b.group}),!1;c.actions[0].action($(a.target),a)}return null},_onInteractionEnd:function(){return this._notify("interaction:stop"),null},destroy:function(){var a=this.options.interactions;this._destroyDroppable(),this._destroyDraggable(),this._restrict(a.action),this._restrict(a.start),this._restrict(a.end),this.$el.data("interactiveElement",null)}}}(window,Zoomdata),function(a,b){var c=b.Components.InteractiveElementController,d=_.clone(b.MVC.Events);b.Components=b.Components||{},b.Components.InteractiveElementsManager=function(a){a||(a={}),a.actionList&&(this.actionList=a.actionList,delete a.actionList),this.options=$.extend({},this.defaults,a),this.elements=[],this._interactions={}},b.Components.InteractiveElementsManager.prototype=_.extend({defaults:{},register:function(a,b){function c(a,b){b.actionList=d.actionList,d.registered(a)?d.updateElement(a,b):d._addToRegistry(a,b)}var d=this;a instanceof Array?_.each(a,function(a){c(a,b)}):c(a,b)},release:function(a,b){function c(a){var b=d.getInteractiveElementFor(a);b?d._removeFromRegistry(b):null}var d=this;a instanceof Array?_.each(a,function(a){c(a,b)}):c(a,b)},getInteractiveElementFor:function(a){return _.find(this.elements,function(b){return b.element==a})},registered:function(a){return!!this.getInteractiveElementFor(a)},updateElement:function(a,b){var c=this.getInteractiveElementFor(a);c&&c.set(b)},inProgress:function(a){return!!this._interactions[a]},getElementInAction:function(a){var b;
return b=this.inProgress(a)?this._interactions[a]:null},_notify:function(a,b,c){c||(c={});var d=a.split(":")[0],e=a.split(":")[1]||"action";switch(e){case"start":this.inProgress(d)?this._stop(d,c):null,this._start(d,b,c);break;case"stop":this._stop(d,c);break;case"action":this._trigger(d,b,c)}},_start:function(a,b){this._interactions[a]=b},_stop:function(a){delete this._interactions[a]},_trigger:function(a,b,c){var d=!!c.silent;d||this.trigger(a,b)},_removeFromRegistry:function(a){var b=this;_.each(_.keys(this._interactions),function(c){a==b.getElementInAction(c)?b._stop(c):null}),a.destroy(),this.elements.splice(this.elements.indexOf(a),1)},_addToRegistry:function(a,b){this.elements.push(new c(this,a,b))},destroy:function(){for(;this.elements.length>0;)this._removeFromRegistry(this.elements[0])}},d)}(window,Zoomdata),function(a,b){b.Components=b.Components||{};var c=b.eventDispatcher,d=b.Components.Thread=function(a){if(a=a||{},_.bindAll(this,"_onStreamError","_onViewport","_onMessage","_onTimeLine","_onStartFromTimeDone","_onStartVisDone","_onNoDataFound","_onDirtyData","_onNotDirtyData"),!a.dataStream)throw new Error("dataStream must be defined");this.dataStream=a.dataStream,this.tuneTo(a),this._progress=0,this.status("idle"),this.onStreamError=$.noop,this.onMessage=$.noop,this.onTimeLine=$.noop,this.onStartFromTimeDone=$.noop,this.onStartVisDone=$.noop,this.onNoDataFound=$.noop,this.onPauseDone=$.noop,this.onSpeedUpdatedDone=$.noop,this.onDirtyData=$.noop,this.onNotDirtyData=$.noop,this.onPagination=$.noop,this.onPivotPaging=$.noop,this.onViewport=$.noop,this.onExeption=$.noop,this.listenTo(c,"stream:error",this._onStreamError),this.listenTo(c,"stream:message",this._onMessage),this.listenTo(c,"stream:TIME_LINE",this._onTimeLine),this.listenTo(c,"stream:START_FROM_TIME_DONE",this._onStartFromTimeDone),this.listenTo(c,"stream:START_VIS_DONE",this._onStartVisDone),this.listenTo(c,"stream:STOP_VIS_DONE",this._onStopVisDone),this.listenTo(c,"stream:NO_DATA_FOUND",this._onNoDataFound),this.listenTo(c,"stream:PAUSE_DONE",this._onPauseDone),this.listenTo(c,"stream:UPDATE_SPEED_DONE",this._onSpeedUpdatedDone),this.listenTo(c,"stream:DIRTY_DATA",this._onDirtyData),this.listenTo(c,"stream:NOT_DIRTY_DATA",this._onNotDirtyData),this.listenTo(c,"stream:PAGINATION",this._onPagination),this.listenTo(c,"stream:PAGING",this._onPivotPaging),this.listenTo(c,"stream:VIEWPORT",this._onViewport),this.listenTo(c,"stream:EXCEPTION",this._onExeption)};_.extend(d.prototype,b.MVC.Events,{tuneTo:function(a){if(this.stopListening(this.time),a.state)this.state=a.state,this.time=this.state.time;else{if(!a.config)throw new Error("state or config must be defined");this.state=new b.Models.State({streamSourceId:config.source.sourceId},{config:new b.MVC.Model(config)}),this.time=this.state.time}this.state.config.options={},this.listenTo(this.time,"change:time",this._onTimeChange),this.listenTo(this.time,"change:speed",this._onSpeedChange),this.listenTo(this.time,"change:paused",this._onPausedChange)},resetProgress:function(){this.progress(0)},progress:function(a){function b(a){return d._progress=a,d}function c(){return d._progress}var d=this;return"undefined"==typeof a?c():b(a)},destroy:function(){this.stop(),this.stopListening()},setUUID:function(){return this.UUID=b.Utilities.generateUUID(),this.UUID},getUUID:function(){return this.UUID},status:function(a){return"string"==typeof a?(this._status=a,this.trigger("status:change",a,this),this):this._status},start:function(a){var c=this.state.toRequest(a),d=JSON.stringify({type:"START_VIS",cid:this.UUID,request:c});"idle"!==this.status()?this.stop():null,console.log("Thread: start ",JSON.parse(d)),this.dataStream.send(d),this.resetProgress(),this.status("start"),this.trigger("thread:start",JSON.parse(d)),b.eventDispatcher.trigger("thread:start",JSON.parse(d))},stop:function(){var a=JSON.stringify({type:"STOP_VIS",cid:this.UUID});this.dataStream.send(a),this.resetProgress(),this.trigger("thread:stop",JSON.parse(a)),console.log("Thread: stop",JSON.parse(a)),this.status("idle")},pause:function(){var a=JSON.stringify({type:"PAUSE",cid:this.UUID});this.dataStream.send(a),console.log("Thread: pause",JSON.parse(a)),this.switchOffLiveMode()},unpause:function(){var a=JSON.stringify({type:"UNPAUSE",cid:this.UUID});this.dataStream.send(a),console.log("Thread: unpause",JSON.parse(a))},request_data:function(a){var a=a||{records:1e3},b=JSON.stringify({type:"REQUEST_DATA",cid:this.UUID,request:a});this.dataStream.send(b),console.log("Thread: request_data",JSON.parse(b))},togglePause:function(){var a=this.time.get("paused");a?this.unpause():this.pause()},switchOffLiveMode:function(){this.time.get("live")&&(this.time.set("live",!1),b.eventDispatcher.trigger("live:mode",{on:!1}))},switchOnLiveMode:function(){this.time.get("live")||(this.time.set("live",!0),b.eventDispatcher.trigger("live:mode",{on:!0,label:"LIVE"}))},startFromTime:function(a){var c,d,e=(new Date).getTime(),f=this.time;a>e&&"LIVE"===this.config.get("source").startFrom&&(a=null),c={speed:f.get("speed"),time:a,pauseAfterRead:f.get("paused")},d={type:"START_FROM_TIME",cid:this.UUID,request:c},console.log("Thread: startFromTime",d),this.dataStream.send(JSON.stringify(d)),this.resetProgress(),this.trigger("thread:time",d),b.eventDispatcher.trigger("thread:time",d)},startFromTimeTo:function(a){var b=(new Date).getTime(),c=this.time,d={},e=c.get("time");a>b&&(a=null),d={speed:c.get("speed"),timeWindow:a,pauseAfterRead:c.get("paused")},e&&null!==e&&(d.time=e);var f={type:"START_FROM_TIME",cid:this.UUID,request:d};this.dataStream.send(JSON.stringify(f)),this.resetProgress()},updateSpeed:function(a){var b=JSON.stringify({type:"UPDATE_SPEED",cid:this.UUID,request:{speed:a|this.time.get("speed")}});this.dataStream.send(b),console.log("Thread: updateSpeed",b)},_onTimeChange:function(a,b){this.startFromTime(b)},_onSpeedChange:function(a,b){this.updateSpeed(b)},_onPausedChange:function(a,b){b?this.pause():this.unpause()},_onStreamError:function(a){var b=JSON.parse(a.data);b.cid==this.UUID&&(this.status("error"),"function"==typeof this.onStreamError?this.onStreamError(b.data):null,this.trigger("thread:error",a))},_onDirtyData:function(a){var b=JSON.parse(a.data);b.cid==this.UUID&&(this.status("dirtydata"),"function"==typeof this.onDirtyData?this.onDirtyData(b.data):null,"number"==typeof b.progress?this.progress(b.progress):this.resetProgress(),this.trigger("thread:dirtyData",b))},_onNotDirtyData:function(a){var b=JSON.parse(a.data);b.cid==this.UUID&&(this.status("running"),"function"==typeof this.onNotDirtyData?this.onNotDirtyData(b.data):null,this.progress(100),this.trigger("thread:notDirtyData",b))},_onMessage:function(a){var b=JSON.parse(a.data);b.cid==this.UUID&&(this.status("progress"),"function"==typeof this.onMessage?this.onMessage(b.data):null,this.trigger("thread:message",b.data))},_onTimeLine:function(a){var b=JSON.parse(a.data);if(b.cid==this.UUID){if("HISTORICAL"===b.source)return void this.time.set({historicalFrom:b.fromTime,historicalTo:b.toTime});this.stopListening(this.time,"change:time",this._onTimeChange);var c={fromTime:b.fromTime,time:b.toTime,min:b.minTime&&"-1"!==b.minTime?b.minTime:void 0,max:b.maxTime&&"-1"!==b.maxTime?b.maxTime:void 0,live:b.live,speed:b.speed};this.time.set(c),this.listenTo(this.time,"change:time",this._onTimeChange),this.status("progress"),"function"==typeof this.onTimeLine?this.onTimeLine(b.data):null,this.trigger("thread:timeline",b.data)}},_onStartFromTimeDone:function(a){var b=JSON.parse(a.data);b.cid==this.UUID&&(this.status("progress"),"function"==typeof this.onStartFromTimeDone?this.onStartFromTimeDone(b.data):null,this.trigger("thread:startFromTimeDone",b.data))},_onStartVisDone:function(a){var b=JSON.parse(a.data);b.cid==this.UUID&&(this.status("progress"),"function"==typeof this.onStartVisDone?this.onStartVisDone(b.data):null,this.trigger("thread:startVisDone",b.data))},_onStopVisDone:function(a){var b=JSON.parse(a.data);b.cid==this.UUID&&("function"==typeof this.onStopVisDone?this.onStopVisDone(b.data):null,this.trigger("thread:stopVisDone",b.data))},_onNoDataFound:function(a){var b=JSON.parse(a.data);b.cid==this.UUID&&(this.status("nodata"),"function"==typeof this.onNoDataFound?this.onNoDataFound(b.data):null,this.trigger("thread:noData",b.data))},_onPauseDone:function(a){var c=JSON.parse(a.data);c.cid==this.UUID&&(this.time.set("paused",!0),"function"==typeof this.onPauseDone?this.onPauseDone(c):null,this.trigger("thread:pauseDone",c),b.eventDispatcher.trigger("thread:pauseDone",c))},_onSpeedUpdatedDone:function(a){var b=JSON.parse(a.data);b.cid==this.UUID&&("function"==typeof this.onSpeedUpdatedDone?this.onSpeedUpdatedDone(b.data):null,this.trigger("thread:updateSpeedDone",b.data))},_onPagination:function(a){var b=JSON.parse(a.data);b.cid===this.UUID&&(this.state.set("nextPageAvailable",b.nextPageAvailable,{silent:!0}),this.state.set("pages",b.pages,{silent:!0}),this.state.set("precise",b.precise,{silent:!0}),this.state.trigger("pages"),"function"==typeof this.onPagination?this.onPagination(b):null,this.trigger("thread:pagination",b))},_onPivotPaging:function(a){var b=JSON.parse(a.data);b.cid===this.UUID&&(this.state.pagesCount=b.pagesCount,this.state.precise=b.precise,this.state.set("pageIndex",b.pageIndex,{silent:!0}),"function"==typeof this.onPivotPaging?this.onPivotPaging(b):null,this.trigger("thread:pivotPaging",b))},_onViewport:function(a){var b=JSON.parse(a.data);b.cid===this.UUID&&("function"==typeof this.onViewport?this.onViewport(b):null,this.trigger("thread:viewport",b))},_onExeption:function(a){var b=JSON.parse(a.data);this.trigger("thread:exeption",b)}})}(window,Zoomdata),function(a,b){var c=_.clone(b.MVC.Events),d=["TRENDS","MULTI_METRIC_TREND"],e="PIVOT_TABLE";b.Components=b.Components||{},b.Components.StateInheritanceManager=function(a){if(a||(a={}),this.options=$.extend({},this.defaults,a),!this.options.controller)throw new Error("Controller must be defined");this.controller=this.options.controller,delete this.options.controller,this.history=[],this.addToHistory(this.controller.state,this.controller.config)},b.Components.StateInheritanceManager.prototype=_.extend({defaults:{},merge:function(a){var b=this.controller.config,c=(this.controller.state,a.oldConfig),d=a.oldState;return this.addToHistory(d,c),this.mergeTime(d,c),this.mergeFilters(d,c),this.isType(b,e)?(this.mergeToPivot(d,c),this):this.isType(c,e)?(this.mergeFromPivot(d,c),this):(this.mergeMetrics(d,c),this.mergeGroupBy(d,c),this.mergeClientSort(d),this)},mergeFilters:function(a){var b=(this.controller.config,this.controller.state);return a.filters.length>0&&b.filters.set(a.filters.toJSON(),{silent:!0}),this},mergeToPivot:function(a,b){var c,e,f,g=this.controller.config,h=this.controller.state,i="Columns"===g.attributes.source.variables["Metric Direction"],j={};i?(c="Column Attributes",e="Row Attributes"):(c="Row Attributes",e="Column Attributes"),f=a.metrics.toJSON().filter(function(a){var b=a.name,c=a.func,d=b+c,e=!1;return"none"===b&&(e=!0),j[d]===!0&&(e=!0),e?!1:(j[d]=!0,!0)}).map(function(a,b){return{name:a.name,func:a.func,label:"Metrics",id:"Metrics-"+b}}),h.metrics.reset(f,{silent:!0});var k=this.getOriginalType(b);return _.contains(d,k)||0===a.groupBy.length?this:(a.groupBy.length>0&&(g.attributes.source.variables[e]=[a.groupBy.getAttribute()],g.attributes.source.variables[c]=a.groupBy.getAttributes().slice(1)),this)},mergeFromPivot:function(a,c){var d,e,f=(this.controller.config,this.controller.state,"Columns"===c.attributes.source.variables["Metric Direction"]);f?(d="Column Attributes",e="Row Attributes"):(d="Row Attributes",e="Column Attributes"),this.mergeMetrics(a,c);var g=new b.Collections.GroupBy(c.attributes.source.variables[e].concat(c.attributes.source.variables[d]).map(function(a){return{name:a}}));this.mergeGroupBy(a,c,g)},mergeTime:function(a,b){var c=this.controller.config,e=this.controller.state,f=this.getOriginalType(b),g=this.getOriginalType(c);return f!==g&&(_.contains(d,g)||_.contains(d,f))?this:(e.time&&a.time&&e.time.get("timeWindow")===a.time.get("timeWindow")&&e.time.set(a.time.toJSON(),{silent:!0}),this)},mergeClientSort:function(a){var b=this.controller.state;return b.set({clientSort:a.get("clientSort")},{silent:!0}),this},mergeGroupBy:function(a,b,c){var e=this.controller.config,f=this.controller.state;c&&(a.groupBy=c);var g=a.groupBy.models,h=f.groupBy.models,i=a.groupBy.toJSON(),j=f.groupBy.toJSON(),k=this.getOriginalType(b),l=this.getOriginalType(e);if(k!==l&&(_.contains(d,l)||_.contains(d,k)))return this;if(j.length>i.length){var m=a.groupBy.getAttributes(),n=f.groupBy.getAttributes(),o=(j.slice(i.length),n.slice(i.length)),p=_.difference(n,m);i.forEach(function(a,b){var c=h[b];c.setAttribute(a.name,{silent:!0}),c.setSort(a.sort,{silent:!0})});var q=0;_.intersection(o,m).length>0&&o.forEach(function(a,b){var c=b+i.length;if(_.contains(m,a)){var d=h[c],e=_.findWhere(j,{name:p[q]});e&&(d.setAttribute(e.name,{silent:!0}),d.setSort(e.sort,{silent:!0})),q++}})}else h.forEach(function(a,b){var c=g[b];if(c){var d=c.toJSON();a.setAttribute(d.name,{silent:!0}),a.setSort(d.sort,{silent:!0})}});return this},mergeMetrics:function(a){function b(a,b){var c=[];return c=b?a.metrics.models.filter(function(a){return a.get("label")!==b.name}):a.metrics.models}function c(a){return _.findWhere(a.config.attributes.variables,{metricType:"color"})}var d=this.controller.state;if(0!==d.metrics.length&&0!==a.metrics.length){var e=c(d),f=c(a),g=b(d,e),h=b(a,f);if(g.forEach(function(a,b){var c,d,e=h[b];e&&(c=e.get("name"),d="count"===c?null:e.get("func"),"none"!==c&&a.set({name:c,func:d},{silent:!0}))}),e&&f){var i=d.metrics.findWhere({id:e.name}),j=a.metrics.findWhere({id:f.name}),k=j.get("name"),l="count"===k?null:j.get("func");"none"!==k&&i.set({name:k,func:l},{silent:!0})}return this}},addToHistory:function(a,b){return this.history.push({state:a,config:b}),this},getPrev:function(){var a=this.history.pop();return a},getOriginalType:function(a){var b=a.get("type");return b="CUSTOM"===b?a.get("templateType"):b},isType:function(a,b){var c=Array.isArray(b)?b:[b],d=!1,e=this.getOriginalType(a);return _.contains(c,e)&&(d=!0),d}},c)}(window,Zoomdata),function(a,b){"use strict";b.Components=b.Components||{},b.Components.DashboardEvents=_.clone(b.MVC.Events)}(window,Zoomdata),function(a,b){"use strict";b.Components=b.Components||{};var c=b.Collections.ComponentSources,d=b.Collections.LibrariesSources,e=b.Views.AxisLabel,f=b.Views.ColorKey,g=b.eventDispatcher,h=b.Components.Thread,i=b.Components.InteractiveElementsMethods,j=b.Components.MetricAccessor,k=b.Components.StateInheritanceManager,l="$Source";b.Components.VisualizationController=b.MVC.View.extend({defaults:{},remove:function(){this.stopVisualization(),this.removeVisualization(),this.worker&&this.worker.terminate(),b.MVC.View.prototype.remove.apply(this,arguments)},initialize:function(a){var e;if(this.dfd=null,this.axisLabels=[],this.metrics={},this.progress=0,this.setClearData(),"undefined"==typeof a.interactiveElements)throw new Error("interactiveElements must be defined");if(this.elementsManager=a.interactiveElements,delete a.interactiveElements,"object"!=typeof a.config)throw new Error("config must be defined");if(this.config=a.config,delete a.config,"object"!=typeof a.source)throw new Error("source must be defined");this.source=a.source,delete a.source,e=this.source,this.isRemote="object"==typeof a.host?!0:!1,this.worker=window.Worker&&this.isRemote===!1?new Worker("/zoomdata/js/components/Zoomdata.Workers.ProcessSocketData.js"):null,this._assemblyMethods(),b.MVC.View.prototype.initialize.apply(this,arguments),this.state=new b.Models.State({streamSourceId:this.config.get("source").sourceId},{config:this.config,objectFields:this.source.objectFields}),this.eventDispatcher=b.Components.DashboardEvents,this.thread=new h({state:this.state,dataStream:b.dataStream}),this.fields=e.objectFields,this.formulas=e.formulaList,this._configureMetricAccessors(),this.time=this.state.time,this.$el.attr("data-visid",this.config.get("visId")).removeAttr("id"),this.components=new c(this.config.get("components"),{visId:this.config.get("visId"),name:this.config.get("name"),remote:this.isRemote&&this.options.host.remote,secure:this.isRemote&&this.options.host.secure,apiKey:this.isRemote&&this.options.host.apiKey}),this.libraries=new d(this.config.get("libs"),{remote:this.isRemote&&this.options.host.remote,secure:this.isRemote&&this.options.host.secure,apiKey:this.isRemote&&this.options.host.apiKey}),this.inheritanceManager=new k({controller:this}),this.actionList=b.actionList,this.tooltip=new b.Controls.VisualizationTooltip({controller:this}),this.resetIndicators()},_configureMetricAccessors:function(){var a,b,c,d=this,e=d.config.get("variables"),f=[],g=this.metrics={},h=this.fields;$(e).each(function(e,g){if("metric"===g.type||"multi-metric"===g.type)switch(g.metricType){case"color":a=g,d.autoShowColorLegend=g.autoShowColorLegend,"string"==typeof g.colors&&(g.colors=JSON.parse(g.colors)),g.savedColors&&"string"==typeof g.savedColors&&(g.savedColors=JSON.parse(g.savedColors)),c=g.colors?g.colors.length:0,g.colors&&$.each(g.colors,function(b,c){f.push(a.savedColors&&"string"==typeof a.savedColors[b]?a.savedColors[b]:c.color||c)});break;case"general":b=g}}),this.state.divergingColorRange="gradient",this.state.metrics.each(function(i){var k,l=i.get("name"),m=i.get("label"),n=_.where(e,{name:m})[0],o=n?n.type:"metric",p=i.isNone()?h.noneField:i.isCount()?h.volumeField:h.findWhere({name:l});"multi-metric"==o?g[m]instanceof Array?g[m].push(new j(i.toJSON(),p.toJSON())):g[m]=[new j(i.toJSON(),p.toJSON())]:g[m]=new j(i.toJSON(),p.toJSON()),a&&m===a.name?(d.state.colorDataObj&&d.state.colorDataObj.get("label")===m||(d.state.colorDataObj=i),d.state.colorNumb=c,k=d.metrics[a.name][0]||d.metrics[a.name],k.metric.colors&&"string"!=typeof k.metric.colors||(d.state.legendType=a.legendType||"range",d.state.divergingColorRange=a.divergingColorRange||"gradient",k.setColorRangeType(d.state.divergingColorRange),k.metric.colors=f,k.domainValue=a.domain),d.metrics[a.name][0]&&(d.state.divergingColorRange=null,k.objectFields=[],d.source.objectFields.forEach(function(b){var c=b.get("type");("FORMULA"===c||-1!==a.attributeType.indexOf(c))&&k.objectFields.push(b),k.objectFields.length>k.metric.colors&&k.metric.colors.push("#ffffff")}),k.metric.colors.splice(k.objectFields.length,k.metric.colors.length),d.state.colorNumb=k.metric.colors.length),k.metric.colorsData=a.colors):b&&m===b.name&&(d.state.generalMetric=i)}),this._controller&&(this._controller.metrics=this.metrics)},_onGroupByChange:function(){this.clearVisualization(),this.restartVisualization()},_onMetricChange:function(a){function b(a,b){var c=_.find(a,function(a){var c=a.metric.name==("undefined"!=typeof b.changed.name?b.previous("name"):b.get("name"))&&a.metric.func==("undefined"!=typeof b.changed.func?b.previous("func"):b.get("func"));return c});c.setAccessTo(b.toJSON(),f.toJSON())}var c=a.get("label"),d=a.get("name"),e=this.metrics[c],f=a.isNone()?this.fields.noneField:a.isCount()?this.fields.volumeField:this.fields.findWhere({name:d});delete e.domainValue,e instanceof Array?b(e,a):e.setAccessTo(a.toJSON(),f.toJSON()),this.restartVisualization()},_onMetricReset:function(){this.restartVisualization()},_onMetricAdd:function(a){var b=a.get("label"),c=a.get("name"),d=this.metrics[b],e=a.isCount()?this.fields.volumeField:this.fields.findWhere({name:c});d instanceof Array?null:d=[].concat(d),d.push(new j(a.toJSON(),e.toJSON())),this.restartVisualization()},_onMetricRemove:function(a){var b=a.get("label"),c=a.get("func"),d=a.get("name"),e=this.metrics[b]instanceof Array?this.metrics[b]:[].concat(this.metrics[b]),f=_.find(e,function(a){return a.metric.name==d&&a.metric.func==c});f&&e.splice(e.indexOf(f),1),this.restartVisualization()},_onMessage:function(a){"function"==typeof this._controller.processData?(this._controller.processData(a,this.thread.progress()),this.colorKey.render()):this.processSocketData(a)},_onNoDataFound:function(){this.clearVisualization(),this._controller.onNoDataFound()},_onStartFromTimeDone:function(){this.setClearData()},_assemblyMethods:function(){_.extend(this,new i)},_createAxisLabel:function(a){if(this.isRemote)return null;var b=new e($.extend({},a,{controller:this})),c=b.render().$el,d=$(this.el.parentElement),f=$(this.el);switch(a.position){case"left":var g=d.find(".widgetLabel.left").eq(0);g&&0!==g.length||(g=$('<div class="widgetLabel left"/>'),d.prepend(g)),f.css({left:"50px"}),g.append(c);break;case"right":var h=d.find(".widgetLabel.right").eq(0);h&&0!==h.length||(h=$('<div class="widgetLabel right"/>'),d.prepend(h)),f.css({right:"50px"}),h.append(c);break;case"top":var i=d.find(".widgetLabel.top").eq(0);i&&0!==i.length||(i=$('<div class="widgetLabel top"/>'),d.prepend(i)),f.css({top:"50px"}),i.append(c);break;case"bottom":var j=d.find(".widgetLabel.bottom").eq(0);j&&0!==j.length||(j=$('<div class="widgetLabel bottom"/>'),d.prepend(j)),f.css({bottom:"50px"}),j.append(c)}return b.position(),c.hide().show(0),this.axisLabels.push(b),c},_onFilterAll:function(a){a.UUID!==this.UUID&&this._controller&&this._controller.filters.add(a.data)},_onUnfilterAll:function(a){a.UUID!==this.UUID&&this._controller&&this._controller.filters.remove(a.data)},resetIndicators:function(){},setVisualization:function(a,c,d){var e=this,f=this.state,g=c&&d?d:new b.Models.State({streamSourceId:a.get("source").sourceId},{config:a,objectFields:this.source.objectFields,oldTimeWindowScale:this.state.time.get("timeWindow")}),h=this.config;a&&(this.config=a,this.config.sourceId=h.sourceId),this.stopVisualization(),this.removeVisualization(),this.state=g,this.thread.tuneTo({state:this.state,config:this.config}),this.time=this.state.time,this.$el.attr("data-visid",this.config.get("visId")).removeAttr("id"),this.libraries.reset(this.config.get("libs")),this.components.reset(this.config.get("components")),this.components.setVisId(this.config.get("visId")),this.components.setVisName(this.config.get("name")),c||this.inheritanceManager.merge({oldState:f,oldConfig:h}),this._configureMetricAccessors(),this.loadVisualization().done(function(){e.initVisualization(),e.startVisualization()}),this.trigger("visualization:change")},applyEvents:function(){var a=this;this.listenTo(g,"visualization:showpopup",a.showPopup),this.listenTo(this.thread,"thread:message",this._onMessage),this.listenTo(this.thread,"thread:start",this._onStart),this.listenTo(this.thread,"thread:error",this._onStreamError),this.listenTo(this.thread,"thread:notDirtyData",this._onNotDirtyData),this.listenTo(this.thread,"thread:noData",this._onNoDataFound),this.listenTo(this.thread,"thread:startFromTimeDone",this._onStartFromTimeDone),this.listenTo(this.thread,"thread:viewport",this._onViewport),this.listenTo(this.thread,"thread:stop",this._onStop),this.listenTo(this.thread,"thread:exeption",this._onExeption),this.listenTo(this.state,"change",this.restartVisualization),this.listenTo(this.state,"change:clientSort",this.refreshVisualization),this.listenTo(this.state.filters,"add remove change reset",this.restartVisualization),this.listenTo(this.state.metrics,"change",this._onMetricChange),this.listenTo(this.state.metrics,"add",this._onMetricAdd),this.listenTo(this.state.metrics,"remove",this._onMetricRemove),this.listenTo(this.state.metrics,"reset",this._onMetricReset),this.listenTo(this.state.groupBy,"change reset",this._onGroupByChange),this.listenTo(b.eventDispatcher,"restart",function(){a.startVisualization()}),this.listenTo(b.eventDispatcher,"zd_controller:filterAll",this._onFilterAll),this.listenTo(b.eventDispatcher,"zd_controller:unfilterAll",this._onUnfilterAll),this.on("resize",this._onResize)},muteEvents:function(){this.stopListening(g,"visualization:showpopup",this.showPopup),this.stopListening(this.thread,"thread:message",this._onMessage),this.stopListening(this.thread,"thread:start",this._onStart),this.stopListening(this.thread,"thread:error",this._onStreamError),this.stopListening(this.thread,"thread:notDirtyData",this._onNotDirtyData),this.stopListening(this.thread,"thread:noData",this._onNoDataFound),this.stopListening(this.thread,"thread:startFromTimeDone",this._onStartFromTimeDone),this.stopListening(this.thread,"thread:viewport",this._onViewport),this.stopListening(this.thread,"thread:stop",this._onStop),this.stopListening(this.thread,"thread:exeption",this._onExeption),this.stopListening(this.state,"change",this.restartVisualization),this.stopListening(this.state,"change:clientSort",this.refreshVisualization),this.stopListening(this.state.filters,"add remove change reset",this.restartVisualization),this.stopListening(this.state.metrics,"change",this._onMetricChange),this.stopListening(this.state.metrics,"add",this._onMetricAdd),this.stopListening(this.state.metrics,"remove",this._onMetricRemove),this.stopListening(this.state.metrics,"reset",this._onMetricReset),this.stopListening(this.state.groupBy,"change reset",this._onGroupByChange),this.stopListening(b.eventDispatcher,"zd_controller:filterAll"),this.stopListening(b.eventDispatcher,"zd_controller:unfilterAll"),this.off("resize",this._onResize),this._controller&&($(this._controller.element).off("resize"),this._controller.element.resize=null)},initVisualization:function(){var a=this,c=this.components.getComponentsNamespace(),d=b.Utilities.MODE.WIDGET===b.Utilities.mode();this._controller&&this._controller.toolbar().remove(),this.axisLabels=[],this.actionList=this.actionList||b.actionList,this.actionList&&(this.actionList.gestureTimeOut=null),this._controller={element:this.el,menu:{show:function(b){if(a.actionList){var c=[],d={top:0,left:0};if(b.x&&b.y)d.left=b.x,d.top=b.y;else{if(!b.event)throw new Error("Menu position is unspecified.");d.left=b.event.clientX,d.top=b.event.clientY}return c=a.assemblyInteractiveElementActions({getter:b.data,menuConfig:b.menu}).actions,setTimeout(function(){if(-1!=navigator.appVersion.indexOf("MSIE 10.")){if(null!==a.actionList.gestureTimeOut)return a.menu;setTimeout(function(){a.actionList.close()},100),setTimeout(function(){a.actionList.reset(c)},200),setTimeout(function(){a.actionList.render(d)},300),a.actionList.gestureTimeOut=setTimeout(function(){a.actionList.gestureTimeOut=null},600)}else a.actionList.close().reset(c).render(d)},1),a.menu}},hide:function(){a.actionList&&setTimeout(function(){a.actionList.close()},1)}},tooltip:{show:function(b){var c={};if(a.tooltip){if(b.x&&b.y)c.at={left:b.x,top:b.y};else{if(!b.event)throw new Error("Tooltip position is unspecified.");c.event=b.event}b.data&&(c.getter=function(){return b.data}),b.color&&(c.color=b.color),a.tooltip.show(c)}},update:function(b){var c={};if(a.tooltip){if(b.x&&b.y)c.at={left:b.x,top:b.y};else{if(!b.event)throw new Error("Tooltip position is unspecified.");c.event=b.event}b.data&&(c.getter=function(){return b.data}),b.color&&(c.color=b.color),a.tooltip.update(c)}},move:function(b){var c={};if(a.tooltip){if(b.x&&b.y)c.at={left:b.x,top:b.y};else{if(!b.event)throw new Error("Tooltip position is unspecified.");c.event=b.event}a.tooltip.update(c)}},hide:function(){a.tooltip.hide()}},filters:{add:function(b){var c=a.state;return Array.isArray(b)?c.addFilters(b):c.addFilter(b),this},remove:function(b){var c=a.state;return c.removeFilter(b),this},addToAll:function(c){var d=a.UUID;return b.eventDispatcher.trigger("zd_controller:filterAll",{UUID:d,data:c}),this},removeFromAll:function(c){var d=a.UUID;return b.eventDispatcher.trigger("zd_controller:unfilterAll",{UUID:d,data:c}),this}},"switch":function(b){function c(){g=a.source.visualizations.findWhere({type:e}),g.fetch().done(function(){d()})}function d(){a.setVisualization(g),f&&a._controller.filters.add(f,{silent:!0})}var e=b.type||b,f=b.filters,g=null;if(!e)throw new Error("Visualization type is unspecified.");return a.source.visualizations.bootstrap().done(function(){c()}),this},eventDispatcher:this.eventDispatcher,state:this.getVisualizationState(),config:this.getSourceConfiguration(),scope:{},labels:this.axisLabels,metrics:this.metrics,fields:this.fields,onAdd:$.noop,onRemove:$.noop,onChange:$.noop,update:$.noop,onNoDataFound:$.noop,resize:$.noop,onStreamError:$.noop,onViewport:$.noop,onExeption:$.noop,onNotDirtyData:$.noop,onStart:$.noop,onStop:$.noop,registerInteractiveElements:function(b,c,d,e){var f="object"==typeof c,g=f?c:d,h=g,i={};g&&g.tooltip&&(i.tooltip=a.tooltip,i.tooltip.originalConfig=g.tooltip,h=_.extend({},g,i)),f?a.registerInteractiveElements(b,h,d,e):a.registerInteractiveElements(b,c,h,e)},releaseInteractiveElement:function(b,c){a.releaseInteractiveElement(b,c)},registered:function(b){return a.elementsManager.registered(b)},requestData:function(){return a.thread.request_data.bind(a.thread)},customReadyStatusDelay:!1,setVisualization:function(b,c){a.setVisualization(b,c)},createAxisLabel:function(b){var c=a.state.config.get("variables"),d=c.filter(function(a){return a.name===b.picks})[0];return!d||"multi-group"!==d.type&&"group"!==d.type?a._createAxisLabel(b):a.state.groupBy.map(function(c,d){var e;return b.popoverTitle?(e=b.popoverTitle,a.state.groupBy.length>1&&(e+=" "+(d+1))):e=c.getLabel()||"Group "+(d+1),a._createAxisLabel($.extend({},b,{picks:c,popoverTitle:e}))})},toolbar:function(){var c=a._controller.toolbar;if(!c.$_toolbar){c.$_toolbar=$('                            <div class="zd-visualization-toolbar navbar">                                 <div class="navbar-inner">                                      <div class="container">                                         <ul class="nav pull-left"/>                                          <ul class="nav pull-right"/>                                     </div>                                  </div>                            </div>').prependTo($(a._controller.element).parent());var e=function(){return c.$_toolbar.find(".nav.pull-left")},f=function(){return c.$_toolbar.find(".nav.pull-right")};c.append=function(g,h){if(g.item&&void 0!==g.item.availableForMode&&"function"==typeof g.item.availableForMode){var i=g.item.availableForMode(b.Utilities.mode());if(!i)return}var j=g.side||g.item&&g.item.side||"left",k=g.el||g.item&&g.item.render().el;if(!k){var l=new b.VisualizationControls.ToolbarItem(g);k=l.render().el}"left"===j?h?e().prepend(k):e().append(k):h?f().prepend(k):f().append(k),g.item&&g.name&&(c._items||(c._items={}),c._items[g.name]=g.item);var m=a.$el.parent().find(".zd-visualization-toolbar");return d&&"list"!==g.item.icon?$(k).remove():m.length>0?$(a._controller.element).css({height:"87%"}):$(a._controller.element).css("height","calc(100% - 42px)"),c},c.get=function(a){return c._items&&c._items[a]||null},c.remove=function(){c._items=null,c.$_toolbar.remove(),c.$_toolbar=null}}return c}},$.each(this.metrics,function(b,c){return c.colorMetric?(a._controller.colorDataObj=c,!1):void 0}),a.config.get("variables").forEach(function(b){var c,d;("multi-group"===b.type||"group"===b.type)&&(c=JSON.parse(b.config||"{}"),c.groupColorSet&&(a._controller.colorDataObj=a.state.groupBy.models[c.colorGroupIndex],a._controller.colorDataObj.get("groupColorSet")||a._controller.colorDataObj.set("groupColorSet",c.groupColorSet),d=a.fields.findWhere({name:a._controller.colorDataObj.get("name")}),a._controller.colorDataObj._setField(d),a.state.colorDataObj=a._controller.colorDataObj,a.autoShowColorLegend=a.state.colorDataObj.get("autoShowColorLegend")))});var e=_.filter(this.config.get("controls"),function(a){return a.indexOf("ToolbarItem")>=0?a:null});if(e.length>0){var f=[];e.forEach(function(c){if(b.VisualizationToolbar[c]){var d=new b.VisualizationToolbar[c]({controller:a._controller});d.name=c,f.push(d)}}),f=_.sortBy(f,function(a){return a.order||Number.MAX_VALUE}),f.forEach(function(b){a._controller.toolbar().append({item:b,name:b.name})})}this._controller.variables=this.config.get("source").variables,this.components.where({type:"text/javascript"}).forEach(function(d){var e=d.getConstructorName();b.Visualizations[c][e](a._controller,b)
}),this._controller.update=this._controller.update||$.noop,this._controller.onAdd=this._controller.onAdd||$.noop,this._controller.onRemove=this._controller.onRemove||$.noop,this._controller.onChange=this._controller.onChange||$.noop,this._controller.clear=this._controller.clear||$.noop,this._controller.resize=this._controller.resize||$.noop,this._controller.onStreamError=this._controller.onStreamError||$.noop,this._controller.onNotDirtyData=this._controller.onNotDirtyData||$.noop,this._controller.onStart=this._controller.onStart||$.noop,this._controller.onViewport=this._controller.onViewport||$.noop,this._controller.onExeption=this._controller.onExeption||$.noop;var g=this.config.get("type");d&&"PIVOT_TABLE"!==g&&this._controller.toolbar().remove(),this.initColorKey(),this.applyEvents()},removeVisualization:function(){var a=this.config.get("visId"),b={},c=$("script"),d=this.$el.parents(".widgetBody, .fullScreenContainer").eq(0);this.$el.appendTo(d),this.components.each(function(d){if("text/javascript"===d.get("type")){var e=d.get("id");c.each(function(c,d){d.getAttribute("src")&&d.getAttribute("src").indexOf(a)>-1&&d.getAttribute("src").indexOf(e)>-1&&(b[e]=$(d))})}}),d.children().not(".widgetContent").remove(),d.removeAttr("id"),this.clearVisualization(!0),this.setClearData(),this._controller&&($(this._controller.element).children().not(".zd-legend").remove(),this._controller.labels.length>0&&this._controller.labels.forEach(function(a){a.remove(),a=null})),this.$el.removeAttr("style data-visid"),this.muteEvents(),this.trigger("visualization:removed");for(var e in b)b.hasOwnProperty(e)&&b[e].remove()},initColorKey:function(){this.colorKey=new f({el:this.$el.find(".zd-legend"),controller:this,isDraggable:!0,autoShow:this.autoShowColorLegend})},loadVisualization:function(){var a=this,c=this.components.getComponentsNamespace();return this.dfd=$.Deferred(),b.Visualizations instanceof Array?(a.trigger("visualization:loaded"),this.dfd.resolve()):(b.Visualizations[c]||(b.Visualizations[c]={}),this.trigger("visualization:loading"),this.$el.attr("data-visid",this.config.get("visId")).removeAttr("id"),this.libraries.load().done(function(){a.components.load().done(function(){a.trigger("visualization:loaded"),a.dfd.resolve()}).fail(function(a){throw a.details})}).fail(function(a){throw a.details})),this.dfd.promise()},setUUID:function(){this.thread.setUUID(),this.UUID=this.thread.getUUID(),this.config.set("id",this.UUID),this._controller.UUID=this.UUID},applyScope:function(){var a,b=this,c=this._controller.state.config.attributes.components,d=document.styleSheets,e=null,f="uuid_",g=document.createElement("style"),h=b.config.attributes.visId;if(document.body.appendChild(g),a=g.scoped+"",g.parentNode.removeChild(g),a){var i=$('style[data-visid="'+h+'"]');return i.appendTo(b.$el),i.attr("scoped",""),void i.scopedPolyFill()}c.map(function(a){try{if("text/css"===a.type){for(var c=0,g=d.length;g>c;c++){var i=d[c],j=a.id;if(h&&i.ownerNode.attributes["data-visid"]&&h===i.ownerNode.attributes["data-visid"].value&&j&&i.ownerNode.attributes["data-componentid"]&&j===i.ownerNode.attributes["data-componentid"].value&&void 0===i.UUID){e=i;break}}if(e){var k=b._controller.UUID;for(b.$el.attr("id",f+k),c=0,g=e.cssRules.length;g>c;c++){var l=e.cssRules?e.cssRules[c].selectorText.split(","):e.rules[c].selectorText.split(","),m="";if(l.forEach(function(a,b){m+="#"+f+k+" "+a+(b!==l.length-1?",":"")}),e.cssRules){e.cssRules[c].selectorText=m;var n=_.extend({},e.cssRules[c]);e.removeRule?e.removeRule(c):e.deleteRule(c)}else{e.rules[c].selectorText=m;var n=_.extend({},e.rules[c]);e.removeRule?e.removeRule(c):e.deleteRule(c)}e.insertRule?e.insertRule(n.cssText,c):e.addRule(m,n.style.cssText,c)}}}}catch(o){throw console.log("Scoped error",o),o}})},startVisualization:function(){return this.setUUID(),this._controller.delayedStart&&this._controller.delayedStart===!0?void 0:(this.thread.start(),this)},stopVisualization:function(){return this.thread.stop(),this.trigger("visualization:stop",this),g.trigger("visualization:stop",this),this},restartVisualization:function(){this.setClearData(),this.stopVisualization(),this.startVisualization(!0)},refreshVisualization:function(){var a=this.state.get("clientSort"),b=this.state.metrics.at(0);b&&a&&this.state.config.set("clientSort",a);var c=this.data;"function"==typeof this._controller.processData&&this._controller.processData(c,this.progress),this._updateMetricsDomain(c),this.processSocketData(c,this.progress),this.colorKey.render()},clearVisualization:function(a){a||(this.setClearData(),this.refreshVisualization()),this._controller?"function"==typeof this._controller.clear?this._controller.clear():null:this.dfd&&this.dfd.reject()},getControlsList:function(){var a=["TimeLine","PausedIndicator","SpeedIndicator","Date"],b=this.source.get("showTimeLine"),c=[];return this.getSourceConfiguration().controls.forEach(function(d){b||-1===a.indexOf(d)?c.push(d):null}),c},getSourceConfiguration:function(){return this.config.toJSON()},getVisualizationState:function(){return this.state},updateVisualizationState:function(a){return this.state.set(a),this},setClearData:function(){this.data=[],this.worker&&this.worker.postMessage("data:clear")},processSocketData:function(a){var b=this,c=this.worker,d=this._controller.state.groupBy.at(0),e=d&&d.get?d.get("sort").name:"count";if("count"===e&&this.state.metrics.length>0){var f=this.config.get("variables").filter(function(a){return"metric"===a.type&&"color"!==a.metricType})[0],g=f&&f.name?f.name:!1;e=this.metrics&&this.metrics[g]?this.metrics[g].metric.name:"count"}if(c)c.onmessage=function(c){if(c.data.data){b.data=c.data.data;var d=JSON.parse(JSON.stringify(b.data));b._updateMetricsDomain(d),b._controller.update(d,b.thread.progress(),{original_data:a}),b.colorKey.render(),b.trigger("visualization:dataUpdate")}},c.postMessage({data:a,oldData:this.data,clientSort:this.state.get("clientSort"),sortAttribute:e});else{if(a instanceof Array&&a.length>0){var h=[],i={},j={},k=this.data,l=a;if(0===k.length)h=l;else if(0===l.length)h=k;else{k.forEach(function(a){var b=Array.isArray(a.group)?a.group.join():a.group;i[b]=a}),l.forEach(function(a){var b=Array.isArray(a.group)?a.group.join():a.group;j[b]=a});for(var m in j)j.hasOwnProperty(m)&&(-1===j[m].current.count?i[m]&&delete i[m]:i[m]=j[m]);for(var m in i)i.hasOwnProperty(m)&&h.push(i[m])}this.data=this._sortData(h),i=null,j=null}var n=JSON.parse(JSON.stringify(this.data));this._updateMetricsDomain(n),this._controller.update(n,this.thread.progress(),{original_data:a})}},_sortData:function(a){var b=this.state.get("clientSort"),c=[];if(b&&this.state.metrics.size()>0){var d=null,e=this.metrics[this.state.metrics.at(0).get("label")];switch(e instanceof Array?e=e[0]:null,b){case"valueDescending":d=function(a,b){var c=e.raw(b)-e.raw(a);if(0===c){var d=a.group.join?a.group.join(""):a.group,f=b.group.join?b.group.join(""):b.group;return d.localeCompare(f)}return c};break;case"valueAscending":d=function(a,b){var c=e.raw(a)-e.raw(b);if(0===c){var d=a.group.join?a.group.join(""):a.group,f=b.group.join?b.group.join(""):b.group;return f.localeCompare(d)}return c};break;case"alphabetical":d=function(a,b){var c=a.group.join?a.group.join(""):a.group,d=b.group.join?b.group.join(""):b.group;return c.localeCompare(d)};break;case"reverseAlphabetical":d=function(a,b){var c=a.group.join?a.group.join(""):a.group,d=b.group.join?b.group.join(""):b.group;return d.localeCompare(c)};break;default:d=null}c=a.sort(d)}else c=a;return c},_updateMetricsDomain:function(a){function b(d){$.each(d,function(d,e){e instanceof Array?b(e):(e._updateDomain(a,c.state.colorNumb),c.state.colorMetricDomain=e.domain())})}var c=this;b(this.metrics),this.state.colorDataObj&&!this.state.colorDataObj.isMetric()&&this.state.colorDataObj._updateDomain(a)},_updateMetricsDivergingColorRange:function(a){function b(c){$.each(c,function(c,d){d instanceof Array?b(d):d.setColorRangeType(a)})}this.state.divergingColorRange=a,b(this.metrics)},calculateBottomMargin:function(a){var b;switch(a){case"large":b=10;break;case"medium":b=40;break;case"small":b=50}return b},_onResize:function(){var a=$(this._controller.element),c=a.parents(".widget, .fullScreenContainer").eq(0),d=c.width(),e=c.height(),f=a.width(),g=a.height(),h=b.Utilities.getWidgetSizeClass(d,e),i=this.$el.parent().find(".zd-visualization-toolbar"),j=0;i.length>0&&(j=this.calculateBottomMargin(h)),a.trigger("resize",[f,g]),f=a.width(),g=a.height()-j,this.colorKey.fixPosition(),this._controller.resize(f,g,h)},_onStreamError:function(a){this._controller.onStreamError(a)},_onStart:function(a){this._controller.onStart(a),this.trigger("visualization:start")},_onNotDirtyData:function(a){this._controller.onNotDirtyData(a)},_onViewport:function(a){this._controller.onViewport(a)},_onExeption:function(a){this._controller.onExeption(a)},_onStop:function(a){this._controller.onStop(a)},startFromTime:function(a,b){this.thread.startFromTime(b)},startFromTimeTo:function(a,b){this.thread.startFromTimeTo(b)},updateSpeed:function(a,b){this.thread.updateSpeed(b)},togglePause:function(a){var b=this.thread;void 0!==a?a?b.unpause():b.pause():this.thread.togglePause()},getRestrictions:function(a){var b=a.restrictions,c=_.map(b,function(a){return{path:a.path,operation:a.operation,value:a.value}});return _.filter(c,function(b){return b.path!=a.tsField})},getDefaultTemplate:function(){return l},getVisualizationName:function(){var a=this.state.metrics,b=a.at(0),c=(b?this.metrics[b.get("label")]:null,this.config.get("source")),d=this.config.get("type"),e=(this.config.get("name"),this.state.groupBy.getAttribute()),f=this.fields.findWhere({name:e}),g=(f?f.get("label"):e,c.sourceName),h=c.variables["Visualization Name"]||this.getDefaultTemplate(d),i=h||g;return h&&(i=i.replace(l,g)),i}})}(window,Zoomdata),function(a,b){function c(a,c,d){var e="/websocket/";return a&&(e=a+e+"?key="+c,e=d?"wss://"+e:"ws://"+e),b.dataStream=b.DataStreamProvider.getStream(e,b.eventDispatcher),b.dataStream}function d(b){function c(a,b){var c={remote:l.host,secure:l.secure,apiKey:l.apiKey},d=g(a,b,k,c);l.visualizations.push(d),d.controller.loadVisualization().done(function(){d.controller.initVisualization(),d.controller.startVisualization(),m.resolve(d)})}function d(a,b){var c="string"==typeof a?a:null;console.warn(c||b+": "+a.statusText),m.reject(a,b)}function e(a){console.log(a),m.notify(a)}b=b||{};var h,i,j,k,l=this,m=$.Deferred(),n=this.sources;if("string"!=typeof b.visualization||!b.visualization)throw new Error("Invalid visualization name");if(h=b.visualization,"string"!=typeof b.source||!b.source)throw new Error("Invalid source name");if(i=b.source,!(b.element instanceof a.HTMLElement))throw new Error("Invalid element");return k=b.element,j=n.findWhere({name:i}),j?f(h,j).then(c,d,e):(m.notify("Loading Source"),n.fetch({data:{name:i}}).then(function(a){var b,g;a[0]?(b=a[0].id,g=n.get(b),f(h,g).then(c,d,e)):m.reject("source doesn't exist")})),m.promise()}function e(a){a=a||{};var b,c,d,e=$.Deferred();if("string"!=typeof a.visualization||!a.visualization)throw new Error("Invalid visualization name");if(b=a.visualization,"string"!=typeof a.source||!a.source)throw new Error("Invalid source name");return c=a.source,d=_.where(this.visualizations,{name:b,source:c})[0],d?(e.notify("Closing visualization "+b),d.controller.remove(),d.controller.elementsManager.destroy(),$(d.root).remove(),this.visualizations.splice(this.visualizations.indexOf(d),1),e.resolve()):e.reject("Visualization doesn't exist"),e.promise()}function f(a,b){var c=b.visualizations.findWhere({name:a}),d=$.Deferred();return c?(d.notify("fetching visualization config for "+a),c.fetch().done(function(){d.resolve(c,b)}).fail(function(a,b){d.reject(a,b)})):(d.notify("fetching visualizations for "+b.get("name")),b.visualizations.fetch().done(function(){var c=b.visualizations.findWhere({name:a});c?(d.notify("fetching visualization config for "+a),c.fetch().done(function(){d.resolve(c,b)}).fail(function(a,b){d.reject(a,b)})):d.reject("visualization doesn't exist")}).fail(function(a,b){d.reject(a,b)})),d}function g(a,b,c,d){var e=$('<div style="position: relative; height: 100%;"></div>').appendTo(c),f=$('<div class="widgetContent" style="position: relative; height: 100%;"></div>').append('<div class="zd-legend" style="display: none;"></div>').appendTo(e)[0],g=new k,h=new j({config:a,source:b,interactiveElements:g,el:f,host:d}),i={name:a.get("name"),source:b.get("name"),root:e[0],controller:h};return console.log(i),i}b.Components=b.Components||{};var h={secureHost:!1},i=b.Collections.Sources,j=b.Components.VisualizationController,k=b.Components.InteractiveElementsManager,l=function(a){if(this.visualizations=[],"undefined"==typeof a.apiKey)throw new Error("An apiKey must be defined");if(this.apiKey=a.apiKey,this.secure="undefined"!=typeof a.secure?a.secure:h.secure,"undefined"==typeof a.host)throw new Error("An url must be defined");this.host=a.host,this.sources=new i([],{secure:this.secure,remote:this.host,apiKey:this.apiKey}),this.stream=c(this.host,this.apiKey,this.secure)};l.prototype={visualize:d,stop:e},b.Components.StandaloneClient=l,a.ZoomdataClient=l}(window,Zoomdata);